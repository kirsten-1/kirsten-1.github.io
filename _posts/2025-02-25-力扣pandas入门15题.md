---
layout: post
title: "pandaså…¥é—¨15é¢˜"
subtitle: "pandaså…¥é—¨15é¢˜"
date: 2025-02-25
author: "Hilda"
header-img: "img/post-bg-2015.jpg"
tags:
- åŠ›æ‰£
---


<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>


NumPy åšå®¢æ€»ç»“ï¼š

[ã€ŠPythonæ•°æ®åˆ†æžåŸºç¡€æ•™ç¨‹ï¼šNumPyå­¦ä¹ æŒ‡å—ï¼ˆç¬¬2ç‰ˆï¼‰ã€‹æ‰€æœ‰ç« èŠ‚é˜…è¯»ç¬”è®°+ä»£ç ](https://kirsten-1.github.io/2025/02/14/NumPy%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97(%E7%AC%AC2%E7%89%88)%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93/)

[70é“NumPy é¢è¯•é¢˜(é¢˜ç›®+ç­”æ¡ˆ)](https://kirsten-1.github.io/2025/02/21/NumPy70%E9%A2%98/)

pandasåšå®¢æ€»ç»“ï¼š

[pandas(1)æ•°æ®é¢„å¤„ç†](https://kirsten-1.github.io/2025/02/21/Pandas(1)%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/)

[pandas(2)æ•°æ®åˆ†æž](https://kirsten-1.github.io/2025/02/24/Pandas(2)%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/)

[pandas(3)å¸¸ç”¨å‡½æ•°æ“ä½œ](https://kirsten-1.github.io/2025/02/24/pandas(3)%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C/)

[pandas(4)å¤§æ•°æ®å¤„ç†æŠ€å·§](https://kirsten-1.github.io/2025/02/25/Pandas(4)%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%8A%80%E5%B7%A7/)

----

æœ¬ç¯‡åšå®¢æ˜¯åŠ›æ‰£çš„â€œpandaså…¥é—¨15é¢˜â€ã€‚

# 2877. ä»Žè¡¨ä¸­åˆ›å»º DataFrame

[2877. ä»Žè¡¨ä¸­åˆ›å»º DataFrame](https://leetcode.cn/problems/create-a-dataframe-from-list/)

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ŒåŸºäºŽåä¸º `student_data` çš„äºŒç»´åˆ—è¡¨ **åˆ›å»º** ä¸€ä¸ª DataFrame ã€‚è¿™ä¸ªäºŒç»´åˆ—è¡¨åŒ…å«ä¸€äº›å­¦ç”Ÿçš„ ID å’Œå¹´é¾„ä¿¡æ¯ã€‚

DataFrame åº”è¯¥æœ‰ä¸¤åˆ—ï¼Œ `student_id` å’Œ `age`ï¼Œå¹¶ä¸”ä¸ŽåŽŸå§‹äºŒç»´åˆ—è¡¨çš„é¡ºåºç›¸åŒã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼š
student_data:
[
  [1, 15],
  [2, 11],
  [3, 11],
  [4, 20]
]
è¾“å‡ºï¼š
+------------+-----+
| student_id | age |
+------------+-----+
| 1          | 15  |
| 2          | 11  |
| 3          | 11  |
| 4          | 20  |
+------------+-----+
è§£é‡Šï¼š
åŸºäºŽ student_data åˆ›å»ºäº†ä¸€ä¸ª DataFrameï¼ŒåŒ…å« student_id å’Œ age ä¸¤åˆ—ã€‚
```

---

```python
import pandas as pd

def createDataframe(student_data: List[List[int]]) -> pd.DataFrame:
    return pd.DataFrame(student_data, columns = ["student_id", "age"])
```

# 2878. èŽ·å– DataFrame çš„å¤§å°

[2878. èŽ·å– DataFrame çš„å¤§å°](https://leetcode.cn/problems/get-the-size-of-a-dataframe/)

```
DataFrame players:
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| player_id   | int    |
| name        | object |
| age         | int    |
| position    | object |
| ...         | ...    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè®¡ç®—å¹¶æ˜¾ç¤º `players` çš„ **è¡Œæ•°å’Œåˆ—æ•°**ã€‚

å°†ç»“æžœè¿”å›žä¸ºä¸€ä¸ªæ•°ç»„ï¼š

```
[number of rows, number of columns]
```

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼š
+-----------+----------+-----+-------------+--------------------+
| player_id | name     | age | position    | team               |
+-----------+----------+-----+-------------+--------------------+
| 846       | Mason    | 21  | Forward     | RealMadrid         |
| 749       | Riley    | 30  | Winger      | Barcelona          |
| 155       | Bob      | 28  | Striker     | ManchesterUnited   |
| 583       | Isabella | 32  | Goalkeeper  | Liverpool          |
| 388       | Zachary  | 24  | Midfielder  | BayernMunich       |
| 883       | Ava      | 23  | Defender    | Chelsea            |
| 355       | Violet   | 18  | Striker     | Juventus           |
| 247       | Thomas   | 27  | Striker     | ParisSaint-Germain |
| 761       | Jack     | 33  | Midfielder  | ManchesterCity     |
| 642       | Charlie  | 36  | Center-back | Arsenal            |
+-----------+----------+-----+-------------+--------------------+
è¾“å‡ºï¼š
[10, 5]
è§£é‡Šï¼š
è¿™ä¸ª DataFrame åŒ…å« 10 è¡Œå’Œ 5 åˆ—ã€‚
```

---

```python
import pandas as pd

def getDataframeSize(players: pd.DataFrame) -> List[int]:
    return [players.shape[0], players.shape[1]]
```

æˆ–è€…ï¼š

```python
import pandas as pd

def getDataframeSize(players: pd.DataFrame) -> List[int]:
    return list(players.shape)
```

# 2879. æ˜¾ç¤ºå‰ä¸‰è¡Œ

[2879. æ˜¾ç¤ºå‰ä¸‰è¡Œ](https://leetcode.cn/problems/display-the-first-three-rows/)

```
DataFrame: employees
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| employee_id | int    |
| name        | object |
| department  | object |
| salary      | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ˜¾ç¤ºè¿™ä¸ª DataFrame çš„ **å‰ `3`** è¡Œã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
DataFrame employees
+-------------+-----------+-----------------------+--------+
| employee_id | name      | department            | salary |
+-------------+-----------+-----------------------+--------+
| 3           | Bob       | Operations            | 48675  |
| 90          | Alice     | Sales                 | 11096  |
| 9           | Tatiana   | Engineering           | 33805  |
| 60          | Annabelle | InformationTechnology | 37678  |
| 49          | Jonathan  | HumanResources        | 23793  |
| 43          | Khaled    | Administration        | 40454  |
+-------------+-----------+-----------------------+--------+
è¾“å‡ºï¼š
+-------------+---------+-------------+--------+
| employee_id | name    | department  | salary |
+-------------+---------+-------------+--------+
| 3           | Bob     | Operations  | 48675  |
| 90          | Alice   | Sales       | 11096  |
| 9           | Tatiana | Engineering | 33805  |
+-------------+---------+-------------+--------+
è§£é‡Šï¼š
åªæœ‰å‰ 3 è¡Œè¢«æ˜¾ç¤ºã€‚
```

---

```python
import pandas as pd

def selectFirstRows(employees: pd.DataFrame) -> pd.DataFrame:
    return employees.head(3)
```

è¿”å›žåˆ‡ç‰‡ `df = employees[:3]` ä¹Ÿå¯

# 2880. æ•°æ®é€‰å–

[2880. æ•°æ®é€‰å–](https://leetcode.cn/problems/select-data/)

```
DataFrame students
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| student_id  | int    |
| name        | object |
| age         | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œé€‰æ‹© `student_id = 101` çš„å­¦ç”Ÿçš„ name å’Œ age å¹¶è¾“å‡ºã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
+------------+---------+-----+
| student_id | name    | age |
+------------+---------+-----+
| 101        | Ulysses | 13  |
| 53         | William | 10  |
| 128        | Henry   | 6   |
| 3          | Henry   | 11  |
+------------+---------+-----+
è¾“å‡ºï¼š
+---------+-----+
| name    | age | 
+---------+-----+
| Ulysses | 13  |
+---------+-----+
è§£é‡Šï¼š
å­¦ç”Ÿ Ulysses çš„ student_id = 101ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å‡ºäº†ä»–çš„ name å’Œ ageã€‚
```

---

```python
import pandas as pd

def selectData(students: pd.DataFrame) -> pd.DataFrame:
    return students[students['student_id']==101][['name','age']]
```

# 2881. åˆ›å»ºæ–°åˆ—

[2881. åˆ›å»ºæ–°åˆ—](https://leetcode.cn/problems/create-a-new-column/)

```
DataFrame employees
+-------------+--------+
| Column Name | Type.  |
+-------------+--------+
| name        | object |
| salary      | int.   |
+-------------+--------+
```

ä¸€å®¶å…¬å¸è®¡åˆ’ä¸ºå‘˜å·¥æä¾›å¥–é‡‘ã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `bonus` çš„æ–°åˆ—ï¼Œå…¶ä¸­åŒ…å« `salary` å€¼çš„ **ä¸¤å€**ã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
DataFrame employees
+---------+--------+
| name    | salary |
+---------+--------+
| Piper   | 4548   |
| Grace   | 28150  |
| Georgia | 1103   |
| Willow  | 6593   |
| Finn    | 74576  |
| Thomas  | 24433  |
+---------+--------+
è¾“å‡ºï¼š
+---------+--------+--------+
| name    | salary | bonus  |
+---------+--------+--------+
| Piper   | 4548   | 9096   |
| Grace   | 28150  | 56300  |
| Georgia | 1103   | 2206   |
| Willow  |  593   | 13186  |
| Finn    | 74576  | 149152 |
| Thomas  | 24433  | 48866  |
+---------+--------+--------+
è§£é‡Šï¼š
é€šè¿‡å°† salary åˆ—ä¸­çš„å€¼åŠ å€åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ bonus åˆ—ã€‚
```

---

```python
import pandas as pd

def createBonusColumn(employees: pd.DataFrame) -> pd.DataFrame:
    employees["bonus"] = employees["salary"] * 2
    return employees
```

æˆ–è€…ï¼š(æ›´æ…¢)

```python
import pandas as pd

def createBonusColumn(employees: pd.DataFrame) -> pd.DataFrame:
    return employees.assign(bonus = employees['salary'] * 2)
```

# 2882. åˆ åŽ»é‡å¤çš„è¡Œ

[2882. åˆ åŽ»é‡å¤çš„è¡Œ](https://leetcode.cn/problems/drop-duplicate-rows/)

```
DataFrame customers
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| customer_id | int    |
| name        | object |
| email       | object |
+-------------+--------+
```

åœ¨ DataFrame ä¸­åŸºäºŽ `email` åˆ—å­˜åœ¨ä¸€äº›é‡å¤è¡Œã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œåˆ é™¤è¿™äº›é‡å¤è¡Œï¼Œä»…ä¿ç•™ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„è¡Œã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```python
è¾“å…¥ï¼š
+-------------+---------+---------------------+
| customer_id | name    | email               |
+-------------+---------+---------------------+
| 1           | Ella    | emily@example.com   |
| 2           | David   | michael@example.com |
| 3           | Zachary | sarah@example.com   |
| 4           | Alice   | john@example.com    |
| 5           | Finn    | john@example.com    |
| 6           | Violet  | alice@example.com   |
+-------------+---------+---------------------+
è¾“å‡ºï¼š
+-------------+---------+---------------------+
| customer_id | name    | email               |
+-------------+---------+---------------------+
| 1           | Ella    | emily@example.com   |
| 2           | David   | michael@example.com |
| 3           | Zachary | sarah@example.com   |
| 4           | Alice   | john@example.com    |
| 6           | Violet  | alice@example.com   |
+-------------+---------+---------------------+
è§£é‡Šï¼š
Alice (customer_id = 4) å’Œ Finn (customer_id = 5) éƒ½ä½¿ç”¨ john@example.comï¼Œå› æ­¤åªä¿ç•™è¯¥é‚®ç®±åœ°å€çš„ç¬¬ä¸€æ¬¡å‡ºçŽ°ã€‚
```

---



```python
import pandas as pd

def dropDuplicateEmails(customers: pd.DataFrame) -> pd.DataFrame:
    return customers.drop_duplicates(subset="email")
```

å‚è€ƒç­”æ¡ˆç»™çš„æ˜¯ï¼š

```python
import pandas as pd

def dropDuplicateEmails(customers: pd.DataFrame) -> pd.DataFrame:
    customers.drop_duplicates(subset='email', keep='first', inplace=True)
    return customers

```

æ³¨ï¼šä½¿ç”¨ inplace=True ä¿®æ”¹åŽŸå§‹ DataFrameã€‚ä¸ºäº†ä¿ç•™åŽŸæ¥çš„ DataFrame å¹¶èŽ·å¾—ä¸€ä¸ªåŽ»æŽ‰é‡å¤é¡¹çš„æ–° DataFrameï¼Œæˆ‘ä»¬åº”è¯¥è®¾ç½® inplace=Falseï¼Œå¹¶å°†ç»“æžœèµ‹ç»™ä¸€ä¸ªæ–°çš„å˜é‡ã€‚

# 2883. åˆ åŽ»ä¸¢å¤±çš„æ•°æ®

[2883. åˆ åŽ»ä¸¢å¤±çš„æ•°æ®](https://leetcode.cn/problems/drop-missing-data/)

```
DataFrame students
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| student_id  | int    |
| name        | object |
| age         | int    |
+-------------+--------+
```

åœ¨ `name` åˆ—é‡Œæœ‰ä¸€äº›å…·æœ‰ç¼ºå¤±å€¼çš„è¡Œã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œåˆ é™¤å…·æœ‰ç¼ºå¤±å€¼çš„è¡Œã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
+------------+---------+-----+
| student_id | name    | age |
+------------+---------+-----+
| 32         | Piper   | 5   |
| 217        | None    | 19  |
| 779        | Georgia | 20  |
| 849        | Willow  | 14  |
+------------+---------+-----+
è¾“å‡ºï¼š
+------------+---------+-----+
| student_id | name    | age |
+------------+---------+-----+
| 32         | Piper   | 5   |
| 779        | Georgia | 20  | 
| 849        | Willow  | 14  | 
+------------+---------+-----+
è§£é‡Šï¼š
å­¦å·ä¸º 217 çš„å­¦ç”Ÿæ‰€åœ¨è¡Œåœ¨ name åˆ—ä¸­æœ‰ç©ºå€¼ï¼Œå› æ­¤è¿™ä¸€è¡Œå°†è¢«åˆ é™¤ã€‚
```

----

```python
import pandas as pd

def dropMissingData(students: pd.DataFrame) -> pd.DataFrame:
    return students[~students.isnull().any(axis = 1)]
```

æˆ–è€…ï¼š

```python
import pandas as pd

def dropMissingData(students: pd.DataFrame) -> pd.DataFrame:
    students.dropna(subset='name', inplace=True)
    return students
```

# 2884. ä¿®æ”¹åˆ—

[2884. ä¿®æ”¹åˆ—](https://leetcode.cn/problems/modify-columns/)

```
DataFrame employees
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| name        | object |
| salary      | int    |
+-------------+--------+
```

ä¸€å®¶å…¬å¸å†³å®šå¢žåŠ å‘˜å·¥çš„è–ªæ°´ã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°†æ¯ä¸ªå‘˜å·¥çš„è–ªæ°´ä¹˜ä»¥2æ¥ **ä¿®æ”¹** `salary` åˆ—ã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
DataFrame employees
+---------+--------+
| name    | salary |
+---------+--------+
| Jack    | 19666  |
| Piper   | 74754  |
| Mia     | 62509  |
| Ulysses | 54866  |
+---------+--------+
è¾“å‡ºï¼š
+---------+--------+
| name    | salary |
+---------+--------+
| Jack    | 39332  |
| Piper   | 149508 |
| Mia     | 125018 |
| Ulysses | 109732 |
+---------+--------+
è§£é‡Šï¼š
æ¯ä¸ªäººçš„è–ªæ°´éƒ½è¢«åŠ å€ã€‚
```

------

```python
import pandas as pd

def modifySalaryColumn(employees: pd.DataFrame) -> pd.DataFrame:
    employees["salary"] = employees["salary"] * 2
    return employees
```

# 2885. é‡å‘½ååˆ—

[2885. é‡å‘½ååˆ—](https://leetcode.cn/problems/rename-columns/)

```
DataFrame students
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| id          | int    |
| first       | object |
| last        | object |
| age         | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ŒæŒ‰ä»¥ä¸‹æ–¹å¼é‡å‘½ååˆ—ï¼š

- `id` é‡å‘½åä¸º `student_id`
- `first` é‡å‘½åä¸º `first_name`
- `last` é‡å‘½åä¸º `last_name`
- `age` é‡å‘½åä¸º `age_in_years`

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
+----+---------+----------+-----+
| id | first   | last     | age |
+----+---------+----------+-----+
| 1  | Mason   | King     | 6   |
| 2  | Ava     | Wright   | 7   |
| 3  | Taylor  | Hall     | 16  |
| 4  | Georgia | Thompson | 18  |
| 5  | Thomas  | Moore    | 10  |
+----+---------+----------+-----+
è¾“å‡ºï¼š
+------------+------------+-----------+--------------+
| student_id | first_name | last_name | age_in_years |
+------------+------------+-----------+--------------+
| 1          | Mason      | King      | 6            |
| 2          | Ava        | Wright    | 7            |
| 3          | Taylor     | Hall      | 16           |
| 4          | Georgia    | Thompson  | 18           |
| 5          | Thomas     | Moore     | 10           |
+------------+------------+-----------+--------------+
è§£é‡Šï¼š
åˆ—åå·²ç›¸åº”æ›´æ¢ã€‚
```

---

```python
import pandas as pd

def renameColumns(students: pd.DataFrame) -> pd.DataFrame:
    students.columns = ["student_id", "first_name", "last_name", "age_in_years"]
    return students
```

352ms

å…¶ä»–æ–¹æ³•ï¼š

```python
import pandas as pd

def renameColumns(students: pd.DataFrame) -> pd.DataFrame:
    students = students.rename(
        columns = {
        'id': "student_id",
        'first': "first_name",
        'last': 'last_name',
        'age': "age_in_years"
    })
    return students
```

æˆ–è€…ç”¨renameå‡½æ•°ï¼š

```python
import pandas as pd

def renameColumns(students: pd.DataFrame) -> pd.DataFrame:
    new_columns = {
        'id': "student_id",
        'first': "first_name",
        'last': 'last_name',
        'age': "age_in_years"
    }
    return students.rename(columns = new_columns, inplace=False)
```

# 2886. æ”¹å˜æ•°æ®ç±»åž‹

[2886. æ”¹å˜æ•°æ®ç±»åž‹](https://leetcode.cn/problems/change-data-type/)

```
DataFrame students
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| student_id  | int    |
| name        | object |
| age         | int    |
| grade       | float  |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥çº æ­£ä»¥ä¸‹é”™è¯¯ï¼š

`grade` åˆ—è¢«å­˜å‚¨ä¸ºæµ®ç‚¹æ•°ï¼Œå°†å®ƒè½¬æ¢ä¸ºæ•´æ•°ã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
DataFrame students:
+------------+------+-----+-------+
| student_id | name | age | grade |
+------------+------+-----+-------+
| 1          | Ava  | 6   | 73.0  |
| 2          | Kate | 15  | 87.0  |
+------------+------+-----+-------+
è¾“å‡ºï¼š
+------------+------+-----+-------+
| student_id | name | age | grade |
+------------+------+-----+-------+
| 1          | Ava  | 6   | 73    |
| 2          | Kate | 15  | 87    |
+------------+------+-----+-------+
è§£é‡Šï¼š
grade åˆ—çš„æ•°æ®ç±»åž‹å·²è½¬æ¢ä¸ºæ•´æ•°ã€‚
```

----

```python
import pandas as pd

def changeDatatype(students: pd.DataFrame) -> pd.DataFrame:
    students['grade'] = students['grade'].astype('int')
    return students
```

ç‰¹åˆ«æ³¨æ„ï¼Œæ”¹å®Œ`students['grade']`ä¸è¦å¿˜è®°èµ‹å€¼å›žåŽ»ã€‚

å…¶ä»–æ–¹æ³•ï¼š

```python
import pandas as pd

def changeDatatype(students: pd.DataFrame) -> pd.DataFrame:
    students = students.astype({'grade':int})
    return students
```

æˆ–è€…ï¼š(æ—¶é—´æ›´ä¹…)

```python
import pandas as pd

def changeDatatype(students: pd.DataFrame) -> pd.DataFrame:
    students['grade'] = students['grade'].apply(lambda x: int(x))
    return students
```



# ðŸŒŸ2887. å¡«å……ç¼ºå¤±å€¼

[2887. å¡«å……ç¼ºå¤±å€¼](https://leetcode.cn/problems/fill-missing-data/)

```
DataFrame products
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| name        | object |
| quantity    | int    |
| price       | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œåœ¨ `quantity` åˆ—ä¸­å°†ç¼ºå¤±çš„å€¼å¡«å……ä¸º `**0**`ã€‚

è¿”å›žç»“æžœå¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼š
+-----------------+----------+-------+
| name            | quantity | price |
+-----------------+----------+-------+
| Wristwatch      | 32       | 135   |
| WirelessEarbuds | None     | 821   |
| GolfClubs       | None     | 9319  |
| Printer         | 849      | 3051  |
+-----------------+----------+-------+
è¾“å‡ºï¼š
+-----------------+----------+-------+
| name            | quantity | price |
+-----------------+----------+-------+
| Wristwatch      | 32       | 135   |
| WirelessEarbuds | 0        | 821   |
| GolfClubs       | 0        | 9319  |
| Printer         | 849      | 3051  |
+-----------------+----------+-------+
è§£é‡Šï¼š
Toaster å’Œ Headphones çš„æ•°é‡è¢«å¡«å……ä¸º 0ã€‚
```

---

å‚è€ƒç­”æ¡ˆï¼š

```python
import pandas as pd

def fillMissingValues(products: pd.DataFrame) -> pd.DataFrame:
    return products.fillna(value={'quantity':0})
    
```

æˆ–è€…ï¼š

```python
import pandas as pd

def fillMissingValues(products: pd.DataFrame) -> pd.DataFrame:
    products['quantity'][products['quantity'].isnull()] = 0
    return products
    
```

æ³¨ï¼š**`products['quantity'][products['quantity'].isnull()]`**: è¿™éƒ¨åˆ†ä»£ç ä½¿ç”¨å¸ƒå°”ç´¢å¼•æ¥é€‰æ‹© quantity åˆ—ä¸­æ‰€æœ‰å€¼ä¸ºç¼ºå¤±å€¼çš„è¡Œã€‚ å®ƒæœ¬è´¨ä¸Šæ˜¯é€‰æ‹©äº† DataFrame ä¸­ quantity åˆ—ä¸­æ‰€æœ‰ isnull() è¿”å›ž True çš„é‚£äº›è¡Œã€‚

# 2888. é‡å¡‘æ•°æ®ï¼šè¿žç»“

[2888. é‡å¡‘æ•°æ®ï¼šè¿žç»“](https://leetcode.cn/problems/reshape-data-concatenate/)

```
DataFrame df1
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| student_id  | int    |
| name        | object |
| age         | int    |
+-------------+--------+

DataFrame df2
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| student_id  | int    |
| name        | object |
| age         | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°†ä¸¤ä¸ª DataFrames **åž‚ç›´** è¿žæŽ¥æˆä¸€ä¸ª DataFrameã€‚

ç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼š
df1
+------------+---------+-----+
| student_id | name    | age |
+------------+---------+-----+
| 1          | Mason   | 8   |
| 2          | Ava     | 6   |
| 3          | Taylor  | 15  |
| 4          | Georgia | 17  |
+------------+---------+-----+
df2
+------------+------+-----+
| student_id | name | age |
+------------+------+-----+
| 5          | Leo  | 7   |
| 6          | Alex | 7   |
+------------+------+-----+
è¾“å‡ºï¼š
+------------+---------+-----+
| student_id | name    | age |
+------------+---------+-----+
| 1          | Mason   | 8   |
| 2          | Ava     | 6   |
| 3          | Taylor  | 15  |
| 4          | Georgia | 17  |
| 5          | Leo     | 7   |
| 6          | Alex    | 7   |
+------------+---------+-----+
è§£é‡Šï¼š
ä¸¤ä¸ª DataFrame è¢«åž‚ç›´å †å ï¼Œå®ƒä»¬çš„è¡Œè¢«åˆå¹¶ã€‚
```

---

```python
import pandas as pd

def concatenateTables(df1: pd.DataFrame, df2: pd.DataFrame) -> pd.DataFrame:
    return pd.merge(df1, df2, how='outer')
```

å…¶ä»–æ–¹æ³•ï¼š

```python
import pandas as pd

def concatenateTables(df1: pd.DataFrame, df2: pd.DataFrame) -> pd.DataFrame:
    return pd.concat([df1, df2], axis = 0)
```

# 2889. æ•°æ®é‡å¡‘ï¼šé€è§†

[2889. æ•°æ®é‡å¡‘ï¼šé€è§†](https://leetcode.cn/problems/reshape-data-pivot/)

```
DataFrame weather
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| city        | object |
| month       | object |
| temperature | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œä»¥ä¾¿å°†æ•°æ® **æ—‹è½¬**ï¼Œä½¿å¾—æ¯ä¸€è¡Œä»£è¡¨ç‰¹å®šæœˆä»½çš„æ¸©åº¦ï¼Œè€Œæ¯ä¸ªåŸŽå¸‚éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„åˆ—ã€‚

è¾“å‡ºç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
+--------------+----------+-------------+
| city         | month    | temperature |
+--------------+----------+-------------+
| Jacksonville | January  | 13          |
| Jacksonville | February | 23          |
| Jacksonville | March    | 38          |
| Jacksonville | April    | 5           |
| Jacksonville | May      | 34          |
| ElPaso       | January  | 20          |
| ElPaso       | February | 6           |
| ElPaso       | March    | 26          |
| ElPaso       | April    | 2           |
| ElPaso       | May      | 43          |
+--------------+----------+-------------+
è¾“å‡ºï¼š
+----------+--------+--------------+
| month    | ElPaso | Jacksonville |
+----------+--------+--------------+
| April    | 2      | 5            |
| February | 6      | 23           |
| January  | 20     | 13           |
| March    | 26     | 38           |
| May      | 43     | 34           |
+----------+--------+--------------+
è§£é‡Šï¼š
è¡¨æ ¼è¢«æ—‹è½¬ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªåŸŽå¸‚ï¼Œæ¯ä¸€è¡Œä»£è¡¨ç‰¹å®šçš„æœˆä»½ã€‚
```

----

```python
import pandas as pd

def pivotTable(weather: pd.DataFrame) -> pd.DataFrame:
    return weather.pivot(index="month", columns="city", values="temperature")
```

# ðŸŒŸ2890. é‡å¡‘æ•°æ®ï¼šèžåˆ

[2890. é‡å¡‘æ•°æ®ï¼šèžåˆ](https://leetcode.cn/problems/reshape-data-melt/)

```
DataFrame report
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| product     | object |
| quarter_1   | int    |
| quarter_2   | int    |
| quarter_3   | int    |
| quarter_4   | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°†æ•°æ® **é‡å¡‘** æˆæ¯ä¸€è¡Œè¡¨ç¤ºç‰¹å®šå­£åº¦äº§å“é”€å”®æ•°æ®çš„å½¢å¼ã€‚

ç»“æžœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š



**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼š
+-------------+-----------+-----------+-----------+-----------+
| product     | quarter_1 | quarter_2 | quarter_3 | quarter_4 |
+-------------+-----------+-----------+-----------+-----------+
| Umbrella    | 417       | 224       | 379       | 611       |
| SleepingBag | 800       | 936       | 93        | 875       |
+-------------+-----------+-----------+-----------+-----------+
è¾“å‡ºï¼š
+-------------+-----------+-------+
| product     | quarter   | sales |
+-------------+-----------+-------+
| Umbrella    | quarter_1 | 417   |
| SleepingBag | quarter_1 | 800   |
| Umbrella    | quarter_2 | 224   |
| SleepingBag | quarter_2 | 936   |
| Umbrella    | quarter_3 | 379   |
| SleepingBag | quarter_3 | 93    |
| Umbrella    | quarter_4 | 611   |
| SleepingBag | quarter_4 | 875   |
+-------------+-----------+-------+
è§£é‡Šï¼š
DataFrame å·²ä»Žå®½æ ¼å¼é‡å¡‘ä¸ºé•¿æ ¼å¼ã€‚æ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªå­£åº¦å†…äº§å“çš„é”€å”®æƒ…å†µã€‚
```

---

```python
import pandas as pd

def meltTable(report: pd.DataFrame) -> pd.DataFrame:
    report = report.melt(
        id_vars=['product'],
        value_vars=['quarter_1', 'quarter_2', 'quarter_3', 'quarter_4'],
        var_name='quarter',
        value_name='sales'
    )
    return report
```

æ³¨ï¼š`value_vars`å¯ä»¥ä¸å¡«ï¼Œä¸å¡«å°±æ˜¯é™¤äº†`id_vars`åˆ—å¤–ï¼Œå…¶å®ƒæ‰€æœ‰åˆ—éƒ½åšè½¬æ¢

çŸ¥è¯†ç‚¹ï¼š

- DataFrameå½¢æ€æ”¹å˜ä¹‹å˜æˆé•¿æ ¼å¼

åˆ©ç”¨"df.melt()"æ–¹æ³•

- `.melt `æ–¹æ³•çš„å‚æ•°

```python
df.melt(id_vars=None, value_vars=None, var_name=None, value_name='value', col_level=None)
```



**`id_vars` = ä¸æƒ³æ”¹å˜çš„åˆ—**ã€‚è¿™äº›åˆ—åœ¨è¾“å‡ºçš„DataFrameä¸­ä¿æŒä¸å˜ï¼Œé€šå¸¸ç”¨æ¥æ ‡è¯†æ¯æ¡è®°å½•ã€‚

**`value_vars`** **= æƒ³è¦â€œèžåŒ–â€çš„åˆ—**ã€‚è¿™äº›åˆ—ä¼šè¢«è½¬æ¢æˆé•¿æ ¼å¼ä¸­çš„å€¼ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤æ‰€æœ‰éž` id_vars` çš„åˆ—éƒ½ä¼šè¢«ç†”åŒ–ã€‚

**`var_name` = â€œèžåŒ–â€åˆ—çš„åå­—**ï¼Œè¯¥åˆ—åŒ…å«äº†åŽŸæ¥åˆ—çš„åç§°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåˆ—çš„åå­—æ˜¯ variableã€‚

**`value_name` = æ•°å€¼åˆ—çš„åå­—**ï¼Œè¯¥åˆ—åŒ…å«äº†åŽŸæ¥åˆ—çš„å€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåˆ—çš„åå­—æ˜¯ valueã€‚

**`col_level `=** **å¤šçº§ç´¢å¼•ï¼ˆMultiIndexï¼‰åˆ—çš„æŒ‡å®šâ€œèžåŒ–â€çš„è¯¥çº§ç´¢å¼•**ã€‚é»˜è®¤ä¸º Noneï¼Œè¡¨ç¤ºç†”åŒ–æ‰€æœ‰çº§åˆ«çš„ç´¢å¼•ã€‚

----

# ðŸŒŸ2891. æ–¹æ³•é“¾

[2891. æ–¹æ³•é“¾](https://leetcode.cn/problems/method-chaining/)

```
DataFrame animals
+-------------+--------+
| Column Name | Type   |
+-------------+--------+
| name        | object |
| species     | object |
| age         | int    |
| weight      | int    |
+-------------+--------+
```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥åˆ—å‡ºä½“é‡ **ä¸¥æ ¼è¶…è¿‡** `100` åƒå…‹çš„åŠ¨ç‰©çš„åç§°ã€‚

æŒ‰ä½“é‡ **é™åº** è¿”å›žåŠ¨ç‰©ã€‚

è¿”å›žç»“æžœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

```
è¾“å…¥ï¼š
DataFrame animals:
+----------+---------+-----+--------+
| name     | species | age | weight |
+----------+---------+-----+--------+
| Tatiana  | Snake   | 98  | 464    |
| Khaled   | Giraffe | 50  | 41     |
| Alex     | Leopard | 6   | 328    |
| Jonathan | Monkey  | 45  | 463    |
| Stefan   | Bear    | 100 | 50     |
| Tommy    | Panda   | 26  | 349    |
+----------+---------+-----+--------+
è¾“å‡ºï¼š
+----------+
| name     |
+----------+
| Tatiana  |
| Jonathan |
| Tommy    |
| Alex     |
+----------+
è§£é‡Šï¼š
æ‰€æœ‰ä½“é‡è¶…è¿‡ 100 çš„åŠ¨ç‰©éƒ½åº”åŒ…å«åœ¨ç»“æžœè¡¨ä¸­ã€‚
Tatiana çš„ä½“é‡ä¸º 464ï¼ŒJonathan çš„ä½“é‡ä¸º 463ï¼ŒTommy çš„ä½“é‡ä¸º 349ï¼ŒAlex çš„ä½“é‡ä¸º 328ã€‚
ç»“æžœåº”æŒ‰ä½“é‡é™åºæŽ’åºã€‚
```



åœ¨ Pandas ä¸­ï¼Œ**æ–¹æ³•é“¾** å…è®¸æˆ‘ä»¬åœ¨ DataFrame ä¸Šæ‰§è¡Œæ“ä½œï¼Œè€Œæ— éœ€å°†æ¯ä¸ªæ“ä½œæ‹†åˆ†æˆå•ç‹¬çš„è¡Œæˆ–åˆ›å»ºå¤šä¸ªä¸´æ—¶å˜é‡ã€‚

ä½ èƒ½ç”¨ **ä¸€è¡Œ** ä»£ç çš„æ–¹æ³•é“¾å®Œæˆè¿™ä¸ªä»»åŠ¡å—ï¼Ÿ

---

å‚è€ƒç­”æ¡ˆ:

```python
import pandas as pd

def findHeavyAnimals(animals: pd.DataFrame) -> pd.DataFrame:
    return animals[animals['weight']>100].sort_values(by="weight", ascending=False)[['name']]
```

