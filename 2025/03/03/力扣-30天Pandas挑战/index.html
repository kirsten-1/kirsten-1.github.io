<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="è¿™é‡Œæ˜¯ Hilda çš„ä¸ªäººåšå®¢ï¼Œä¸ä½ ä¸€èµ·å‘ç°æ›´å¤§çš„ä¸–ç•Œ | è¦åšä¸€ä¸ªæœ‰ swag çš„ç¨‹åºå‘˜">
    <meta name="keywords" content="Hilda">
    <meta name="theme-color" content="#000000">

    <!-- Open Graph -->
    <meta property="og:title"
        content="åŠ›æ‰£ 30å¤©pandasæŒ‘æˆ˜ - Hildaçš„åšå®¢ | Your genius girlfriend's blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="

">
    
    <meta property="article:published_time" content=" 2025-03-03T00:00:00Z">
    
    
    <meta property="article:author" content="Hilda">
    
    
    <meta property="article:tag" content="åŠ›æ‰£">
    
    
    <meta property="og:image" content="https://kirsten-1.github.io">
    <meta property="og:url" content="https://kirsten-1.github.io/2025/03/03/%E5%8A%9B%E6%89%A3-30%E5%A4%A9Pandas%E6%8C%91%E6%88%98/">
    <meta property="og:site_name" content="Hildaçš„åšå®¢ | Your genius girlfriend's blog">

    <title>åŠ›æ‰£ 30å¤©pandasæŒ‘æˆ˜ - Hildaçš„åšå®¢ | Your genius girlfriend's blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://kirsten-1.github.io/2025/03/03/%E5%8A%9B%E6%89%A3-30%E5%A4%A9Pandas%E6%8C%91%E6%88%98/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href=" /css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"
        type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-6487568398225121" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Hilda</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-2015.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-bg-2015.jpg');
        background: ;
    }

    
</style>




<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=%E5%8A%9B%E6%89%A3" title="åŠ›æ‰£">åŠ›æ‰£</a>
                        
                    </div>
                    <h1>åŠ›æ‰£ 30å¤©pandasæŒ‘æˆ˜</h1>
                    
                    <h2 class="subheading">33é¢˜  é¢˜ç›®+æµ‹è¯•æ•°æ®+å®ŒæˆæŒ‘æˆ˜</h2>
                    <span class="meta">Posted by Hilda on March 3, 2025</span>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>

<p>NumPy åšå®¢æ€»ç»“ï¼š</p>

<p><a href="https://kirsten-1.github.io/2025/02/14/NumPy%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97(%E7%AC%AC2%E7%89%88)%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93/">ã€ŠPythonæ•°æ®åˆ†æåŸºç¡€æ•™ç¨‹ï¼šNumPyå­¦ä¹ æŒ‡å—ï¼ˆç¬¬2ç‰ˆï¼‰ã€‹æ‰€æœ‰ç« èŠ‚é˜…è¯»ç¬”è®°+ä»£ç </a></p>

<p><a href="https://kirsten-1.github.io/2025/02/21/NumPy70%E9%A2%98/">70é“NumPy é¢è¯•é¢˜(é¢˜ç›®+ç­”æ¡ˆ)</a></p>

<p>pandasåšå®¢æ€»ç»“ï¼š</p>

<p><a href="https://kirsten-1.github.io/2025/02/21/Pandas(1)%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/">pandas(1)æ•°æ®é¢„å¤„ç†</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/24/Pandas(2)%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">pandas(2)æ•°æ®åˆ†æ</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/24/pandas(3)%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C/">pandas(3)å¸¸ç”¨å‡½æ•°æ“ä½œ</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/25/Pandas(4)%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%8A%80%E5%B7%A7/">pandas(4)å¤§æ•°æ®å¤„ç†æŠ€å·§</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/25/%E5%8A%9B%E6%89%A3pandas%E5%85%A5%E9%97%A815%E9%A2%98/">ã€åŠ›æ‰£ã€‘pandaså…¥é—¨15é¢˜</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/28/pandas%E9%87%8D%E8%A6%81%E5%87%BD%E6%95%B0transform/">è¿”å›ä¸è¾“å…¥ç»„å…·æœ‰ç›¸åŒå½¢çŠ¶çš„ç»“æœçš„transformå‡½æ•°</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/28/%E8%BD%AC%E6%8D%A2%E4%B8%8E%E9%87%8D%E5%A1%91df-melt%E5%87%BD%E6%95%B0/">meltå‡½æ•°-dfé•¿å®½å˜å½¢å¤§å¸ˆ - meltçš„é‡å¡‘ç¥åŠŸã€meltå‡½æ•°çš„ä»‹ç»ä¸ç»ƒä¹ ã€‘</a></p>

<hr />

<p>æœ¬ç¯‡åšå®¢æ˜¯åŠ›æ‰£çš„â€œ30å¤©pandasæŒ‘æˆ˜â€ã€‚â€”â€“ä¸€å…±30é¢˜</p>

<h1 id="ç¬¬ä¸€ç±»æ¡ä»¶ç­›é€‰">ç¬¬ä¸€ç±»ï¼šæ¡ä»¶ç­›é€‰</h1>

<h2 id="595-å¤§çš„å›½å®¶">595. å¤§çš„å›½å®¶</h2>

<p><a href="https://leetcode.cn/problems/big-countries/">595. å¤§çš„å›½å®¶</a></p>

<p><code class="language-plaintext highlighter-rouge">World</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| name        | varchar |
| continent   | varchar |
| area        | int     |
| population  | int     |
| gdp         | bigint  |
+-------------+---------+
name æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—ï¼‰ã€‚
è¿™å¼ è¡¨çš„æ¯ä¸€è¡Œæä¾›ï¼šå›½å®¶åç§°ã€æ‰€å±å¤§é™†ã€é¢ç§¯ã€äººå£å’Œ GDP å€¼ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¦‚æœä¸€ä¸ªå›½å®¶æ»¡è¶³ä¸‹è¿°ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼Œåˆ™è®¤ä¸ºè¯¥å›½æ˜¯ <strong>å¤§å›½</strong> ï¼š</p>

<ul>
  <li>é¢ç§¯è‡³å°‘ä¸º 300 ä¸‡å¹³æ–¹å…¬é‡Œï¼ˆå³ï¼Œ<code class="language-plaintext highlighter-rouge">3000000 km2</code>ï¼‰ï¼Œæˆ–è€…</li>
  <li>äººå£è‡³å°‘ä¸º 2500 ä¸‡ï¼ˆå³ <code class="language-plaintext highlighter-rouge">25000000</code>ï¼‰</li>
</ul>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡º <strong>å¤§å›½</strong> çš„å›½å®¶åç§°ã€äººå£å’Œé¢ç§¯ã€‚</p>

<p>æŒ‰ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
World è¡¨ï¼š
+-------------+-----------+---------+------------+--------------+
| name        | continent | area    | population | gdp          |
+-------------+-----------+---------+------------+--------------+
| Afghanistan | Asia      | 652230  | 25500100   | 20343000000  |
| Albania     | Europe    | 28748   | 2831741    | 12960000000  |
| Algeria     | Africa    | 2381741 | 37100000   | 188681000000 |
| Andorra     | Europe    | 468     | 78115      | 3712000000   |
| Angola      | Africa    | 1246700 | 20609294   | 100990000000 |
+-------------+-----------+---------+------------+--------------+
è¾“å‡ºï¼š
+-------------+------------+---------+
| name        | population | area    |
+-------------+------------+---------+
| Afghanistan | 25500100   | 652230  |
| Algeria     | 37100000   | 2381741 |
+-------------+------------+---------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">big_countries</span><span class="p">(</span><span class="n">world</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">world</span><span class="p">[(</span><span class="n">world</span><span class="p">[</span><span class="sh">'</span><span class="s">area</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3000000</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">world</span><span class="p">[</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">25000000</span><span class="p">)][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">area</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1757-å¯å›æ”¶ä¸”ä½è„‚çš„äº§å“">1757. å¯å›æ”¶ä¸”ä½è„‚çš„äº§å“</h2>

<p><a href="https://leetcode.cn/problems/recyclable-and-low-fat-products/">1757. å¯å›æ”¶ä¸”ä½è„‚çš„äº§å“</a></p>

<p>è¡¨ï¼š<code class="language-plaintext highlighter-rouge">Products</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| product_id  | int     |
| low_fats    | enum    |
| recyclable  | enum    |
+-------------+---------+
product_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—ï¼‰ã€‚
low_fats æ˜¯æšä¸¾ç±»å‹ï¼Œå–å€¼ä¸ºä»¥ä¸‹ä¸¤ç§ ('Y', 'N')ï¼Œå…¶ä¸­ 'Y' è¡¨ç¤ºè¯¥äº§å“æ˜¯ä½è„‚äº§å“ï¼Œ'N' è¡¨ç¤ºä¸æ˜¯ä½è„‚äº§å“ã€‚
recyclable æ˜¯æšä¸¾ç±»å‹ï¼Œå–å€¼ä¸ºä»¥ä¸‹ä¸¤ç§ ('Y', 'N')ï¼Œå…¶ä¸­ 'Y' è¡¨ç¤ºè¯¥äº§å“å¯å›æ”¶ï¼Œè€Œ 'N' è¡¨ç¤ºä¸å¯å›æ”¶ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡ºæ—¢æ˜¯ä½è„‚åˆæ˜¯å¯å›æ”¶çš„äº§å“ç¼–å·ã€‚</p>

<p>è¿”å›ç»“æœ <strong>æ— é¡ºåºè¦æ±‚</strong> ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Products è¡¨ï¼š
+-------------+----------+------------+
| product_id  | low_fats | recyclable |
+-------------+----------+------------+
| 0           | Y        | N          |
| 1           | Y        | Y          |
| 2           | N        | Y          |
| 3           | Y        | Y          |
| 4           | N        | N          |
+-------------+----------+------------+
è¾“å‡ºï¼š
+-------------+
| product_id  |
+-------------+
| 1           |
| 3           |
+-------------+
è§£é‡Šï¼š
åªæœ‰äº§å“ id ä¸º 1 å’Œ 3 çš„äº§å“ï¼Œæ—¢æ˜¯ä½è„‚åˆæ˜¯å¯å›æ”¶çš„äº§å“ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_products</span><span class="p">(</span><span class="n">products</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">products</span><span class="p">[(</span><span class="n">products</span><span class="p">[</span><span class="sh">'</span><span class="s">low_fats</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">"</span><span class="s">Y</span><span class="sh">"</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">products</span><span class="p">[</span><span class="sh">'</span><span class="s">recyclable</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">"</span><span class="s">Y</span><span class="sh">"</span><span class="p">)][[</span><span class="sh">'</span><span class="s">product_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="183-ä»ä¸è®¢è´­çš„å®¢æˆ·">ğŸŒŸ183. ä»ä¸è®¢è´­çš„å®¢æˆ·</h2>

<p><a href="https://leetcode.cn/problems/customers-who-never-order/">183. ä»ä¸è®¢è´­çš„å®¢æˆ·</a></p>

<p><code class="language-plaintext highlighter-rouge">Customers</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
åœ¨ SQL ä¸­ï¼Œid æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå®¢æˆ·çš„ ID å’Œåç§°ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Orders</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| customerId  | int  |
+-------------+------+
åœ¨ SQL ä¸­ï¼Œid æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
customerId æ˜¯ Customers è¡¨ä¸­ ID çš„å¤–é”®( Pandas ä¸­çš„è¿æ¥é”®)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºè®¢å•çš„ ID å’Œè®¢è´­è¯¥è®¢å•çš„å®¢æˆ·çš„ IDã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ‰¾å‡ºæ‰€æœ‰ä»ä¸ç‚¹ä»»ä½•ä¸œè¥¿çš„é¡¾å®¢ã€‚</p>

<p>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Customers table:
+----+-------+
| id | name  |
+----+-------+
| 1  | Joe   |
| 2  | Henry |
| 3  | Sam   |
| 4  | Max   |
+----+-------+
Orders table:
+----+------------+
| id | customerId |
+----+------------+
| 1  | 3          |
| 2  | 1          |
+----+------------+
è¾“å‡ºï¼š
+-----------+
| Customers |
+-----------+
| Henry     |
| Max       |
+-----------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_customers</span><span class="p">(</span><span class="n">customers</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">customers</span><span class="p">,</span> <span class="n">orders</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="o">~</span><span class="n">merged_df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="nf">isnull</span><span class="p">()][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
    <span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Customers</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ˜¯ä¸€æ­¥ä¸€æ­¥è°ƒè¯•å‡ºæ¥çš„ï¼Œå‚è€ƒä¸‹é¢ä»£ç ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1"># Customers è¡¨çš„æ•°æ®
</span><span class="n">customers_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                  <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Joe</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Henry</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Max</span><span class="sh">'</span><span class="p">]}</span>

<span class="c1"># Orders è¡¨çš„æ•°æ®
</span><span class="n">orders_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
               <span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>

<span class="c1"># åˆ›å»º Customers DataFrame
</span><span class="n">customers</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">customers_data</span><span class="p">)</span>
<span class="n">customers</span> <span class="o">=</span> <span class="n">customers</span><span class="p">.</span><span class="nf">set_index</span><span class="p">(</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># è®¾ç½® id åˆ—ä¸ºä¸»é”®ï¼ˆç´¢å¼•ï¼‰
</span>
<span class="c1"># åˆ›å»º Orders DataFrame
</span><span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">orders_data</span><span class="p">)</span>
<span class="n">orders</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="nf">set_index</span><span class="p">(</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># è®¾ç½® id åˆ—ä¸ºä¸»é”®ï¼ˆç´¢å¼•ï¼‰
</span>
<span class="nf">display</span><span class="p">(</span><span class="n">orders</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">customers</span><span class="p">)</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">customers</span><span class="p">,</span> <span class="n">orders</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">display</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>


<span class="n">res</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="nf">isnull</span><span class="p">()][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
<span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Customers</span><span class="sh">"</span><span class="p">]</span>
<span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250225164429895.png" alt="image-20250225164429895" style="zoom:50%;" /></p>

<p>ä½†æ˜¯è¿è¡Œè¿‡äº†ï¼Œæäº¤å°±æœ‰é”™ã€‚</p>

<p>æ›´ç®€å•çš„æ–¹æ³•ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_customers</span><span class="p">(</span><span class="n">customers</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">customers</span><span class="p">[</span><span class="o">~</span><span class="n">customers</span><span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">])][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
    <span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Customers</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1148-æ–‡ç« æµè§ˆ-i">1148. æ–‡ç« æµè§ˆ I</h2>

<p><a href="https://leetcode.cn/problems/article-views-i/">1148. æ–‡ç« æµè§ˆ I</a></p>

<p><code class="language-plaintext highlighter-rouge">Views</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| article_id    | int     |
| author_id     | int     |
| viewer_id     | int     |
| view_date     | date    |
+---------------+---------+
æ­¤è¡¨å¯èƒ½ä¼šå­˜åœ¨é‡å¤è¡Œã€‚ï¼ˆæ¢å¥è¯è¯´ï¼Œåœ¨ SQL ä¸­è¿™ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ï¼‰
æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºæŸäººåœ¨æŸå¤©æµè§ˆäº†æŸä½ä½œè€…çš„æŸç¯‡æ–‡ç« ã€‚
è¯·æ³¨æ„ï¼ŒåŒä¸€äººçš„ author_id å’Œ viewer_id æ˜¯ç›¸åŒçš„ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¯·æŸ¥è¯¢å‡ºæ‰€æœ‰æµè§ˆè¿‡è‡ªå·±æ–‡ç« çš„ä½œè€…</p>

<p>ç»“æœæŒ‰ç…§ <code class="language-plaintext highlighter-rouge">id</code> å‡åºæ’åˆ—ã€‚</p>

<p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Views è¡¨ï¼š
+------------+-----------+-----------+------------+
| article_id | author_id | viewer_id | view_date  |
+------------+-----------+-----------+------------+
| 1          | 3         | 5         | 2019-08-01 |
| 1          | 3         | 6         | 2019-08-02 |
| 2          | 7         | 7         | 2019-08-01 |
| 2          | 7         | 6         | 2019-08-02 |
| 4          | 7         | 1         | 2019-07-22 |
| 3          | 4         | 4         | 2019-07-21 |
| 3          | 4         | 4         | 2019-07-21 |
+------------+-----------+-----------+------------+

è¾“å‡ºï¼š
+------+
| id   |
+------+
| 4    |
| 7    |
+------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">article_views</span><span class="p">(</span><span class="n">views</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">views</span><span class="p">[</span><span class="n">views</span><span class="p">[</span><span class="sh">'</span><span class="s">author_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">views</span><span class="p">[</span><span class="sh">'</span><span class="s">viewer_id</span><span class="sh">'</span><span class="p">]][[</span><span class="sh">'</span><span class="s">author_id</span><span class="sh">'</span><span class="p">]].</span><span class="nf">drop_duplicates</span><span class="p">()</span>
    <span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="ç¬¬äºŒç±»å­—ç¬¦ä¸²å‡½æ•°">ç¬¬äºŒç±»ï¼šå­—ç¬¦ä¸²å‡½æ•°</h1>

<h2 id="1683-æ— æ•ˆçš„æ¨æ–‡">1683. æ— æ•ˆçš„æ¨æ–‡</h2>

<p><a href="https://leetcode.cn/problems/invalid-tweets/">1683. æ— æ•ˆçš„æ¨æ–‡</a></p>

<p>è¡¨ï¼š<code class="language-plaintext highlighter-rouge">Tweets</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+----------------+---------+
| Column Name    | Type    |
+----------------+---------+
| tweet_id       | int     |
| content        | varchar |
+----------------+---------+
åœ¨ SQL ä¸­ï¼Œtweet_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
content åªåŒ…å«ç¾å¼é”®ç›˜ä¸Šçš„å­—ç¬¦ï¼Œä¸åŒ…å«å…¶å®ƒç‰¹æ®Šå­—ç¬¦ã€‚
è¿™ä¸ªè¡¨åŒ…å«æŸç¤¾äº¤åª’ä½“ App ä¸­æ‰€æœ‰çš„æ¨æ–‡ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢æ‰€æœ‰æ— æ•ˆæ¨æ–‡çš„ç¼–å·ï¼ˆIDï¼‰ã€‚å½“æ¨æ–‡å†…å®¹ä¸­çš„å­—ç¬¦æ•°<strong>ä¸¥æ ¼å¤§äº</strong> <code class="language-plaintext highlighter-rouge">15</code> æ—¶ï¼Œè¯¥æ¨æ–‡æ˜¯æ— æ•ˆçš„ã€‚</p>

<p>ä»¥<strong>ä»»æ„é¡ºåº</strong>è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Tweets è¡¨ï¼š
+----------+----------------------------------+
| tweet_id | content                          |
+----------+----------------------------------+
| 1        | Vote for Biden                   |
| 2        | Let us make America great again! |
+----------+----------------------------------+

è¾“å‡ºï¼š
+----------+
| tweet_id |
+----------+
| 2        |
+----------+
è§£é‡Šï¼š
æ¨æ–‡ 1 çš„é•¿åº¦ length = 14ã€‚è¯¥æ¨æ–‡æ˜¯æœ‰æ•ˆçš„ã€‚
æ¨æ–‡ 2 çš„é•¿åº¦ length = 32ã€‚è¯¥æ¨æ–‡æ˜¯æ— æ•ˆçš„ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">invalid_tweets</span><span class="p">(</span><span class="n">tweets</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">tweets</span><span class="p">[</span><span class="n">tweets</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span> <span class="p">)][[</span><span class="sh">'</span><span class="s">tweet_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç„¶åçœ‹åˆ°ä¸€ä¸ªæ–¹æ³•ï¼Œæ˜¯æˆ‘åŸå…ˆçš„æƒ³æ³•ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">invalid_tweets</span><span class="p">(</span><span class="n">tweets</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">tweets</span><span class="p">[</span><span class="n">tweets</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">][[</span><span class="sh">'</span><span class="s">tweet_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ³¨ï¼š<code class="language-plaintext highlighter-rouge">len(tweets['content'].str)</code> ä¼šæŠ¥é”™ï¼Œè¿™ä¸ªè¯­å¥è¿”å›çš„æ˜¯ä¸€ä¸ªserieså¯¹è±¡ï¼Œä¸å¯è¿­ä»£ï¼›lenå‡½æ•°éœ€è¦æ˜¯å¯è¿­ä»£å¯¹è±¡æ‰èƒ½è®¡æ•°</p>

<h2 id="1873-è®¡ç®—ç‰¹æ®Šå¥–é‡‘">1873. è®¡ç®—ç‰¹æ®Šå¥–é‡‘</h2>

<p><a href="https://leetcode.cn/problems/calculate-special-bonus/">1873. è®¡ç®—ç‰¹æ®Šå¥–é‡‘</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Employees</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| åˆ—å        | ç±»å‹     |
+-------------+---------+
| employee_id | int     |
| name        | varchar |
| salary      | int     |
+-------------+---------+
employee_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
æ­¤è¡¨çš„æ¯ä¸€è¡Œç»™å‡ºäº†é›‡å‘˜id ï¼Œåå­—å’Œè–ªæ°´ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œè®¡ç®—æ¯ä¸ªé›‡å‘˜çš„å¥–é‡‘ã€‚å¦‚æœä¸€ä¸ªé›‡å‘˜çš„ id æ˜¯ <strong>å¥‡æ•°</strong> å¹¶ä¸”ä»–çš„åå­—ä¸æ˜¯ä»¥ <code class="language-plaintext highlighter-rouge">'M'</code> <strong>å¼€å¤´</strong>ï¼Œé‚£ä¹ˆä»–çš„å¥–é‡‘æ˜¯ä»–å·¥èµ„çš„ <code class="language-plaintext highlighter-rouge">100%</code> ï¼Œå¦åˆ™å¥–é‡‘ä¸º <code class="language-plaintext highlighter-rouge">0</code> ã€‚</p>

<p>è¿”å›çš„ç»“æœæŒ‰ç…§ <code class="language-plaintext highlighter-rouge">employee_id</code> æ’åºã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Employees è¡¨:
+-------------+---------+--------+
| employee_id | name    | salary |
+-------------+---------+--------+
| 2           | Meir    | 3000   |
| 3           | Michael | 3800   |
| 7           | Addilyn | 7400   |
| 8           | Juan    | 6100   |
| 9           | Kannon  | 7700   |
+-------------+---------+--------+
è¾“å‡ºï¼š
+-------------+-------+
| employee_id | bonus |
+-------------+-------+
| 2           | 0     |
| 3           | 0     |
| 7           | 7400  |
| 8           | 0     |
| 9           | 7700  |
+-------------+-------+
è§£é‡Šï¼š
å› ä¸ºé›‡å‘˜idæ˜¯å¶æ•°ï¼Œæ‰€ä»¥é›‡å‘˜id æ˜¯2å’Œ8çš„ä¸¤ä¸ªé›‡å‘˜å¾—åˆ°çš„å¥–é‡‘æ˜¯0ã€‚
é›‡å‘˜idä¸º3çš„å› ä¸ºä»–çš„åå­—ä»¥'M'å¼€å¤´ï¼Œæ‰€ä»¥ï¼Œå¥–é‡‘æ˜¯0ã€‚
å…¶ä»–çš„é›‡å‘˜å¾—åˆ°äº†ç™¾åˆ†ä¹‹ç™¾çš„å¥–é‡‘ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">calculate_special_bonus</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">][(</span><span class="o">~</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> 
                    <span class="p">(</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="sh">"</span><span class="s">M</span><span class="sh">"</span><span class="p">))</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">"</span><span class="s">salary</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">bonus</span><span class="sh">"</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bonus</span><span class="sh">'</span><span class="p">]].</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å‚è€ƒç­”æ¡ˆï¼šï¼ˆåˆ«äººå†™çš„ï¼Œä½†æˆ‘æ„Ÿè§‰å¾ˆä¸é”™ï¼‰</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">calculate_special_bonus</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">bonus</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="sh">'</span><span class="s">M</span><span class="sh">'</span><span class="p">))</span> <span class="o">*</span> <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">employees</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">employees</span><span class="p">[[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">bonus</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1667-ä¿®å¤è¡¨ä¸­çš„åå­—">1667. ä¿®å¤è¡¨ä¸­çš„åå­—</h2>

<p><a href="https://leetcode.cn/problems/fix-names-in-a-table/">1667. ä¿®å¤è¡¨ä¸­çš„åå­—</a></p>

<p>è¡¨ï¼š <code class="language-plaintext highlighter-rouge">Users</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+----------------+---------+
| Column Name    | Type    |
+----------------+---------+
| user_id        | int     |
| name           | varchar |
+----------------+---------+
user_id æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨åŒ…å«ç”¨æˆ·çš„ ID å’Œåå­—ã€‚åå­—ä»…ç”±å°å†™å’Œå¤§å†™å­—ç¬¦ç»„æˆã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œä¿®å¤åå­—ï¼Œä½¿å¾—åªæœ‰ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¤§å†™çš„ï¼Œå…¶ä½™éƒ½æ˜¯å°å†™çš„ã€‚</p>

<p>è¿”å›æŒ‰ <code class="language-plaintext highlighter-rouge">user_id</code> æ’åºçš„ç»“æœè¡¨ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼ç¤ºä¾‹å¦‚ä¸‹ã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Users table:
+---------+-------+
| user_id | name  |
+---------+-------+
| 1       | aLice |
| 2       | bOB   |
+---------+-------+
è¾“å‡ºï¼š
+---------+-------+
| user_id | name  |
+---------+-------+
| 1       | Alice |
| 2       | Bob   |
+---------+-------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">fix_names</span><span class="p">(</span><span class="n">users</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">users</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">users</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">capitalize</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">users</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¿™é“é¢˜å…¶å®å°±æ˜¯è€ƒå¯Ÿä¸€ä¸ªå‡½æ•°<code class="language-plaintext highlighter-rouge">capitalize()</code>ï¼Œæ²¡å•¥æ–°é²œçš„ã€‚</p>

<h2 id="1517-æŸ¥æ‰¾æ‹¥æœ‰æœ‰æ•ˆé‚®ç®±çš„ç”¨æˆ·">ğŸŒŸ1517. æŸ¥æ‰¾æ‹¥æœ‰æœ‰æ•ˆé‚®ç®±çš„ç”¨æˆ·</h2>

<p><a href="https://leetcode.cn/problems/find-users-with-valid-e-mails/">1517. æŸ¥æ‰¾æ‹¥æœ‰æœ‰æ•ˆé‚®ç®±çš„ç”¨æˆ·</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Users</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| user_id       | int     |
| name          | varchar |
| mail          | varchar |
+---------------+---------+
user_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—ï¼‰ã€‚
è¯¥è¡¨åŒ…å«äº†ç½‘ç«™å·²æ³¨å†Œç”¨æˆ·çš„ä¿¡æ¯ã€‚æœ‰ä¸€äº›ç”µå­é‚®ä»¶æ˜¯æ— æ•ˆçš„ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œä»¥æŸ¥æ‰¾å…·æœ‰æœ‰æ•ˆç”µå­é‚®ä»¶çš„ç”¨æˆ·ã€‚</p>

<p>ä¸€ä¸ªæœ‰æ•ˆçš„ç”µå­é‚®ä»¶å…·æœ‰å‰ç¼€åç§°å’ŒåŸŸï¼Œå…¶ä¸­ï¼š</p>

<ol>
  <li><strong>å‰ç¼€</strong> åç§°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥åŒ…å«å­—æ¯ï¼ˆå¤§å†™æˆ–å°å†™ï¼‰ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ <code class="language-plaintext highlighter-rouge">'_'</code> ï¼Œç‚¹ <code class="language-plaintext highlighter-rouge">'.'</code> å’Œ/æˆ–ç ´æŠ˜å· <code class="language-plaintext highlighter-rouge">'-'</code> ã€‚å‰ç¼€åç§° <strong>å¿…é¡»</strong> ä»¥å­—æ¯å¼€å¤´ã€‚</li>
  <li><strong>åŸŸ</strong> ä¸º <code class="language-plaintext highlighter-rouge">'@leetcode.com'</code> ã€‚</li>
</ol>

<p>ä»¥ä»»ä½•é¡ºåºè¿”å›ç»“æœè¡¨ã€‚</p>

<p>ç»“æœçš„æ ¼å¼å¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Users è¡¨:
+---------+-----------+-------------------------+
| user_id | name      | mail                    |
+---------+-----------+-------------------------+
| 1       | Winston   | winston@leetcode.com    |
| 2       | Jonathan  | jonathanisgreat         |
| 3       | Annabelle | bella-@leetcode.com     |
| 4       | Sally     | sally.come@leetcode.com |
| 5       | Marwan    | quarz#2020@leetcode.com |
| 6       | David     | david69@gmail.com       |
| 7       | Shapiro   | .shapo@leetcode.com     |
+---------+-----------+-------------------------+
è¾“å‡ºï¼š
+---------+-----------+-------------------------+
| user_id | name      | mail                    |
+---------+-----------+-------------------------+
| 1       | Winston   | winston@leetcode.com    |
| 3       | Annabelle | bella-@leetcode.com     |
| 4       | Sally     | sally.come@leetcode.com |
+---------+-----------+-------------------------+
è§£é‡Šï¼š
ç”¨æˆ· 2 çš„ç”µå­é‚®ä»¶æ²¡æœ‰åŸŸã€‚ 
ç”¨æˆ· 5 çš„ç”µå­é‚®ä»¶å¸¦æœ‰ä¸å…è®¸çš„ '#' ç¬¦å·ã€‚
ç”¨æˆ· 6 çš„ç”µå­é‚®ä»¶æ²¡æœ‰ leetcode åŸŸã€‚ 
ç”¨æˆ· 7 çš„ç”µå­é‚®ä»¶ä»¥ç‚¹å¼€å¤´ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">valid_emails</span><span class="p">(</span><span class="n">users</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">^[A-Za-z][A-Za-z0-9_./-]*@leetcode\.com$</span><span class="sh">'</span>
    <span class="k">return</span> <span class="n">users</span><span class="p">[</span><span class="n">users</span><span class="p">[</span><span class="sh">'</span><span class="s">mail</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¿™é“é¢˜å…³é”®æ˜¯æŠŠæ­£åˆ™çœ‹æ‡‚ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">^</code>: åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">[A-Za-z]</code>: å¿…é¡»ä»¥å­—æ¯ï¼ˆå¤§å†™æˆ–å°å†™ï¼‰å¼€å¤´ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">[A-Za-z0-9_.-]*</code>: å…è®¸å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ç‚¹å’Œç ´æŠ˜å·çš„ç»„åˆï¼Œå¯ä»¥å‡ºç° 0 æ¬¡æˆ–å¤šæ¬¡ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">@XXX\.com</code>: å¼ºåˆ¶è¦æ±‚ä»¥â€<code class="language-plaintext highlighter-rouge">@XXX.com</code>â€œç»“å°¾ï¼Œ<code class="language-plaintext highlighter-rouge">\.</code> è¡¨ç¤ºåŒ¹é…å®é™…çš„ç‚¹å­—ç¬¦.</li>
  <li><code class="language-plaintext highlighter-rouge">$</code>: åŒ¹é…å­—ç¬¦ä¸²çš„ç»“å°¾.</li>
</ul>

<p>æœ€å¥½@ä¹Ÿè½¬ä¹‰ä¸€ä¸‹ï¼š<code class="language-plaintext highlighter-rouge">\@</code>?   å…¶å®<code class="language-plaintext highlighter-rouge">python 3.7</code>ä»¥åçš„<code class="language-plaintext highlighter-rouge">@</code>å­—ç¬¦ä¸å†éœ€è¦è½¬ä¹‰</p>

<p>å¦å¤–case=Falseå¯ä»¥ä¸å†™ï¼Œå› ä¸ºä¸€å¼€å§‹å·²ç»å†™äº†<code class="language-plaintext highlighter-rouge">^[A-Za-z]</code></p>

<hr />

<h2 id="1527-æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…">1527. æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…</h2>

<p><a href="https://leetcode.cn/problems/patients-with-a-condition/">1527. æ‚£æŸç§ç–¾ç—…çš„æ‚£è€…</a></p>

<p>æ‚£è€…ä¿¡æ¯è¡¨ï¼š <code class="language-plaintext highlighter-rouge">Patients</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| patient_id   | int     |
| patient_name | varchar |
| conditions   | varchar |
+--------------+---------+
åœ¨ SQL ä¸­ï¼Œpatient_id ï¼ˆæ‚£è€… IDï¼‰æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
'conditions' ï¼ˆç–¾ç—…ï¼‰åŒ…å« 0 ä¸ªæˆ–ä»¥ä¸Šçš„ç–¾ç—…ä»£ç ï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚
è¿™ä¸ªè¡¨åŒ…å«åŒ»é™¢ä¸­æ‚£è€…çš„ä¿¡æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢æ‚£æœ‰ I ç±»ç³–å°¿ç—…çš„æ‚£è€… ID ï¼ˆpatient_idï¼‰ã€æ‚£è€…å§“åï¼ˆpatient_nameï¼‰ä»¥åŠå…¶æ‚£æœ‰çš„æ‰€æœ‰ç–¾ç—…ä»£ç ï¼ˆconditionsï¼‰ã€‚I ç±»ç³–å°¿ç—…çš„ä»£ç æ€»æ˜¯åŒ…å«å‰ç¼€ <code class="language-plaintext highlighter-rouge">DIAB1</code> ã€‚</p>

<p>æŒ‰ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Patientsè¡¨ï¼š
+------------+--------------+--------------+
| patient_id | patient_name | conditions   |
+------------+--------------+--------------+
| 1          | Daniel       | YFEV COUGH   |
| 2          | Alice        |              |
| 3          | Bob          | DIAB100 MYOP |
| 4          | George       | ACNE DIAB100 |
| 5          | Alain        | DIAB201      |
+------------+--------------+--------------+
è¾“å‡ºï¼š
+------------+--------------+--------------+
| patient_id | patient_name | conditions   |
+------------+--------------+--------------+
| 3          | Bob          | DIAB100 MYOP |
| 4          | George       | ACNE DIAB100 | 
+------------+--------------+--------------+
è§£é‡Šï¼šBob å’Œ George éƒ½æ‚£æœ‰ä»£ç ä»¥ DIAB1 å¼€å¤´çš„ç–¾ç—…ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_patients</span><span class="p">(</span><span class="n">patients</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">patients</span><span class="p">[</span><span class="n">patients</span><span class="p">[</span><span class="sh">'</span><span class="s">conditions</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">^DIAB1|\sDIAB1</span><span class="sh">'</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¿™é¢˜æ˜¯çœŸä¸ä¼šå†™äº†.å› ä¸ºæ— æ³•æäº¤æˆåŠŸï¼Œä½†æ˜¯æˆ‘æ‹¿å®˜æ–¹çš„ç­”æ¡ˆï¼ˆæ–¹æ³•1ï¼‰è¯•äº†ä¸‹ä¹Ÿé€šè¿‡ä¸äº†ï¼ˆ<code class="language-plaintext highlighter-rouge">+DIAB1</code>è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹æ— æ³•é€šè¿‡ï¼‰ï¼Œå’Œæˆ‘çš„æƒ…å†µæ˜¯ä¸€æ ·çš„ã€‚ä¸Šé¢è¿™ä¸ªè§£ç­”æ˜¯æ–¹æ³•1ä¿®æ”¹æˆåŠŸä¹‹åçš„è§£æ³•ï¼Œä¹Ÿæ˜¯è¯„è®ºåŒºçœ‹çš„ã€‚</p>

<p>è§£é‡Šè¿™ä¸ªæ­£åˆ™ï¼š<code class="language-plaintext highlighter-rouge">^DIAB1</code>åŒ¹é…conditionså­—æ®µä»¥DIAB1å¼€å¤´çš„æƒ…å†µã€‚ <code class="language-plaintext highlighter-rouge">\sDIAB1</code>åŒ¹é…conditionsä¸­ç©ºæ ¼åç´§è·ŸDIAB1çš„æƒ…å†µã€‚ <code class="language-plaintext highlighter-rouge">| </code>æ˜¯é€»è¾‘â€œæˆ–â€çš„è¿ç®—ç¬¦ï¼Œè¡¨ç¤ºåŒ¹é…ä¸¤ç§æƒ…å†µä¸­çš„ä»»æ„ä¸€ç§ã€‚</p>

<hr />

<h1 id="æµ‹éªŒé¢˜">æµ‹éªŒé¢˜</h1>

<h2 id="2738-ç»Ÿè®¡æ–‡æœ¬ä¸­å•è¯çš„å‡ºç°æ¬¡æ•°">2738. ç»Ÿè®¡æ–‡æœ¬ä¸­å•è¯çš„å‡ºç°æ¬¡æ•°</h2>

<p><a href="https://leetcode.cn/problems/count-occurrences-in-text/">2738. ç»Ÿè®¡æ–‡æœ¬ä¸­å•è¯çš„å‡ºç°æ¬¡æ•°</a></p>

<p>è¡¨ï¼š<code class="language-plaintext highlighter-rouge">Files</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| åˆ—å        | ç±»å‹    |
+-- ----------+---------+
| file_name   | varchar |
| content     | text    |
+-------------+---------+
file_name ä¸ºè¯¥è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—ï¼‰ã€‚
æ¯è¡ŒåŒ…å« file_name å’Œè¯¥æ–‡ä»¶çš„å†…å®¹ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºå•è¯ <strong>â€˜bullâ€™</strong> å’Œ <strong>â€˜bearâ€™</strong> ä½œä¸º <strong>ç‹¬ç«‹è¯</strong> æœ‰å‡ºç°çš„æ–‡ä»¶æ•°é‡ï¼Œä¸è€ƒè™‘ä»»ä½•å®ƒå‡ºç°åœ¨ä¸¤ä¾§æ²¡æœ‰ç©ºæ ¼çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œâ€™bulletâ€™, â€˜bearsâ€™, â€˜bull.â€™ï¼Œæˆ–è€… â€˜bearâ€™ åœ¨å¥é¦–æˆ–å¥å°¾ <strong>ä¸ä¼š</strong> è¢«è€ƒè™‘ï¼‰ã€‚</p>

<p>è¿”å›å•è¯ â€˜bullâ€™ å’Œ â€˜bearâ€™ ä»¥åŠå®ƒä»¬å¯¹åº”çš„å‡ºç°æ–‡ä»¶æ•°é‡ï¼Œ<strong>é¡ºåºæ²¡æœ‰é™åˆ¶</strong> ã€‚</p>

<p>ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Files è¡¨:
+------------+----------------------------------------------------------------------------------+
| file_name  | contenet                                                                         | 
+------------+----------------------------------------------------------------------------------+
| draft1.txt | The stock exchange predicts a bull market which would make many investors happy. | 
| draft2.txt | The stock exchange predicts a bull market which would make many investors happy, |
|            | but analysts warn of possibility of too much optimism and that in fact we are    |
|            | awaiting a bear market.                                                          | 
| draft3.txt | The stock exchange predicts a bull market which would make many investors happy, |
|            | but analysts warn of possibility of too much optimism and that in fact we are    |
|            | awaiting a bear market. As always predicting the future market is an uncertain   |
|            | game and all investors should follow their instincts and best practices.         | 
+------------+----------------------------------------------------------------------------------+
è¾“å‡ºï¼š 
+------+-------+
| word | count |  
+------+-------+
| bull | 3     | 
| bear | 2     | 
+------+-------+
è§£é‡Šï¼š
- å•è¯ "bull" åœ¨ "draft1.txt" ä¸­å‡ºç°1æ¬¡ï¼Œåœ¨ "draft2.txt" ä¸­å‡ºç° 1 æ¬¡ï¼Œåœ¨ "draft3.txt" ä¸­å‡ºç° 1 æ¬¡ã€‚å› æ­¤ï¼Œå•è¯ "bull" å‡ºç°åœ¨ 3 ä¸ªæ–‡ä»¶ä¸­ã€‚
- å•è¯ "bear" åœ¨ "draft2.txt" ä¸­å‡ºç°1æ¬¡ï¼Œåœ¨ "draft3.txt" ä¸­å‡ºç° 1 æ¬¡ã€‚å› æ­¤ï¼Œå•è¯ "bear" å‡ºç°åœ¨ 2 ä¸ªæ–‡ä»¶ä¸­ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_occurrences</span><span class="p">(</span><span class="n">files</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="sh">'</span><span class="s">word</span><span class="sh">'</span><span class="p">:[</span><span class="sh">'</span><span class="s">bull</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bear</span><span class="sh">'</span><span class="p">],</span> 
        <span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">:[</span><span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">\sbull\s</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">(),</span> 
        <span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">\sbear\s</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()]}</span>
    <span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">\s</code>è¡¨ç¤ºç©ºæ ¼ã€‚</p>

<h1 id="æ•°æ®æ“ä½œ">æ•°æ®æ“ä½œ</h1>

<h2 id="177-ç¬¬né«˜çš„è–ªæ°´">177. ç¬¬Né«˜çš„è–ªæ°´</h2>

<p><a href="https://leetcode.cn/problems/nth-highest-salary/">177. ç¬¬Né«˜çš„è–ªæ°´</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Employee</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| salary      | int  |
+-------------+------+
åœ¨ SQL ä¸­ï¼Œid æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«æœ‰å…³å‘˜å·¥å·¥èµ„çš„ä¿¡æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢ <code class="language-plaintext highlighter-rouge">Employee</code> è¡¨ä¸­ç¬¬ <code class="language-plaintext highlighter-rouge">n</code> é«˜çš„å·¥èµ„ã€‚å¦‚æœæ²¡æœ‰ç¬¬ <code class="language-plaintext highlighter-rouge">n</code> ä¸ªæœ€é«˜å·¥èµ„ï¼ŒæŸ¥è¯¢ç»“æœåº”è¯¥ä¸º <code class="language-plaintext highlighter-rouge">null</code> ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Employee table:
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
n = 2
è¾“å‡º: 
+------------------------+
| getNthHighestSalary(2) |
+------------------------+
| 200                    |
+------------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ç¤ºä¾‹ 2:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Employee è¡¨:
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
+----+--------+
n = 2
è¾“å‡º: 
+------------------------+
| getNthHighestSalary(2) |
+------------------------+
| null                   |
+------------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘çš„ç­”æ¡ˆï¼šï¼ˆæ”¹äº†å¥½å¤šæ¬¡ï¼‰</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">nth_highest_salary</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">distinct_salaries</span> <span class="o">=</span> <span class="n">employee</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">drop_duplicates</span><span class="p">().</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">N</span> <span class="o">&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">distinct_salaries</span><span class="p">):</span>  <span class="c1">#Simplified condition
</span>        <span class="n">res</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">distinct_salaries</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">res</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="sh">'</span><span class="s">getNthHighestSalary(</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s">)</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="176-ç¬¬äºŒé«˜çš„è–ªæ°´">176. ç¬¬äºŒé«˜çš„è–ªæ°´</h2>

<p><a href="https://leetcode.cn/problems/second-highest-salary/">176. ç¬¬äºŒé«˜çš„è–ªæ°´</a></p>

<p><code class="language-plaintext highlighter-rouge">Employee</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| salary      | int  |
+-------------+------+
id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å‘˜å·¥çš„å·¥èµ„ä¿¡æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢å¹¶è¿”å› <code class="language-plaintext highlighter-rouge">Employee</code> è¡¨ä¸­ç¬¬äºŒé«˜çš„ <strong>ä¸åŒ</strong> è–ªæ°´ ã€‚å¦‚æœä¸å­˜åœ¨ç¬¬äºŒé«˜çš„è–ªæ°´ï¼ŒæŸ¥è¯¢åº”è¯¥è¿”å› <code class="language-plaintext highlighter-rouge">null(Pandas åˆ™è¿”å› None)</code> ã€‚</p>

<p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Employee è¡¨ï¼š
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
è¾“å‡ºï¼š
+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Employee è¡¨ï¼š
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
+----+--------+
è¾“å‡ºï¼š
+---------------------+
| SecondHighestSalary |
+---------------------+
| null                |
+---------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>åªä¸è¿‡å°±æ˜¯å‰ä¸€é¢˜å˜æˆäº†N=2çš„ç‰¹æ®Šæƒ…å†µï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">second_highest_salary</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">sorted_salary</span> <span class="o">=</span> <span class="n">employee</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">drop_duplicates</span><span class="p">().</span><span class="nf">sort_values</span><span class="p">(</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span>  <span class="nf">len</span><span class="p">(</span><span class="n">sorted_salary</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">sorted_salary</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">SecondHighestSalary</span><span class="sh">'</span><span class="p">],</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="184-éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥">184. éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥</h2>

<p><a href="https://leetcode.cn/problems/department-highest-salary/">184. éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥</a></p>

<p>è¡¨ï¼š <code class="language-plaintext highlighter-rouge">Employee</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| åˆ—å          | ç±»å‹    |
+--------------+---------+
| id           | int     |
| name         | varchar |
| salary       | int     |
| departmentId | int     |
+--------------+---------+
åœ¨ SQL ä¸­ï¼Œidæ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚
departmentId æ˜¯ Department è¡¨ä¸­ id çš„å¤–é”®ï¼ˆåœ¨ Pandas ä¸­ç§°ä¸º join keyï¼‰ã€‚
æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå‘˜å·¥çš„ idã€å§“åå’Œå·¥èµ„ã€‚å®ƒè¿˜åŒ…å«ä»–ä»¬æ‰€åœ¨éƒ¨é—¨çš„ idã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¡¨ï¼š <code class="language-plaintext highlighter-rouge">Department</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| åˆ—å         | ç±»å‹    |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
åœ¨ SQL ä¸­ï¼Œid æ˜¯æ­¤è¡¨çš„ä¸»é”®åˆ—ã€‚
æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºä¸€ä¸ªéƒ¨é—¨çš„ id åŠå…¶åç§°ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥æ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨ä¸­è–ªèµ„æœ€é«˜çš„å‘˜å·¥ã€‚
æŒ‰ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚
æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Employee è¡¨:
+----+-------+--------+--------------+
| id | name  | salary | departmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 70000  | 1            |
| 2  | Jim   | 90000  | 1            |
| 3  | Henry | 80000  | 2            |
| 4  | Sam   | 60000  | 2            |
| 5  | Max   | 90000  | 1            |
+----+-------+--------+--------------+
Department è¡¨:
+----+-------+
| id | name  |
+----+-------+
| 1  | IT    |
| 2  | Sales |
+----+-------+
è¾“å‡ºï¼š
+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Jim      | 90000  |
| Sales      | Henry    | 80000  |
| IT         | Max      | 90000  |
+------------+----------+--------+
è§£é‡Šï¼šMax å’Œ Jim åœ¨ IT éƒ¨é—¨çš„å·¥èµ„éƒ½æ˜¯æœ€é«˜çš„ï¼ŒHenry åœ¨é”€å”®éƒ¨çš„å·¥èµ„æœ€é«˜ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é“é¢˜æˆ‘å°†è°ƒè¯•éƒ¨åˆ†ä¹Ÿé™„ä¸Šä»£ç ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Employee DataFrame
</span><span class="n">employee_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Joe</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Jim</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Henry</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Max</span><span class="sh">'</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">70000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="n">employee</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">employee_data</span><span class="p">)</span>

<span class="c1"># Department DataFrame
</span><span class="n">department_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">IT</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sales</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">Department</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">department_data</span><span class="p">)</span>

<span class="n">Department</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">employee</span> <span class="o">=</span> <span class="n">employee</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">merge_table</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employee</span><span class="p">,</span> <span class="n">Department</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)</span>


<span class="nf">display</span><span class="p">(</span><span class="n">merge_table</span><span class="p">)</span>
<span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_table</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">merge_table</span><span class="p">)</span>

<span class="n">merge_table</span><span class="p">[</span><span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]][[</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228134040360.png" alt="image-20250228134040360" style="zoom:50%;" /></p>

<p>å…³äºtransformå‡½æ•°ï¼Œå¯ä»¥å¤ä¹ ï¼š<a href="https://kirsten-1.github.io/2025/02/28/pandas%E9%87%8D%E8%A6%81%E5%87%BD%E6%95%B0transform/">è¿”å›ä¸è¾“å…¥ç»„å…·æœ‰ç›¸åŒå½¢çŠ¶çš„ç»“æœçš„transformå‡½æ•°</a></p>

<p>é¢˜è§£ç­”æ¡ˆæ˜¯ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">department_highest_salary</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">department</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">department</span> <span class="o">=</span> <span class="n">department</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">employee</span> <span class="o">=</span> <span class="n">employee</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">merge_table</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employee</span><span class="p">,</span> <span class="n">department</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_table</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">merge_table</span><span class="p">[</span><span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]][[</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]]</span>
    
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="178-åˆ†æ•°æ’å">178. åˆ†æ•°æ’å</h2>

<p><a href="https://leetcode.cn/problems/rank-scores/">178. åˆ†æ•°æ’å</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Scores</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| score       | decimal |
+-------------+---------+
id æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆæœ‰ä¸åŒå€¼çš„åˆ—ï¼‰ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«äº†ä¸€åœºæ¯”èµ›çš„åˆ†æ•°ã€‚Score æ˜¯ä¸€ä¸ªæœ‰ä¸¤ä½å°æ•°ç‚¹çš„æµ®ç‚¹å€¼ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥æŸ¥è¯¢åˆ†æ•°çš„æ’åã€‚æ’åæŒ‰ä»¥ä¸‹è§„åˆ™è®¡ç®—:</p>

<ul>
  <li>åˆ†æ•°åº”æŒ‰ä»é«˜åˆ°ä½æ’åˆ—ã€‚</li>
  <li>å¦‚æœä¸¤ä¸ªåˆ†æ•°ç›¸ç­‰ï¼Œé‚£ä¹ˆä¸¤ä¸ªåˆ†æ•°çš„æ’ååº”è¯¥ç›¸åŒã€‚</li>
  <li>åœ¨æ’åç›¸åŒçš„åˆ†æ•°åï¼Œæ’åæ•°åº”è¯¥æ˜¯ä¸‹ä¸€ä¸ªè¿ç»­çš„æ•´æ•°ã€‚æ¢å¥è¯è¯´ï¼Œæ’åä¹‹é—´ä¸åº”è¯¥æœ‰ç©ºç¼ºçš„æ•°å­—ã€‚</li>
</ul>

<p>æŒ‰ <code class="language-plaintext highlighter-rouge">score</code> é™åºè¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Scores è¡¨:
+----+-------+
| id | score |
+----+-------+
| 1  | 3.50  |
| 2  | 3.65  |
| 3  | 4.00  |
| 4  | 3.85  |
| 5  | 4.00  |
| 6  | 3.65  |
+----+-------+
è¾“å‡º: 
+-------+------+
| score | rank |
+-------+------+
| 4.00  | 1    |
| 4.00  | 1    |
| 3.85  | 2    |
| 3.65  | 3    |
| 3.65  | 3    |
| 3.50  | 4    |
+-------+------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é“é¢˜æˆ‘ç ”ç©¶äº†ä¸€ä¸‹rankå‡½æ•°çš„å‚æ•°,æœ€ç»ˆæœºç¼˜å·§åˆå±…ç„¶åšå‡ºæ¥äº†ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">order_scores</span><span class="p">(</span><span class="n">scores</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">dense</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">sorted_df</span> <span class="o">=</span> <span class="n">scores</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sorted_df</span><span class="p">[[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¡¥å……ï¼š<code class="language-plaintext highlighter-rouge">df['rank'] = df['score'].rank(ascending=False, method='dense')</code>ä¸­çš„<code class="language-plaintext highlighter-rouge">method</code>å‚æ•°ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">dense</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140539122.png" alt="image-20250228140539122" style="zoom:50%;" /></p>

<p>averageæ˜¯é»˜è®¤å‚æ•°ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">average</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140646508.png" alt="image-20250228140646508" style="zoom:50%;" /></p>

<p>è¡¥å……ï¼šå‰é¢çš„1.5æ˜¯è¿™ä¹ˆç®—çš„ï¼š</p>

<p>åº”è¯¥æ˜¯æ’å1å’Œ2ï¼Œä½†æ˜¯ä¸åˆ†å‰åï¼Œæ‰€ä»¥<code class="language-plaintext highlighter-rouge">ï¼ˆ1+2ï¼‰/2=1.5</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">min</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140801289.png" alt="image-20250228140801289" style="zoom:50%;" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140820912.png" alt="image-20250228140820912" style="zoom:50%;" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">first</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140903602.png" alt="image-20250228140903602" style="zoom:50%;" /></p>

<ul>
  <li><strong>method</strong>: æŒ‡å®šå¦‚ä½•å¤„ç†å¹³å±€ (ç›¸åŒçš„å€¼)ã€‚è¿™æ˜¯ rank() å‡½æ•°æœ€é‡è¦çš„å‚æ•°ä¹‹ä¸€ã€‚ é€‰é¡¹åŒ…æ‹¬ï¼š
    <ul>
      <li>â€˜averageâ€™ (é»˜è®¤): å°†å¹³å‡æ’ååˆ†é…ç»™æ¯ä¸ªå¹³å±€ç»„ä¸­çš„å€¼ã€‚</li>
      <li>â€˜minâ€™: å°†æœ€å°çš„æ’ååˆ†é…ç»™æ¯ä¸ªå¹³å±€ç»„ä¸­çš„å€¼ã€‚</li>
      <li>â€˜maxâ€™: å°†æœ€å¤§çš„æ’ååˆ†é…ç»™æ¯ä¸ªå¹³å±€ç»„ä¸­çš„å€¼ã€‚</li>
      <li>â€˜firstâ€™: æŒ‰ç…§å€¼åœ¨æ•°æ®ä¸­å‡ºç°çš„é¡ºåºåˆ†é…æ’åã€‚</li>
      <li>â€˜denseâ€™: ç±»ä¼¼äº â€˜minâ€™ï¼Œä½†æ’åä¹‹é—´æ²¡æœ‰é—´éš”ã€‚å³ï¼Œä¸‹ä¸€ä¸ªéå¹³å±€å€¼å°†è·å¾—ç´§éšå…¶åçš„æ’åã€‚</li>
    </ul>
  </li>
</ul>

<hr />

<h4 id="rankå¸¸è§çš„ä¸‰ç§æ’åºæ–¹å¼">rankå¸¸è§çš„ä¸‰ç§æ’åºæ–¹å¼</h4>

<ul>
  <li>First é¡ºåºæ’åï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5</li>
  <li>Min è·³è·ƒæ’åï¼Œ1ï¼Œ2ï¼Œ2ï¼Œ4ï¼Œ5ï¼ˆå¹¶åˆ—2/3åï¼Œå–å°çš„2ï¼‰</li>
  <li>Dense å¯†é›†æ’åï¼Œ1ï¼Œ2ï¼Œ2ï¼Œ3ï¼Œ4</li>
</ul>

<hr />

<h2 id="196-åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±">196. åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</h2>

<p><a href="https://leetcode.cn/problems/delete-duplicate-emails/">196. åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Person</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| email       | varchar |
+-------------+---------+
id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€å°ç”µå­é‚®ä»¶ã€‚ç”µå­é‚®ä»¶å°†ä¸åŒ…å«å¤§å†™å­—æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆ <strong>åˆ é™¤</strong> æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ä»¶ï¼Œåªä¿ç•™ä¸€ä¸ªå…·æœ‰æœ€å° <code class="language-plaintext highlighter-rouge">id</code> çš„å”¯ä¸€ç”µå­é‚®ä»¶ã€‚</p>

<p>ï¼ˆå¯¹äº SQL ç”¨æˆ·ï¼Œè¯·æ³¨æ„ä½ åº”è¯¥ç¼–å†™ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">DELETE</code> è¯­å¥è€Œä¸æ˜¯ <code class="language-plaintext highlighter-rouge">SELECT</code> è¯­å¥ã€‚ï¼‰</p>

<p>ï¼ˆå¯¹äº Pandas ç”¨æˆ·ï¼Œè¯·æ³¨æ„ä½ åº”è¯¥ç›´æ¥ä¿®æ”¹ <code class="language-plaintext highlighter-rouge">Person</code> è¡¨ã€‚ï¼‰</p>

<p>è¿è¡Œè„šæœ¬åï¼Œæ˜¾ç¤ºçš„ç­”æ¡ˆæ˜¯ <code class="language-plaintext highlighter-rouge">Person</code> è¡¨ã€‚é©±åŠ¨ç¨‹åºå°†é¦–å…ˆç¼–è¯‘å¹¶è¿è¡Œæ‚¨çš„ä»£ç ç‰‡æ®µï¼Œç„¶åå†æ˜¾ç¤º <code class="language-plaintext highlighter-rouge">Person</code> è¡¨ã€‚<code class="language-plaintext highlighter-rouge">Person</code> è¡¨çš„æœ€ç»ˆé¡ºåº <strong>æ— å…³ç´§è¦</strong> ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Person è¡¨:
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
| 3  | john@example.com |
+----+------------------+
è¾“å‡º: 
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
+----+------------------+
è§£é‡Š: john@example.comé‡å¤ä¸¤æ¬¡ã€‚æˆ‘ä»¬ä¿ç•™æœ€å°çš„Id = 1ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é¢˜å¤šå°‘æœ‰ç‚¹è„±è£¤å­æ”¾å±äº†ï¼Œå°±ä¸ºäº†å¼ºè°ƒç”¨<code class="language-plaintext highlighter-rouge">inplace=True</code>ï¼Œè€Œä¸”ç”¨2æ¬¡ , ç”¨è¿”å›å€¼å†èµ‹å€¼éƒ½ä¸è¡Œ</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1"># Person è¡¨:
# | id | email       |
# | -- | ----------- |
# | 2  | abc@efg.com |
# | 1  | abc@efg.com |
</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="sh">'</span><span class="s">email</span><span class="sh">'</span><span class="p">:[</span><span class="sh">'</span><span class="s">abc@efg.com</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">abc@efg.com</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">person</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>

<span class="n">person</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
<span class="n">person</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">email</span><span class="sh">'</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="sh">'</span><span class="s">first</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228143321106.png" alt="image-20250228143321106" style="zoom:50%;" /></p>

<h2 id="1795-æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼">1795. æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼</h2>

<p><a href="https://leetcode.cn/problems/rearrange-products-table/">1795. æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼</a></p>

<p>è¡¨ï¼š<code class="language-plaintext highlighter-rouge">Products</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| product_id  | int     |
| store1      | int     |
| store2      | int     |
| store3      | int     |
+-------------+---------+
åœ¨ SQL ä¸­ï¼Œè¿™å¼ è¡¨çš„ä¸»é”®æ˜¯ product_idï¼ˆäº§å“Idï¼‰ã€‚
æ¯è¡Œå­˜å‚¨äº†è¿™ä¸€äº§å“åœ¨ä¸åŒå•†åº— store1, store2, store3 çš„ä»·æ ¼ã€‚
å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™å€¼å°†ä¸º nullã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¯·ä½ é‡æ„ <code class="language-plaintext highlighter-rouge">Products</code> è¡¨ï¼ŒæŸ¥è¯¢æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼ï¼Œä½¿å¾—è¾“å‡ºçš„æ ¼å¼å˜ä¸º<code class="language-plaintext highlighter-rouge">(product_id, store, price)</code> ã€‚å¦‚æœè¿™ä¸€äº§å“åœ¨å•†åº—é‡Œæ²¡æœ‰å‡ºå”®ï¼Œåˆ™ä¸è¾“å‡ºè¿™ä¸€è¡Œã€‚</p>

<p>è¾“å‡ºç»“æœè¡¨ä¸­çš„ <strong>é¡ºåºä¸ä½œè¦æ±‚</strong> ã€‚</p>

<p>æŸ¥è¯¢è¾“å‡ºæ ¼å¼è¯·å‚è€ƒä¸‹é¢ç¤ºä¾‹ã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Products table:
+------------+--------+--------+--------+
| product_id | store1 | store2 | store3 |
+------------+--------+--------+--------+
| 0          | 95     | 100    | 105    |
| 1          | 70     | null   | 80     |
+------------+--------+--------+--------+
è¾“å‡ºï¼š
+------------+--------+-------+
| product_id | store  | price |
+------------+--------+-------+
| 0          | store1 | 95    |
| 0          | store2 | 100   |
| 0          | store3 | 105   |
| 1          | store1 | 70    |
| 1          | store3 | 80    |
+------------+--------+-------+
è§£é‡Šï¼š
äº§å“ 0 åœ¨ store1ã€store2ã€store3 çš„ä»·æ ¼åˆ†åˆ«ä¸º 95ã€100ã€105ã€‚
äº§å“ 1 åœ¨ store1ã€store3 çš„ä»·æ ¼åˆ†åˆ«ä¸º 70ã€80ã€‚åœ¨ store2 æ— æ³•ä¹°åˆ°ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">rearrange_products_table</span><span class="p">(</span><span class="n">products</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df_melted</span> <span class="o">=</span> <span class="n">products</span><span class="p">.</span><span class="nf">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">product_id</span><span class="sh">'</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">store1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">store2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">store3</span><span class="sh">'</span><span class="p">],</span><span class="n">var_name</span><span class="o">=</span><span class="sh">'</span><span class="s">store</span><span class="sh">'</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="sh">'</span><span class="s">price</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_melted</span><span class="p">.</span><span class="nf">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">price</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>å…³äºpandasä¸­é‡å¡‘çš„å¤§å¸ˆâ€”â€” meltå‡½æ•°ï¼Œæ›´å¤šçš„ä»‹ç»ã€æ€»ç»“ã€è®°å¿†æ–¹æ³•å’Œç»ƒä¹ å‚è€ƒåšå®¢ï¼š<a href="https://kirsten-1.github.io/2025/02/28/%E8%BD%AC%E6%8D%A2%E4%B8%8E%E9%87%8D%E5%A1%91df-melt%E5%87%BD%E6%95%B0/">dfé•¿å®½å˜å½¢å¤§å¸ˆ - meltçš„é‡å¡‘ç¥åŠŸ</a></p>

<hr />

<h1 id="æ•°æ®ç»Ÿè®¡">æ•°æ®ç»Ÿè®¡</h1>

<h2 id="2082-å¯Œæœ‰å®¢æˆ·çš„æ•°é‡">2082. å¯Œæœ‰å®¢æˆ·çš„æ•°é‡</h2>

<p><a href="https://leetcode.cn/problems/the-number-of-rich-customers/">2082. å¯Œæœ‰å®¢æˆ·çš„æ•°é‡</a></p>

<p>è¡¨ï¼š <code class="language-plaintext highlighter-rouge">Store</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| bill_id     | int  |
| customer_id | int  |
| amount      | int  |
+-------------+------+
bill_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
æ¯ä¸€è¡ŒåŒ…å«ä¸€ä¸ªè®¢å•çš„é‡‘é¢åŠç›¸å…³å®¢æˆ·çš„ä¿¡æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡º <strong>è‡³å°‘æœ‰ä¸€ä¸ª</strong> è®¢å•çš„é‡‘é¢ <strong>ä¸¥æ ¼å¤§äº</strong> <code class="language-plaintext highlighter-rouge">500</code> çš„å®¢æˆ·çš„æ•°é‡ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Store è¡¨:
+---------+-------------+--------+
| bill_id | customer_id | amount |
+---------+-------------+--------+
| 6       | 1           | 549    |
| 8       | 1           | 834    |
| 4       | 2           | 394    |
| 11      | 3           | 657    |
| 13      | 3           | 257    |
+---------+-------------+--------+
è¾“å‡ºï¼š 
+------------+
| rich_count |
+------------+
| 2          |
+------------+
è§£é‡Šï¼š
å®¢æˆ· 1 æœ‰ 2 ä¸ªè®¢å•é‡‘é¢ä¸¥æ ¼å¤§äº 500ã€‚
å®¢æˆ· 2 æ²¡æœ‰ä»»ä½•è®¢å•é‡‘é¢ä¸¥æ ¼å¤§äº 500ã€‚
å®¢æˆ· 3 æœ‰ 1 ä¸ªè®¢å•é‡‘é¢ä¸¥æ ¼å¤§äº 500ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_rich_customers</span><span class="p">(</span><span class="n">store</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">).</span><span class="nf">any</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">store</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">customer_id</span><span class="sh">'</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">rich_count</span><span class="sh">'</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">res</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¯ä»¥é€šè¿‡ã€‚</p>

<p>å®˜æ–¹çš„ç­”æ¡ˆï¼š</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="n">pandas</span> <span class="n">as</span> <span class="n">pd</span>

<span class="n">def</span> <span class="n">count_rich_customers</span><span class="p">(</span><span class="n">store</span><span class="o">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="o">:</span>
    <span class="n">rich_customers</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="n">store</span><span class="p">[</span><span class="err">'</span><span class="n">amount</span><span class="err">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">]</span>
    
    <span class="n">count</span> <span class="o">=</span> <span class="n">rich_customers</span><span class="p">[</span><span class="err">'</span><span class="n">customer_id</span><span class="err">'</span><span class="p">].</span><span class="n">nunique</span><span class="p">()</span>

    <span class="n">answer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="err">'</span><span class="n">rich_count</span><span class="err">'</span><span class="o">:</span><span class="p">[</span><span class="n">count</span><span class="p">]})</span>

    <span class="k">return</span> <span class="n">answer</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250301145758041.png" alt="image-20250301145758041" style="zoom:50%;" /></p>

<hr />

<p>å­¦åˆ°ä¸€ä¸ªæ–°å‡½æ•°ï¼š<code class="language-plaintext highlighter-rouge">nunique</code>ç»Ÿè®¡uniqueçš„ä¸ªæ•°çš„ã€‚</p>

<h2 id="1173-å³æ—¶é£Ÿç‰©é…é€-i">1173. å³æ—¶é£Ÿç‰©é…é€ I</h2>

<p><a href="https://leetcode.cn/problems/immediate-food-delivery-i/">1173. å³æ—¶é£Ÿç‰©é…é€ I</a></p>

<p>é…é€è¡¨: <code class="language-plaintext highlighter-rouge">Delivery</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+-----------------------------+---------+
| Column Name                 | Type    |
+-----------------------------+---------+
| delivery_id                 | int     |
| customer_id                 | int     |
| order_date                  | date    |
| customer_pref_delivery_date | date    |
+-----------------------------+---------+
delivery_id æ˜¯è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨ä¿å­˜ç€é¡¾å®¢çš„é£Ÿç‰©é…é€ä¿¡æ¯ï¼Œé¡¾å®¢åœ¨æŸä¸ªæ—¥æœŸä¸‹äº†è®¢å•ï¼Œå¹¶æŒ‡å®šäº†ä¸€ä¸ªæœŸæœ›çš„é…é€æ—¥æœŸï¼ˆå’Œä¸‹å•æ—¥æœŸç›¸åŒæˆ–è€…åœ¨é‚£ä¹‹åï¼‰ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¦‚æœé¡¾å®¢æœŸæœ›çš„é…é€æ—¥æœŸå’Œä¸‹å•æ—¥æœŸç›¸åŒï¼Œåˆ™è¯¥è®¢å•ç§°ä¸º ã€Œå³æ—¶è®¢å•ã€ï¼Œå¦åˆ™ç§°ä¸ºã€Œè®¡åˆ’è®¢å•ã€ã€‚</p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆç»Ÿè®¡å³æ—¶è®¢å•æ‰€å çš„ç™¾åˆ†æ¯”ï¼Œ <strong>ä¿ç•™ä¸¤ä½å°æ•°ã€‚</strong></p>

<p>è¿”å›ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Delivery è¡¨:
+-------------+-------------+------------+-----------------------------+
| delivery_id | customer_id | order_date | customer_pref_delivery_date |
+-------------+-------------+------------+-----------------------------+
| 1           | 1           | 2019-08-01 | 2019-08-02                  |
| 2           | 5           | 2019-08-02 | 2019-08-02                  |
| 3           | 1           | 2019-08-11 | 2019-08-11                  |
| 4           | 3           | 2019-08-24 | 2019-08-26                  |
| 5           | 4           | 2019-08-21 | 2019-08-22                  |
| 6           | 2           | 2019-08-11 | 2019-08-13                  |
+-------------+-------------+------------+-----------------------------+
è¾“å‡ºï¼š
+----------------------+
| immediate_percentage |
+----------------------+
| 33.33                |
+----------------------+
è§£é‡Šï¼š2 å’Œ 3 å·è®¢å•ä¸ºå³æ—¶è®¢å•ï¼Œå…¶ä»–çš„ä¸ºè®¡åˆ’è®¢å•ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æœ¬é¢˜æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c1"># æ•°æ®
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">delivery_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">customer_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2019-08-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-11</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-24</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-21</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-11</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2019-08-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-11</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-26</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-22</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-13</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># åˆ›å»º DataFrame
</span><span class="n">delivery</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># å°†æ—¥æœŸå­—ç¬¦ä¸²è½¬æ¢ä¸º datetime å¯¹è±¡
</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">])</span>
<span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">])</span>

<span class="nf">display</span><span class="p">(</span><span class="n">delivery</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">delivery</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span>


<span class="n">rate</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">])</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">delivery</span><span class="p">)</span>
<span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">immediate_percentage</span><span class="sh">'</span><span class="p">:[</span><span class="n">rate</span><span class="p">]})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æˆ‘å†™çš„ç­”æ¡ˆ:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">food_delivery</span><span class="p">(</span><span class="n">delivery</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">])</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">delivery</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">immediate_percentage</span><span class="sh">'</span><span class="p">:[</span><span class="nf">round</span><span class="p">(</span><span class="n">rate</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1907-æŒ‰åˆ†ç±»ç»Ÿè®¡è–ªæ°´">1907. æŒ‰åˆ†ç±»ç»Ÿè®¡è–ªæ°´</h2>

<p><a href="https://leetcode.cn/problems/count-salary-categories/">1907. æŒ‰åˆ†ç±»ç»Ÿè®¡è–ªæ°´</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Accounts</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+------+
| åˆ—å        | ç±»å‹  |
+-------------+------+
| account_id  | int  |
| income      | int  |
+-------------+------+
åœ¨ SQL ä¸­ï¼Œaccount_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
æ¯ä¸€è¡Œéƒ½åŒ…å«ä¸€ä¸ªé“¶è¡Œå¸æˆ·çš„æœˆæ”¶å…¥çš„ä¿¡æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢æ¯ä¸ªå·¥èµ„ç±»åˆ«çš„é“¶è¡Œè´¦æˆ·æ•°é‡ã€‚ å·¥èµ„ç±»åˆ«å¦‚ä¸‹ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">"Low Salary"</code>ï¼šæ‰€æœ‰å·¥èµ„ <strong>ä¸¥æ ¼ä½äº</strong> <code class="language-plaintext highlighter-rouge">20000</code> ç¾å…ƒã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">"Average Salary"</code>ï¼š <strong>åŒ…å«</strong> èŒƒå›´å†…çš„æ‰€æœ‰å·¥èµ„ <code class="language-plaintext highlighter-rouge">[$20000, $50000]</code> ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">"High Salary"</code>ï¼šæ‰€æœ‰å·¥èµ„ <strong>ä¸¥æ ¼å¤§äº</strong> <code class="language-plaintext highlighter-rouge">50000</code> ç¾å…ƒã€‚</li>
</ul>

<p>ç»“æœè¡¨ <strong>å¿…é¡»</strong> åŒ…å«æ‰€æœ‰ä¸‰ä¸ªç±»åˆ«ã€‚ å¦‚æœæŸä¸ªç±»åˆ«ä¸­æ²¡æœ‰å¸æˆ·ï¼Œåˆ™æŠ¥å‘Š <code class="language-plaintext highlighter-rouge">0</code> ã€‚</p>

<p>æŒ‰ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹ã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Accounts è¡¨:
+------------+--------+
| account_id | income |
+------------+--------+
| 3          | 108939 |
| 2          | 12747  |
| 8          | 87709  |
| 6          | 91796  |
+------------+--------+
è¾“å‡ºï¼š
+----------------+----------------+
| category       | accounts_count |
+----------------+----------------+
| Low Salary     | 1              |
| Average Salary | 0              |
| High Salary    | 3              |
+----------------+----------------+
è§£é‡Šï¼š
ä½è–ª: æœ‰ä¸€ä¸ªè´¦æˆ· 2.
ä¸­ç­‰è–ªæ°´: æ²¡æœ‰.
é«˜è–ª: æœ‰ä¸‰ä¸ªè´¦æˆ·ï¼Œä»–ä»¬æ˜¯ 3, 6å’Œ 8.
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1"># æ•°æ®
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">account_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">108939</span><span class="p">,</span> <span class="mi">12747</span><span class="p">,</span> <span class="mi">87709</span><span class="p">,</span> <span class="mi">91796</span><span class="p">]</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_salary_categories</span><span class="p">(</span><span class="n">accounts</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">(</span><span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">20000</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">((</span><span class="mi">20000</span> <span class="o">&lt;=</span> <span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">50000</span><span class="p">)).</span><span class="nf">sum</span><span class="p">()</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">:[</span><span class="sh">'</span><span class="s">Low Salary</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Average Salary</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">High Salary</span><span class="sh">'</span><span class="p">],</span> <span class="sh">'</span><span class="s">accounts_count</span><span class="sh">'</span><span class="p">:[</span><span class="n">l</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">]})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç­”æ¡ˆå’Œæˆ‘å†™çš„ç±»ä¼¼ã€‚</p>

<h1 id="æµ‹éªŒé¢˜-1">æµ‹éªŒé¢˜</h1>

<h2 id="1322-å¹¿å‘Šæ•ˆæœ">1322. å¹¿å‘Šæ•ˆæœ</h2>

<p><a href="https://leetcode.cn/problems/ads-performance/">1322. å¹¿å‘Šæ•ˆæœ</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Ads</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| ad_id         | int     |
| user_id       | int     |
| action        | enum    |
+---------------+---------+
(ad_id, user_id) æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆ)
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€æ¡å¹¿å‘Šçš„ ID(ad_id)ï¼Œç”¨æˆ·çš„ ID(user_id) å’Œç”¨æˆ·å¯¹å¹¿å‘Šé‡‡å–çš„è¡Œä¸º (action)
action åˆ—æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ ('Clicked', 'Viewed', 'Ignored') ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸€å®¶å…¬å¸æ­£åœ¨è¿è¥è¿™äº›å¹¿å‘Šå¹¶æƒ³è®¡ç®—æ¯æ¡å¹¿å‘Šçš„æ•ˆæœã€‚</p>

<p>å¹¿å‘Šæ•ˆæœç”¨ç‚¹å‡»é€šè¿‡ç‡ï¼ˆClick-Through Rateï¼šCTRï¼‰æ¥è¡¡é‡ï¼Œå…¬å¼å¦‚ä¸‹:</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/sql1.png" alt="image-20250301161341752" /></p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡ºæ¯ä¸€æ¡å¹¿å‘Šçš„ <code class="language-plaintext highlighter-rouge">ctr</code> ï¼Œ<code class="language-plaintext highlighter-rouge">ctr</code> è¦ <strong>ä¿ç•™ä¸¤ä½å°æ•°</strong> ã€‚</p>

<p>è¿”å›ç»“æœéœ€è¦æŒ‰ <code class="language-plaintext highlighter-rouge">ctr</code> <strong>é™åº</strong>ã€æŒ‰ <code class="language-plaintext highlighter-rouge">ad_id</code> <strong>å‡åº</strong> è¿›è¡Œæ’åºã€‚</p>

<p>è¿”å›ç»“æœç¤ºä¾‹å¦‚ä¸‹ï¼š</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Ads è¡¨:
+-------+---------+---------+
| ad_id | user_id | action  |
+-------+---------+---------+
| 1     | 1       | Clicked |
| 2     | 2       | Clicked |
| 3     | 3       | Viewed  |
| 5     | 5       | Ignored |
| 1     | 7       | Ignored |
| 2     | 7       | Viewed  |
| 3     | 5       | Clicked |
| 1     | 4       | Viewed  |
| 2     | 11      | Viewed  |
| 1     | 2       | Clicked |
+-------+---------+---------+
è¾“å‡ºï¼š
+-------+-------+
| ad_id | ctr   |
+-------+-------+
| 1     | 66.67 |
| 3     | 50.00 |
| 2     | 33.33 |
| 5     | 0.00  |
+-------+-------+
è§£é‡Šï¼š
å¯¹äº ad_id = 1, ctr = (2/(2+1)) * 100 = 66.67
å¯¹äº ad_id = 2, ctr = (1/(1+2)) * 100 = 33.33
å¯¹äº ad_id = 3, ctr = (1/(1+1)) * 100 = 50.00
å¯¹äº ad_id = 5, ctr = 0.00, æ³¨æ„ ad_id = 5 æ²¡æœ‰è¢«ç‚¹å‡» (Clicked) æˆ–æŸ¥çœ‹ (Viewed) è¿‡
æ³¨æ„æˆ‘ä»¬ä¸å…³å¿ƒ action ä¸º Ingnored çš„å¹¿å‘Š
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ignored</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ignored</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼šï¼ˆæ—¶é—´å¤æ‚åº¦ç•¥å¤§ï¼‰ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">ads_performance</span><span class="p">(</span><span class="n">ads</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">ad_id</span> <span class="o">=</span> <span class="n">ads</span><span class="p">[</span><span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ad_id</span><span class="p">:</span>
        <span class="n">ads_i</span> <span class="o">=</span> <span class="n">ads</span><span class="p">[</span><span class="n">ads</span><span class="p">[</span><span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="nb">id</span><span class="p">]</span>
        <span class="n">clicked</span> <span class="o">=</span> <span class="p">(</span><span class="n">ads_i</span><span class="p">[</span><span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
        <span class="n">viewed</span> <span class="o">=</span> <span class="p">(</span><span class="n">ads_i</span><span class="p">[</span><span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
        <span class="n">ctr</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">clicked</span> <span class="o">+</span> <span class="n">viewed</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nf">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">clicked</span><span class="o">/</span><span class="p">(</span><span class="n">clicked</span> <span class="o">+</span> <span class="n">viewed</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>   
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">:</span><span class="n">ad_id</span><span class="p">,</span> <span class="sh">'</span><span class="s">ctr</span><span class="sh">'</span><span class="p">:</span><span class="n">ctr</span><span class="p">}).</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">ctr</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="æ•°æ®åˆ†ç»„">æ•°æ®åˆ†ç»„</h1>

<h2 id="1741-æŸ¥æ‰¾æ¯ä¸ªå‘˜å·¥èŠ±è´¹çš„æ€»æ—¶é—´">1741. æŸ¥æ‰¾æ¯ä¸ªå‘˜å·¥èŠ±è´¹çš„æ€»æ—¶é—´</h2>

<p><a href="https://leetcode.cn/problems/find-total-time-spent-by-each-employee/">1741. æŸ¥æ‰¾æ¯ä¸ªå‘˜å·¥èŠ±è´¹çš„æ€»æ—¶é—´</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Employees</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| emp_id      | int  |
| event_day   | date |
| in_time     | int  |
| out_time    | int  |
+-------------+------+
åœ¨ SQL ä¸­ï¼Œ(emp_id, event_day, in_time) æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
è¯¥è¡¨æ˜¾ç¤ºäº†å‘˜å·¥åœ¨åŠå…¬å®¤çš„å‡ºå…¥æƒ…å†µã€‚
event_day æ˜¯æ­¤äº‹ä»¶å‘ç”Ÿçš„æ—¥æœŸï¼Œin_time æ˜¯å‘˜å·¥è¿›å…¥åŠå…¬å®¤çš„æ—¶é—´ï¼Œè€Œ out_time æ˜¯ä»–ä»¬ç¦»å¼€åŠå…¬å®¤çš„æ—¶é—´ã€‚
in_time å’Œ out_time çš„å–å€¼åœ¨1åˆ°1440ä¹‹é—´ã€‚
é¢˜ç›®ä¿è¯åŒä¸€å¤©æ²¡æœ‰ä¸¤ä¸ªäº‹ä»¶åœ¨æ—¶é—´ä¸Šæ˜¯ç›¸äº¤çš„ï¼Œå¹¶ä¸”ä¿è¯ in_time å°äº out_timeã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è®¡ç®—æ¯ä½å‘˜å·¥æ¯å¤©åœ¨åŠå…¬å®¤èŠ±è´¹çš„æ€»æ—¶é—´ï¼ˆä»¥åˆ†é’Ÿä¸ºå•ä½ï¼‰ã€‚ è¯·æ³¨æ„ï¼Œåœ¨ä¸€å¤©ä¹‹å†…ï¼ŒåŒä¸€å‘˜å·¥æ˜¯å¯ä»¥å¤šæ¬¡è¿›å…¥å’Œç¦»å¼€åŠå…¬å®¤çš„ã€‚ åœ¨åŠå…¬å®¤é‡Œä¸€æ¬¡è¿›å‡ºæ‰€èŠ±è´¹çš„æ—¶é—´ä¸ºout_time å‡å» in_timeã€‚</p>

<p>è¿”å›ç»“æœè¡¨å•çš„é¡ºåºæ— è¦æ±‚ã€‚
æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹ï¼š</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Employees table:
+--------+------------+---------+----------+
| emp_id | event_day  | in_time | out_time |
+--------+------------+---------+----------+
| 1      | 2020-11-28 | 4       | 32       |
| 1      | 2020-11-28 | 55      | 200      |
| 1      | 2020-12-03 | 1       | 42       |
| 2      | 2020-11-28 | 3       | 33       |
| 2      | 2020-12-09 | 47      | 74       |
+--------+------------+---------+----------+
è¾“å‡ºï¼š
+------------+--------+------------+
| day        | emp_id | total_time |
+------------+--------+------------+
| 2020-11-28 | 1      | 173        |
| 2020-11-28 | 2      | 30         |
| 2020-12-03 | 1      | 41         |
| 2020-12-09 | 2      | 27         |
+------------+--------+------------+
è§£é‡Šï¼š
é›‡å‘˜ 1 æœ‰ä¸‰æ¬¡è¿›å‡º: æœ‰ä¸¤æ¬¡å‘ç”Ÿåœ¨ 2020-11-28 èŠ±è´¹çš„æ—¶é—´ä¸º (32 - 4) + (200 - 55) = 173, æœ‰ä¸€æ¬¡å‘ç”Ÿåœ¨ 2020-12-03 èŠ±è´¹çš„æ—¶é—´ä¸º (42 - 1) = 41ã€‚
é›‡å‘˜ 2 æœ‰ä¸¤æ¬¡è¿›å‡º: æœ‰ä¸€æ¬¡å‘ç”Ÿåœ¨ 2020-11-28 èŠ±è´¹çš„æ—¶é—´ä¸º (33 - 3) = 30,  æœ‰ä¸€æ¬¡å‘ç”Ÿåœ¨ 2020-12-09 èŠ±è´¹çš„æ—¶é—´ä¸º (74 - 47) = 27ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2020-11-28</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-11-28</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-03</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-11-28</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-09</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">in_time</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">47</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">out_time</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">74</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">total_time</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">total</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">out_time</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">in_time</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">total_time</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">])[</span><span class="sh">'</span><span class="s">total</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">sum</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">])</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">day</span><span class="sh">'</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">day</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">total_time</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>å®˜æ–¹ç­”æ¡ˆæœ‰ä¸€ä¸ªå‡½æ•°<code class="language-plaintext highlighter-rouge">reset_index</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># ç¤ºä¾‹ DataFrame
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">col1</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">col2</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">])</span>  <span class="c1"># ä½¿ç”¨è‡ªå®šä¹‰ç´¢å¼•
</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">åŸå§‹ DataFrame:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="c1"># ä½¿ç”¨ reset_index()
</span><span class="n">df_reset</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">reset_index</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">é‡ç½®ç´¢å¼•åçš„ DataFrame:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_reset</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250301171532540.png" alt="image-20250301171532540" style="zoom:50%;" /></p>

<h2 id="511-æ¸¸æˆç©æ³•åˆ†æ-i">511. æ¸¸æˆç©æ³•åˆ†æ I</h2>

<p><a href="https://leetcode.cn/problems/game-play-analysis-i/">511. æ¸¸æˆç©æ³•åˆ†æ I</a></p>

<p>æ´»åŠ¨è¡¨ <code class="language-plaintext highlighter-rouge">Activity</code>ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| player_id    | int     |
| device_id    | int     |
| event_date   | date    |
| games_played | int     |
+--------------+---------+
åœ¨ SQL ä¸­ï¼Œè¡¨çš„ä¸»é”®æ˜¯ (player_id, event_date)ã€‚
è¿™å¼ è¡¨å±•ç¤ºäº†ä¸€äº›æ¸¸æˆç©å®¶åœ¨æ¸¸æˆå¹³å°ä¸Šçš„è¡Œä¸ºæ´»åŠ¨ã€‚
æ¯è¡Œæ•°æ®è®°å½•äº†ä¸€åç©å®¶åœ¨é€€å‡ºå¹³å°ä¹‹å‰ï¼Œå½“å¤©ä½¿ç”¨åŒä¸€å°è®¾å¤‡ç™»å½•å¹³å°åæ‰“å¼€çš„æ¸¸æˆçš„æ•°ç›®ï¼ˆå¯èƒ½æ˜¯ 0 ä¸ªï¼‰ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢æ¯ä½ç©å®¶ <strong>ç¬¬ä¸€æ¬¡ç™»å½•å¹³å°çš„æ—¥æœŸ</strong>ã€‚</p>

<p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>Activity è¡¨ï¼š
+-----------+-----------+------------+--------------+
| player_id | device_id | event_date | games_played |
+-----------+-----------+------------+--------------+
| 1         | 2         | 2016-03-01 | 5            |
| 1         | 2         | 2016-05-02 | 6            |
| 2         | 3         | 2017-06-25 | 1            |
| 3         | 1         | 2016-03-02 | 0            |
| 3         | 4         | 2018-07-03 | 5            |
+-----------+-----------+------------+--------------+

Result è¡¨ï¼š
+-----------+-------------+
| player_id | first_login |
+-----------+-------------+
| 1         | 2016-03-01  |
| 2         | 2017-06-25  |
| 3         | 2016-03-02  |
+-----------+-------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">device_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2016-03-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2016-05-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2017-06-25</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2016-03-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2018-07-03</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">games_played</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">device_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2016-03-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2016-02-03</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">games_played</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¸çŸ¥é“æˆ‘å†™çš„æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œç¢°åˆ°åŠ›æ‰£ä¸€ä¸ªè´¼é•¿çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæ‡’å¾—æŸ¥ä¸ºä»€ä¹ˆäº†ã€‚ã€‚ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">game_analysis</span><span class="p">(</span><span class="n">activity</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">activity</span><span class="p">[</span><span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">activity</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">min</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">activity</span> <span class="o">=</span> <span class="n">activity</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">activity</span><span class="p">[[</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å®˜æ–¹ç­”æ¡ˆæ˜¯ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">game_analysis</span><span class="p">(</span><span class="n">activity</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">activity</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">].</span><span class="nf">min</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">})</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>å’Œæˆ‘å†™çš„å·®ä¸å¤šï¼Œä½†æ˜¯æœ‰<code class="language-plaintext highlighter-rouge">reset_index()</code></p>

<p>GPTè¯´è¿™ä¸¤æ®µä»£ç ä¼šè¿”å›ç›¸åŒçš„ç»“æœï¼Œå³ä¸€ä¸ª DataFrameï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ª player_id åŠå…¶å¯¹åº”çš„æœ€æ—©ç™»å½•æ—¥æœŸã€‚</p>

<hr />

<h2 id="2356-æ¯ä½æ•™å¸ˆæ‰€æ•™æˆçš„ç§‘ç›®ç§ç±»çš„æ•°é‡">2356. æ¯ä½æ•™å¸ˆæ‰€æ•™æˆçš„ç§‘ç›®ç§ç±»çš„æ•°é‡</h2>

<p><a href="https://leetcode.cn/problems/number-of-unique-subjects-taught-by-each-teacher/">2356. æ¯ä½æ•™å¸ˆæ‰€æ•™æˆçš„ç§‘ç›®ç§ç±»çš„æ•°é‡</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Teacher</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| teacher_id  | int  |
| subject_id  | int  |
| dept_id     | int  |
+-------------+------+
åœ¨ SQL ä¸­ï¼Œ(subject_id, dept_id) æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
è¯¥è¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå¸¦æœ‰ teacher_id çš„æ•™å¸ˆåœ¨ç³» dept_id ä¸­æ•™æˆç§‘ç›® subject_idã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢æ¯ä½è€å¸ˆåœ¨å¤§å­¦é‡Œæ•™æˆçš„ç§‘ç›®ç§ç±»çš„æ•°é‡ã€‚</p>

<p>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼ç¤ºä¾‹å¦‚ä¸‹ã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Teacher è¡¨:
+------------+------------+---------+
| teacher_id | subject_id | dept_id |
+------------+------------+---------+
| 1          | 2          | 3       |
| 1          | 2          | 4       |
| 1          | 3          | 3       |
| 2          | 1          | 1       |
| 2          | 2          | 1       |
| 2          | 3          | 1       |
| 2          | 4          | 1       |
+------------+------------+---------+
è¾“å‡º:  
+------------+-----+
| teacher_id | cnt |
+------------+-----+
| 1          | 2   |
| 2          | 4   |
+------------+-----+
è§£é‡Š: 
æ•™å¸ˆ 1:
  - ä»–åœ¨ 3ã€4 ç³»æ•™ç§‘ç›® 2ã€‚
  - ä»–åœ¨ 3 ç³»æ•™ç§‘ç›® 3ã€‚
æ•™å¸ˆ 2:
  - ä»–åœ¨ 1 ç³»æ•™ç§‘ç›® 1ã€‚
  - ä»–åœ¨ 1 ç³»æ•™ç§‘ç›® 2ã€‚
  - ä»–åœ¨ 1 ç³»æ•™ç§‘ç›® 3ã€‚
  - ä»–åœ¨ 1 ç³»æ•™ç§‘ç›® 4ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">dept_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>

<span class="n">teacher</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">teacher</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é¢˜æˆ‘å†™çš„æ¯”è¾ƒé¡ºåˆ©ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_unique_subjects</span><span class="p">(</span><span class="n">teacher</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">teacher</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span>  <span class="c1"># .str.len() æ–¹æ³•æ¥è·å–æ¯ä¸ªåˆ—è¡¨ä¸­å…ƒç´ çš„æ•°é‡ã€‚
</span>    <span class="k">return</span> <span class="n">sub</span><span class="p">[[</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¡¥å……ï¼š<code class="language-plaintext highlighter-rouge">reset_index() </code>åœ¨è¿™æ®µä»£ç ä¸­çš„ä½œç”¨è‡³å…³é‡è¦ï¼Œå®ƒå½±å“ç€ groupby æ“ä½œçš„ç»“æœä»¥åŠåç»­è®¡ç®—åˆ—è¡¨é•¿åº¦çš„æ–¹å¼ã€‚</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">teacher.groupby('teacher_id')['subject_id'].unique()</code></strong>: è¿™ä¸€æ­¥æŒ‰ <code class="language-plaintext highlighter-rouge">teacher_id </code>åˆ†ç»„ï¼Œå¹¶è·å–æ¯ä¸ªæ•™å¸ˆå¯¹åº”çš„å”¯ä¸€ <code class="language-plaintext highlighter-rouge">subject_id </code>åˆ—è¡¨ã€‚ ç»“æœæ˜¯ä¸€ä¸ª Seriesï¼Œå…¶ä¸­ teacher_id æ˜¯ç´¢å¼•ã€‚</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">.reset_index()</code></strong>: <strong>å…³é”®ä½œç”¨ï¼š</strong><code class="language-plaintext highlighter-rouge"> reset_index() </code>å°†ç´¢å¼• <code class="language-plaintext highlighter-rouge">teacher_id </code>è½¬æ¢ä¸º DataFrame çš„ä¸€ä¸ªæ™®é€šåˆ—ã€‚ è¿™ä¼šå°† Series è½¬æ¢ä¸º DataFrameï¼Œå…¶ä¸­åŒ…å«ä¸¤åˆ—ï¼š<code class="language-plaintext highlighter-rouge">teacher_id </code>å’Œ <code class="language-plaintext highlighter-rouge">subject_id</code>ï¼ˆåŒ…å«å”¯ä¸€ç§‘ç›®åˆ—è¡¨ï¼‰ã€‚ è¿™æ ·åšçš„ç›®çš„æ˜¯è®© <code class="language-plaintext highlighter-rouge">teacher_id </code>æˆä¸ºä¸€ä¸ªå¯ä»¥æ“ä½œçš„åˆ—ï¼Œè€Œä¸æ˜¯ç´¢å¼•ã€‚</p>
  </li>
</ul>

<p>å¦‚æœæ²¡æœ‰ <code class="language-plaintext highlighter-rouge">reset_index()</code>ï¼Œsub ä»ç„¶æ˜¯ä¸€ä¸ª Seriesï¼Œå…¶ä¸­ <code class="language-plaintext highlighter-rouge">teacher_id</code> æ˜¯ç´¢å¼•ï¼Œè€ŒåŒ…å«å”¯ä¸€ç§‘ç›®åˆ—è¡¨æ˜¯ Series çš„å€¼ã€‚</p>

<p>å› ä¸ºsubæ˜¯Seriesï¼Œæ‰€ä»¥è¦å…ˆä½¿ç”¨<code class="language-plaintext highlighter-rouge">to_frame()</code>å‡½æ•°è½¬æ¢ä¸ºDataframeï¼Œç´¢å¼•ä¼šé»˜è®¤æˆä¸ºDataframeçš„ç´¢å¼•</p>

<p>æ‰€ä»¥ä¹Ÿå¯ä»¥å†™æˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_unique_subjects</span><span class="p">(</span><span class="n">teacher</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">teacher</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>  <span class="c1"># å»æ‰reset_index()
</span>    <span class="n">sub</span> <span class="o">=</span> <span class="n">sub</span><span class="p">.</span><span class="nf">to_frame</span><span class="p">()</span>  <span class="c1"># å°† Series è½¬æ¢ä¸º DataFrame, ç´¢å¼•æˆä¸ºDataFrameçš„ç´¢å¼•
</span>    <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span>  <span class="c1"># .str.len() æ–¹æ³•æ¥è·å–æ¯ä¸ªåˆ—è¡¨ä¸­å…ƒç´ çš„æ•°é‡ã€‚
</span>    <span class="k">return</span> <span class="n">sub</span><span class="p">.</span><span class="nf">rename_axis</span><span class="p">(</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">).</span><span class="nf">reset_index</span><span class="p">()[[</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æœ€ç»ˆè¿˜æ˜¯è¦å†ç”¨<code class="language-plaintext highlighter-rouge">reset_index()</code>è½¬æ¢ä¸ºåˆ—ã€‚</p>

<hr />

<h2 id="596-è¶…è¿‡-5-åå­¦ç”Ÿçš„è¯¾">596. è¶…è¿‡ 5 åå­¦ç”Ÿçš„è¯¾</h2>

<p><a href="https://leetcode.cn/problems/classes-more-than-5-students/">596. è¶…è¿‡ 5 åå­¦ç”Ÿçš„è¯¾</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Courses</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| student     | varchar |
| class       | varchar |
+-------------+---------+
(student, class)æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆä¸åŒå€¼çš„åˆ—çš„ç»„åˆï¼‰ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤ºå­¦ç”Ÿçš„åå­—å’Œä»–ä»¬æ³¨å†Œçš„ç­çº§ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢ <strong>è‡³å°‘æœ‰ 5 ä¸ªå­¦ç”Ÿ</strong> çš„æ‰€æœ‰ç­çº§ã€‚</p>

<p>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Courses table:
+---------+----------+
| student | class    |
+---------+----------+
| A       | Math     |
| B       | English  |
| C       | Math     |
| D       | Biology  |
| E       | Math     |
| F       | Computer |
| G       | Math     |
| H       | Math     |
| I       | Math     |
+---------+----------+
è¾“å‡º: 
+---------+ 
| class   | 
+---------+ 
| Math    | 
+---------+
è§£é‡Š: 
-æ•°å­¦è¯¾æœ‰ 6 ä¸ªå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬åŒ…æ‹¬å®ƒã€‚
-è‹±è¯­è¯¾æœ‰ 1 åå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åŒ…æ‹¬å®ƒã€‚
-ç”Ÿç‰©è¯¾æœ‰ 1 åå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åŒ…æ‹¬å®ƒã€‚
-è®¡ç®—æœºè¯¾æœ‰ 1 ä¸ªå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åŒ…æ‹¬å®ƒã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">student</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">G</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">H</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">I</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">class</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">English</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Biology</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Computer</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é¢˜ç»è¿‡å‰é¢è¿™ä¹ˆå¤šé¢˜ç›®çš„è®­ç»ƒï¼Œå˜å¾—éå¸¸ç®€å•äº†ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_classes</span><span class="p">(</span><span class="n">courses</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">courses</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">class</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">student</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span> <span class="p">.</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">student</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">][[</span><span class="sh">'</span><span class="s">class</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="586-è®¢å•æœ€å¤šçš„å®¢æˆ·">586. è®¢å•æœ€å¤šçš„å®¢æˆ·</h2>

<p><a href="https://leetcode.cn/problems/customer-placing-the-largest-number-of-orders/">586. è®¢å•æœ€å¤šçš„å®¢æˆ·</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Orders</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-----------------+----------+
| Column Name     | Type     |
+-----------------+----------+
| order_number    | int      |
| customer_number | int      |
+-----------------+----------+
åœ¨ SQL ä¸­ï¼ŒOrder_numberæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
æ­¤è¡¨åŒ…å«å…³äºè®¢å•IDå’Œå®¢æˆ·IDçš„ä¿¡æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥æ‰¾ä¸‹äº† <strong>æœ€å¤šè®¢å•</strong> çš„å®¢æˆ·çš„ <code class="language-plaintext highlighter-rouge">customer_number</code> ã€‚</p>

<p>æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆåï¼Œ <strong>æ°å¥½æœ‰ä¸€ä¸ªå®¢æˆ·</strong> æ¯”ä»»ä½•å…¶ä»–å®¢æˆ·ä¸‹äº†æ›´å¤šçš„è®¢å•ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Orders è¡¨:
+--------------+-----------------+
| order_number | customer_number |
+--------------+-----------------+
| 1            | 1               |
| 2            | 2               |
| 3            | 3               |
| 4            | 3               |
+--------------+-----------------+
è¾“å‡º: 
+-----------------+
| customer_number |
+-----------------+
| 3               |
+-----------------+
è§£é‡Š: 
customer_number ä¸º '3' çš„é¡¾å®¢æœ‰ä¸¤ä¸ªè®¢å•ï¼Œæ¯”é¡¾å®¢ '1' æˆ–è€… '2' éƒ½è¦å¤šï¼Œå› ä¸ºä»–ä»¬åªæœ‰ä¸€ä¸ªè®¢å•ã€‚
æ‰€ä»¥ç»“æœæ˜¯è¯¥é¡¾å®¢çš„ customer_number ï¼Œä¹Ÿå°±æ˜¯ 3 ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">customer_number</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">largest_orders</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">customer_number</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">].</span><span class="nf">max</span><span class="p">()</span> <span class="o">==</span> <span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">customer_number</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p><strong>è¿›é˜¶ï¼š</strong> å¦‚æœæœ‰å¤šä½é¡¾å®¢è®¢å•æ•°å¹¶åˆ—æœ€å¤šï¼Œä½ èƒ½æ‰¾åˆ°ä»–ä»¬æ‰€æœ‰çš„ <code class="language-plaintext highlighter-rouge">customer_number</code> å—ï¼Ÿ</p>

<p>ç”¨æˆ‘ä¸Šé¢çš„è§£æ³•ä¹Ÿæ²¡é—®é¢˜å•Šï¼š</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250302104618377.png" alt="image-20250302104618377" style="zoom:50%;" /></p>

<h2 id="1484-æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“">1484. æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“</h2>

<p><a href="https://leetcode.cn/problems/group-sold-products-by-the-date/">1484. æŒ‰æ—¥æœŸåˆ†ç»„é”€å”®äº§å“</a></p>

<p>è¡¨ <code class="language-plaintext highlighter-rouge">Activities</code>ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| åˆ—å         | ç±»å‹    |
+-------------+---------+
| sell_date   | date    |
| product     | varchar |
+-------------+---------+
è¯¥è¡¨æ²¡æœ‰ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚å®ƒå¯èƒ½åŒ…å«é‡å¤é¡¹ã€‚
æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«äº§å“åç§°å’Œåœ¨å¸‚åœºä¸Šé”€å”®çš„æ—¥æœŸã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡ºæ¯ä¸ªæ—¥æœŸã€é”€å”®çš„ä¸åŒäº§å“çš„æ•°é‡åŠå…¶åç§°ã€‚
æ¯ä¸ªæ—¥æœŸçš„é”€å”®äº§å“åç§°åº”æŒ‰è¯å…¸åºæ’åˆ—ã€‚
è¿”å›æŒ‰ <code class="language-plaintext highlighter-rouge">sell_date</code> æ’åºçš„ç»“æœè¡¨ã€‚
ç»“æœè¡¨ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Activities è¡¨ï¼š
+------------+-------------+
| sell_date  | product     |
+------------+-------------+
| 2020-05-30 | Headphone   |
| 2020-06-01 | Pencil      |
| 2020-06-02 | Mask        |
| 2020-05-30 | Basketball  |
| 2020-06-01 | Bible       |
| 2020-06-02 | Mask        |
| 2020-05-30 | T-Shirt     |
+------------+-------------+
è¾“å‡ºï¼š
+------------+----------+------------------------------+
| sell_date  | num_sold | products                     |
+------------+----------+------------------------------+
| 2020-05-30 | 3        | Basketball,Headphone,T-shirt |
| 2020-06-01 | 2        | Bible,Pencil                 |
| 2020-06-02 | 1        | Mask                         |
+------------+----------+------------------------------+
è§£é‡Šï¼š
å¯¹äº2020-05-30ï¼Œå‡ºå”®çš„ç‰©å“æ˜¯ (Headphone, Basketball, T-shirt)ï¼ŒæŒ‰è¯å…¸åºæ’åˆ—ï¼Œå¹¶ç”¨é€—å· ',' åˆ†éš”ã€‚
å¯¹äº2020-06-01ï¼Œå‡ºå”®çš„ç‰©å“æ˜¯ (Pencil, Bible)ï¼ŒæŒ‰è¯å…¸åºæ’åˆ—ï¼Œå¹¶ç”¨é€—å·åˆ†éš”ã€‚
å¯¹äº2020-06-02ï¼Œå‡ºå”®çš„ç‰©å“æ˜¯ (Mask)ï¼Œåªéœ€è¿”å›è¯¥ç‰©å“åã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">sell_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2020-05-30</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-05-30</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-05-30</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">product</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Headphone</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pencil</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mask</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Basketball</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bible</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mask</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">T-Shirt</span><span class="sh">'</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é“é¢˜çš„ç±»å‹æˆ‘è¿˜æ²¡æœ‰ç»“æŸè¿‡ã€‚ç”¨äº†gptï¼Œä¸‹é¢çš„å†™æ³•å¤ªå¼ºäº†ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">categorize_products</span><span class="p">(</span><span class="n">activities</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">activities</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">sell_date</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">product</span><span class="sh">'</span><span class="p">].</span><span class="nf">agg</span><span class="p">([</span><span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nf">unique</span><span class="p">()))]).</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">num_sold</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">&lt;lambda_0&gt;</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">products</span><span class="sh">'</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1693-æ¯å¤©çš„é¢†å¯¼å’Œåˆä¼™äºº">1693. æ¯å¤©çš„é¢†å¯¼å’Œåˆä¼™äºº</h2>

<p><a href="https://leetcode.cn/problems/daily-leads-and-partners/">1693. æ¯å¤©çš„é¢†å¯¼å’Œåˆä¼™äºº</a></p>

<p>è¡¨ï¼š<code class="language-plaintext highlighter-rouge">DailySales</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| date_id     | date    |
| make_name   | varchar |
| lead_id     | int     |
| partner_id  | int     |
+-------------+---------+
è¯¥è¡¨æ²¡æœ‰ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚å®ƒå¯èƒ½åŒ…å«é‡å¤é¡¹ã€‚
è¯¥è¡¨åŒ…å«æ—¥æœŸã€äº§å“çš„åç§°ï¼Œä»¥åŠå”®ç»™çš„é¢†å¯¼å’Œåˆä¼™äººçš„ç¼–å·ã€‚
åç§°åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¯¹äºæ¯ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">date_id</code> å’Œ <code class="language-plaintext highlighter-rouge">make_name</code>ï¼Œæ‰¾å‡º <strong>ä¸åŒ</strong> çš„ <code class="language-plaintext highlighter-rouge">lead_id</code> ä»¥åŠ <strong>ä¸åŒ</strong> çš„ <code class="language-plaintext highlighter-rouge">partner_id</code> çš„æ•°é‡ã€‚</p>

<p>æŒ‰ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
DailySales è¡¨ï¼š
+-----------+-----------+---------+------------+
| date_id   | make_name | lead_id | partner_id |
+-----------+-----------+---------+------------+
| 2020-12-8 | toyota    | 0       | 1          |
| 2020-12-8 | toyota    | 1       | 0          |
| 2020-12-8 | toyota    | 1       | 2          |
| 2020-12-7 | toyota    | 0       | 2          |
| 2020-12-7 | toyota    | 0       | 1          |
| 2020-12-8 | honda     | 1       | 2          |
| 2020-12-8 | honda     | 2       | 1          |
| 2020-12-7 | honda     | 0       | 1          |
| 2020-12-7 | honda     | 1       | 2          |
| 2020-12-7 | honda     | 2       | 1          |
+-----------+-----------+---------+------------+
è¾“å‡ºï¼š
+-----------+-----------+--------------+-----------------+
| date_id   | make_name | unique_leads | unique_partners |
+-----------+-----------+--------------+-----------------+
| 2020-12-8 | toyota    | 2            | 3               |
| 2020-12-7 | toyota    | 1            | 2               |
| 2020-12-8 | honda     | 2            | 2               |
| 2020-12-7 | honda     | 3            | 2               |
+-----------+-----------+--------------+-----------------+
è§£é‡Šï¼š
åœ¨ 2020-12-8ï¼Œä¸°ç”°ï¼ˆtoyotaï¼‰æœ‰é¢†å¯¼è€… = [0, 1] å’Œåˆä¼™äºº = [0, 1, 2] ï¼ŒåŒæ—¶æœ¬ç”°ï¼ˆhondaï¼‰æœ‰é¢†å¯¼è€… = [1, 2] å’Œåˆä¼™äºº = [1, 2]ã€‚
åœ¨ 2020-12-7ï¼Œä¸°ç”°ï¼ˆtoyotaï¼‰æœ‰é¢†å¯¼è€… = [0] å’Œåˆä¼™äºº = [1, 2] ï¼ŒåŒæ—¶æœ¬ç”°ï¼ˆhondaï¼‰æœ‰é¢†å¯¼è€… = [0, 1, 2] å’Œåˆä¼™äºº = [1, 2]ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">date_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">make_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">lead_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">partner_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>é€šè¿‡è¿™é“é¢˜å¯ä»¥é¢†ç•¥aggå‡½æ•°çš„å¼ºå¤§ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">daily_leads_and_partners</span><span class="p">(</span><span class="n">daily_sales</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">daily_sales</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">date_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">make_name</span><span class="sh">'</span><span class="p">]).</span><span class="nf">agg</span><span class="p">(</span>
        <span class="n">unique_leads</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">lead_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">),</span>
        <span class="n">unique_partners</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">partner_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">reset_index</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="æ•°æ®åˆå¹¶">æ•°æ®åˆå¹¶</h1>

<h2 id="1050-åˆä½œè¿‡è‡³å°‘ä¸‰æ¬¡çš„æ¼”å‘˜å’Œå¯¼æ¼”">1050. åˆä½œè¿‡è‡³å°‘ä¸‰æ¬¡çš„æ¼”å‘˜å’Œå¯¼æ¼”</h2>

<p><a href="https://leetcode.cn/problems/actors-and-directors-who-cooperated-at-least-three-times/">1050. åˆä½œè¿‡è‡³å°‘ä¸‰æ¬¡çš„æ¼”å‘˜å’Œå¯¼æ¼”</a></p>

<p><code class="language-plaintext highlighter-rouge">ActorDirector</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| actor_id    | int     |
| director_id | int     |
| timestamp   | int     |
+-------------+---------+
timestamp æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—).
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡ºåˆä½œè¿‡è‡³å°‘ä¸‰æ¬¡çš„æ¼”å‘˜å’Œå¯¼æ¼”çš„ id å¯¹ <code class="language-plaintext highlighter-rouge">(actor_id, director_id)</code></p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
ActorDirector è¡¨ï¼š
+-------------+-------------+-------------+
| actor_id    | director_id | timestamp   |
+-------------+-------------+-------------+
| 1           | 1           | 0           |
| 1           | 1           | 1           |
| 1           | 1           | 2           |
| 1           | 2           | 3           |
| 1           | 2           | 4           |
| 2           | 1           | 5           |
| 2           | 1           | 6           |
+-------------+-------------+-------------+
è¾“å‡ºï¼š
+-------------+-------------+
| actor_id    | director_id |
+-------------+-------------+
| 1           | 1           |
+-------------+-------------+
è§£é‡Šï¼š
å”¯ä¸€çš„ id å¯¹æ˜¯ (1, 1)ï¼Œä»–ä»¬æ°å¥½åˆä½œäº† 3 æ¬¡ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">actor_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">director_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é¢˜æ¯”è¾ƒç®€å•ï¼Œæˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">actors_and_directors</span><span class="p">(</span><span class="n">actor_director</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">actor_director</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">actor_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">director_id</span><span class="sh">'</span><span class="p">])[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">grouped</span><span class="p">[</span><span class="n">grouped</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span><span class="mi">3</span><span class="p">][[</span><span class="sh">'</span><span class="s">actor_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">director_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="1378-ä½¿ç”¨å”¯ä¸€æ ‡è¯†ç æ›¿æ¢å‘˜å·¥id">1378. ä½¿ç”¨å”¯ä¸€æ ‡è¯†ç æ›¿æ¢å‘˜å·¥ID</h2>

<p><a href="https://leetcode.cn/problems/replace-employee-id-with-the-unique-identifier/">1378. ä½¿ç”¨å”¯ä¸€æ ‡è¯†ç æ›¿æ¢å‘˜å·¥ID</a></p>

<p><code class="language-plaintext highlighter-rouge">Employees</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| name          | varchar |
+---------------+---------+
åœ¨ SQL ä¸­ï¼Œid æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®ã€‚
è¿™å¼ è¡¨çš„æ¯ä¸€è¡Œåˆ†åˆ«ä»£è¡¨äº†æŸå…¬å¸å…¶ä¸­ä¸€ä½å‘˜å·¥çš„åå­—å’Œ ID ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">EmployeeUNI</code> è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| unique_id     | int     |
+---------------+---------+
åœ¨ SQL ä¸­ï¼Œ(id, unique_id) æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®ã€‚
è¿™å¼ è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«äº†è¯¥å…¬å¸æŸä½å‘˜å·¥çš„ ID å’Œä»–çš„å”¯ä¸€æ ‡è¯†ç ï¼ˆunique IDï¼‰ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å±•ç¤ºæ¯ä½ç”¨æˆ·çš„ <strong>å”¯ä¸€æ ‡è¯†ç ï¼ˆunique ID ï¼‰</strong>ï¼›å¦‚æœæŸä½å‘˜å·¥æ²¡æœ‰å”¯ä¸€æ ‡è¯†ç ï¼Œä½¿ç”¨ null å¡«å……å³å¯ã€‚</p>

<p>ä½ å¯ä»¥ä»¥ <strong>ä»»æ„</strong> é¡ºåºè¿”å›ç»“æœè¡¨ã€‚</p>

<p>è¿”å›ç»“æœçš„æ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Employees è¡¨:
+----+----------+
| id | name     |
+----+----------+
| 1  | Alice    |
| 7  | Bob      |
| 11 | Meir     |
| 90 | Winston  |
| 3  | Jonathan |
+----+----------+
EmployeeUNI è¡¨:
+----+-----------+
| id | unique_id |
+----+-----------+
| 3  | 1         |
| 11 | 2         |
| 90 | 3         |
+----+-----------+
è¾“å‡ºï¼š
+-----------+----------+
| unique_id | name     |
+-----------+----------+
| null      | Alice    |
| null      | Bob      |
| 2         | Meir     |
| 3         | Winston  |
| 1         | Jonathan |
+-----------+----------+
è§£é‡Šï¼š
Alice and Bob æ²¡æœ‰å”¯ä¸€æ ‡è¯†ç , å› æ­¤æˆ‘ä»¬ä½¿ç”¨ null æ›¿ä»£ã€‚
Meir çš„å”¯ä¸€æ ‡è¯†ç æ˜¯ 2 ã€‚
Winston çš„å”¯ä¸€æ ‡è¯†ç æ˜¯ 3 ã€‚
Jonathan å”¯ä¸€æ ‡è¯†ç æ˜¯ 1 ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                  <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Alice</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bob</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Meir</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Winston</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Jonathan</span><span class="sh">'</span><span class="p">]}</span>

<span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
                     <span class="sh">'</span><span class="s">unique_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¿™é¢˜éå¸¸ç®€å•å•Šï¼Œä¸€ä¸ªmergeæå®šï¼ˆæ³¨æ„howå€¼æ˜¯leftï¼‰</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">replace_employee_id</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">employee_uni</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">employee_uni</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)[[</span><span class="sh">'</span><span class="s">unique_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1280-å­¦ç”Ÿä»¬å‚åŠ å„ç§‘æµ‹è¯•çš„æ¬¡æ•°">1280. å­¦ç”Ÿä»¬å‚åŠ å„ç§‘æµ‹è¯•çš„æ¬¡æ•°</h2>

<p><a href="https://leetcode.cn/problems/students-and-examinations/">1280. å­¦ç”Ÿä»¬å‚åŠ å„ç§‘æµ‹è¯•çš„æ¬¡æ•°</a></p>

<p>å­¦ç”Ÿè¡¨: <code class="language-plaintext highlighter-rouge">Students</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| student_id    | int     |
| student_name  | varchar |
+---------------+---------+
åœ¨ SQL ä¸­ï¼Œä¸»é”®ä¸º student_idï¼ˆå­¦ç”ŸIDï¼‰ã€‚
è¯¥è¡¨å†…çš„æ¯ä¸€è¡Œéƒ½è®°å½•æœ‰å­¦æ ¡ä¸€åå­¦ç”Ÿçš„ä¿¡æ¯ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç§‘ç›®è¡¨: <code class="language-plaintext highlighter-rouge">Subjects</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| subject_name | varchar |
+--------------+---------+
åœ¨ SQL ä¸­ï¼Œä¸»é”®ä¸º subject_nameï¼ˆç§‘ç›®åç§°ï¼‰ã€‚
æ¯ä¸€è¡Œè®°å½•å­¦æ ¡çš„ä¸€é—¨ç§‘ç›®åç§°ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è€ƒè¯•è¡¨: <code class="language-plaintext highlighter-rouge">Examinations</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| student_id   | int     |
| subject_name | varchar |
+--------------+---------+
è¿™ä¸ªè¡¨å¯èƒ½åŒ…å«é‡å¤æ•°æ®ï¼ˆæ¢å¥è¯è¯´ï¼Œåœ¨ SQL ä¸­ï¼Œè¿™ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ï¼‰ã€‚
å­¦ç”Ÿè¡¨é‡Œçš„ä¸€ä¸ªå­¦ç”Ÿä¿®è¯»ç§‘ç›®è¡¨é‡Œçš„æ¯ä¸€é—¨ç§‘ç›®ã€‚
è¿™å¼ è€ƒè¯•è¡¨çš„æ¯ä¸€è¡Œè®°å½•å°±è¡¨ç¤ºå­¦ç”Ÿè¡¨é‡Œçš„æŸä¸ªå­¦ç”Ÿå‚åŠ äº†ä¸€æ¬¡ç§‘ç›®è¡¨é‡ŒæŸé—¨ç§‘ç›®çš„æµ‹è¯•ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æŸ¥è¯¢å‡ºæ¯ä¸ªå­¦ç”Ÿå‚åŠ æ¯ä¸€é—¨ç§‘ç›®æµ‹è¯•çš„æ¬¡æ•°ï¼Œç»“æœæŒ‰ <code class="language-plaintext highlighter-rouge">student_id</code> å’Œ <code class="language-plaintext highlighter-rouge">subject_name</code> æ’åºã€‚</p>

<p>æŸ¥è¯¢ç»“æ„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Students table:
+------------+--------------+
| student_id | student_name |
+------------+--------------+
| 1          | Alice        |
| 2          | Bob          |
| 13         | John         |
| 6          | Alex         |
+------------+--------------+
Subjects table:
+--------------+
| subject_name |
+--------------+
| Math         |
| Physics      |
| Programming  |
+--------------+
Examinations table:
+------------+--------------+
| student_id | subject_name |
+------------+--------------+
| 1          | Math         |
| 1          | Physics      |
| 1          | Programming  |
| 2          | Programming  |
| 1          | Physics      |
| 1          | Math         |
| 13         | Math         |
| 13         | Programming  |
| 13         | Physics      |
| 2          | Math         |
| 1          | Math         |
+------------+--------------+
è¾“å‡ºï¼š
+------------+--------------+--------------+----------------+
| student_id | student_name | subject_name | attended_exams |
+------------+--------------+--------------+----------------+
| 1          | Alice        | Math         | 3              |
| 1          | Alice        | Physics      | 2              |
| 1          | Alice        | Programming  | 1              |
| 2          | Bob          | Math         | 1              |
| 2          | Bob          | Physics      | 0              |
| 2          | Bob          | Programming  | 1              |
| 6          | Alex         | Math         | 0              |
| 6          | Alex         | Physics      | 0              |
| 6          | Alex         | Programming  | 0              |
| 13         | John         | Math         | 1              |
| 13         | John         | Physics      | 1              |
| 13         | John         | Programming  | 1              |
+------------+--------------+--------------+----------------+
è§£é‡Šï¼š
ç»“æœè¡¨éœ€åŒ…å«æ‰€æœ‰å­¦ç”Ÿå’Œæ‰€æœ‰ç§‘ç›®ï¼ˆå³ä¾¿æµ‹è¯•æ¬¡æ•°ä¸º0ï¼‰ï¼š
Alice å‚åŠ äº† 3 æ¬¡æ•°å­¦æµ‹è¯•, 2 æ¬¡ç‰©ç†æµ‹è¯•ï¼Œä»¥åŠ 1 æ¬¡ç¼–ç¨‹æµ‹è¯•ï¼›
Bob å‚åŠ äº† 1 æ¬¡æ•°å­¦æµ‹è¯•, 1 æ¬¡ç¼–ç¨‹æµ‹è¯•ï¼Œæ²¡æœ‰å‚åŠ ç‰©ç†æµ‹è¯•ï¼›
Alex å•¥æµ‹è¯•éƒ½æ²¡å‚åŠ ï¼›
John  å‚åŠ äº†æ•°å­¦ã€ç‰©ç†ã€ç¼–ç¨‹æµ‹è¯•å„ 1 æ¬¡ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">students_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">student_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Alice</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bob</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">John</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Alex</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">subjects_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">examinations_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                     <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">]}</span>



<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">students_data</span><span class="p">)</span>
<span class="n">subjects</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">subjects_data</span><span class="p">)</span>
<span class="n">examinations</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">examinations_data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">students</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">subjects</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">examinations</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>è¦å®Œæˆè¿™é“é¢˜è¦é¦–å…ˆæŒæ¡<strong>ç¬›å¡å°”ç§¯</strong>ï¼šè®¡ç®—æ‰€æœ‰å¯èƒ½çš„å…ƒç´ å¯¹çš„ä¹˜ç§¯</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">students</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">subjects</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">subjects</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250302221843742.png" alt="image-20250302221843742" style="zoom:50%;" /></p>

<p>è¿™æ ·å°±æœ‰äº†è¾“å‡ºçš„é›å½¢ã€‚</p>

<hr />

<p>è¿™é“é¢˜ï¼Œè¿˜æœ‰å¾ˆå¤šå°ç»†èŠ‚è¦æ³¨æ„ã€‚å¯ä»¥è¾¹å†™è¾¹æµ‹è¯•ï¼Œæœ‰äº†ç»“æœæäº¤å‘ç°ä¸é€šè¿‡ ä¹Ÿå¯ä»¥å†è°ƒè¯•ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">students_and_examinations</span><span class="p">(</span><span class="n">students</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">subjects</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">examinations</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">students</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">subjects</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">subjects</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">count_examinations</span> <span class="o">=</span> <span class="n">examinations</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">]).</span><span class="nf">size</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">count_examinations</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">student_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ³¨ï¼š</p>

<p>1.size()å’Œcount()</p>

<p>2.æŸä¸€åˆ—çš„å€¼ï¼ˆå«NaNï¼‰èµ‹å€¼ï¼š<code class="language-plaintext highlighter-rouge">res['attended_exams'] = res['attended_exams'].fillna(0)</code>ï¼Œ å› ä¸ºåå­—è¿™ä¸€åˆ—å¯èƒ½å‡ºç°nullï¼Œä¸å¯è¢«è¦†ç›–ï¼Œæ‰€ä»¥åªå¯¹ä¸€åˆ—è¿›è¡Œnançš„å¡«å……ã€‚</p>

<p>3.<code class="language-plaintext highlighter-rouge">reset_index(name='attended_exams')</code>ï¼Œgroupbyåç»Ÿè®¡çš„ç»“æœèµ‹å€¼ç»™æŸä¸€åˆ—ï¼Œç»™é‚£ä¸€åˆ—å–ä¸ªæ–°åå­—</p>

<p>4.ç¬›å¡å°”ç§¯ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>    <span class="n">students</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">subjects</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">subjects</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="570-è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†">570. è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†</h2>

<p><a href="https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/">570. è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Employee</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
| department  | varchar |
| managerId   | int     |
+-------------+---------+
id æ˜¯æ­¤è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—ï¼‰ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤ºé›‡å‘˜çš„åå­—ã€ä»–ä»¬çš„éƒ¨é—¨å’Œä»–ä»¬çš„ç»ç†çš„idã€‚
å¦‚æœmanagerIdä¸ºç©ºï¼Œåˆ™è¯¥å‘˜å·¥æ²¡æœ‰ç»ç†ã€‚
æ²¡æœ‰å‘˜å·¥ä¼šæˆä¸ºè‡ªå·±çš„ç®¡ç†è€…ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºè‡³å°‘æœ‰<strong>äº”ä¸ªç›´æ¥ä¸‹å±</strong>çš„ç»ç†ã€‚</p>

<p>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>è¾“å…¥: 
Employee è¡¨:
+-----+-------+------------+-----------+
| id  | name  | department | managerId |
+-----+-------+------------+-----------+
| 101 | John  | A          | Null      |
| 102 | Dan   | A          | 101       |
| 103 | James | A          | 101       |
| 104 | Amy   | A          | 101       |
| 105 | Anne  | A          | 101       |
| 106 | Ron   | B          | 101       |
+-----+-------+------------+-----------+
è¾“å‡º: 
+------+
| name |
+------+
| John |
+------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">employee_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">John</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Dan</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">James</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Amy</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Anne</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ron</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">department</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">managerId</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>  <span class="c1"># ä½¿ç”¨ np.nan è¡¨ç¤º Null
</span><span class="p">}</span>

<span class="n">employee</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">employee_data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">employee</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_managers</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">count_managerId</span> <span class="o">=</span> <span class="n">employee</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">managerId</span><span class="sh">'</span><span class="p">).</span><span class="nf">size</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">count_e</span><span class="sh">'</span><span class="p">).</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">managerId</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">})</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employee</span><span class="p">,</span> <span class="n">count_managerId</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">count_e</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="607-é”€å”®å‘˜">607. é”€å”®å‘˜</h2>

<p><a href="https://leetcode.cn/problems/sales-person/">607. é”€å”®å‘˜</a></p>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">SalesPerson</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-----------------+---------+
| Column Name     | Type    |
+-----------------+---------+
| sales_id        | int     |
| name            | varchar |
| salary          | int     |
| commission_rate | int     |
| hire_date       | date    |
+-----------------+---------+
sales_id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½æ˜¾ç¤ºäº†é”€å”®äººå‘˜çš„å§“åå’Œ ID ï¼Œä»¥åŠä»–ä»¬çš„å·¥èµ„ã€ä½£é‡‘ç‡å’Œé›‡ä½£æ—¥æœŸã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Company</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| com_id      | int     |
| name        | varchar |
| city        | varchar |
+-------------+---------+
com_id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå…¬å¸çš„åç§°å’Œ ID ï¼Œä»¥åŠå…¬å¸æ‰€åœ¨çš„åŸå¸‚ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¡¨: <code class="language-plaintext highlighter-rouge">Orders</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| order_id    | int  |
| order_date  | date |
| com_id      | int  |
| sales_id    | int  |
| amount      | int  |
+-------------+------+
order_id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
com_id æ˜¯ Company è¡¨ä¸­ com_id çš„å¤–é”®ï¼ˆreference åˆ—ï¼‰ã€‚
sales_id æ˜¯æ¥è‡ªé”€å”®å‘˜è¡¨ sales_id çš„å¤–é”®ï¼ˆreference åˆ—ï¼‰ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€ä¸ªè®¢å•çš„ä¿¡æ¯ã€‚è¿™åŒ…æ‹¬å…¬å¸çš„ ID ã€é”€å”®äººå‘˜çš„ ID ã€è®¢å•æ—¥æœŸå’Œæ”¯ä»˜çš„é‡‘é¢ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºæ²¡æœ‰ä»»ä½•ä¸åä¸º <strong>â€œREDâ€</strong> çš„å…¬å¸ç›¸å…³çš„è®¢å•çš„æ‰€æœ‰é”€å”®äººå‘˜çš„å§“åã€‚</p>

<p>ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
SalesPerson è¡¨:
+----------+------+--------+-----------------+------------+
| sales_id | name | salary | commission_rate | hire_date  |
+----------+------+--------+-----------------+------------+
| 1        | John | 100000 | 6               | 4/1/2006   |
| 2        | Amy  | 12000  | 5               | 5/1/2010   |
| 3        | Mark | 65000  | 12              | 12/25/2008 |
| 4        | Pam  | 25000  | 25              | 1/1/2005   |
| 5        | Alex | 5000   | 10              | 2/3/2007   |
+----------+------+--------+-----------------+------------+
Company è¡¨:
+--------+--------+----------+
| com_id | name   | city     |
+--------+--------+----------+
| 1      | RED    | Boston   |
| 2      | ORANGE | New York |
| 3      | YELLOW | Boston   |
| 4      | GREEN  | Austin   |
+--------+--------+----------+
Orders è¡¨:
+----------+------------+--------+----------+--------+
| order_id | order_date | com_id | sales_id | amount |
+----------+------------+--------+----------+--------+
| 1        | 1/1/2014   | 3      | 4        | 10000  |
| 2        | 2/1/2014   | 4      | 5        | 5000   |
| 3        | 3/1/2014   | 1      | 1        | 50000  |
| 4        | 4/1/2014   | 1      | 4        | 25000  |
+----------+------------+--------+----------+--------+
è¾“å‡ºï¼š
+------+
| name |
+------+
| Amy  |
| Mark |
| Alex |
+------+
è§£é‡Šï¼š
æ ¹æ®è¡¨ orders ä¸­çš„è®¢å• '3' å’Œ '4' ï¼Œå®¹æ˜“çœ‹å‡ºåªæœ‰ 'John' å’Œ 'Pam' ä¸¤ä¸ªé”€å”®å‘˜æ›¾ç»å‘å…¬å¸ 'RED' é”€å”®è¿‡ã€‚
æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¾“å‡ºè¡¨ salesperson ä¸­æ‰€æœ‰å…¶ä»–äººçš„åå­—ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="n">salesperson_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">sales_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">John</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Amy</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Alex</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">12000</span><span class="p">,</span> <span class="mi">65000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">commission_rate</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">hire_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">4/1/2006</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">5/1/2010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">12/25/2008</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">1/1/2005</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2/3/2007</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">company_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">RED</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ORANGE</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">YELLOW</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">GREEN</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Boston</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">New York</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Boston</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Austin</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">orders_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">order_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">1/1/2014</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2/1/2014</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">3/1/2014</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">4/1/2014</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">sales_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">]</span>
<span class="p">}</span>


<span class="n">sales_person</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">salesperson_data</span><span class="p">)</span>
<span class="n">company</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">company_data</span><span class="p">)</span>
<span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">orders_data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">sales_person</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">company</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">orders</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æœ¬æ¥éƒ½å†™å®Œäº†ï¼Œè·‘â€œæäº¤â€çš„æ—¶å€™å‡ºç°äº†æ²¡æœ‰REDå…¬å¸çš„æƒ…å†µï¼Œæ‰€ä»¥å¤šåŠ ä¸€å±‚åˆ¤æ–­(ç›´æ¥è¿”å›æ‰€æœ‰çš„é”€å”®äººå‘˜å§“å)ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">sales_person</span><span class="p">(</span><span class="n">sales_person</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">company</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="nf">if </span><span class="p">(</span><span class="n">company</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">RED</span><span class="sh">'</span><span class="p">).</span><span class="nf">any</span><span class="p">():</span>
        <span class="n">red_com_id</span> <span class="o">=</span> <span class="n">company</span><span class="p">[</span><span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">][</span><span class="n">company</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">RED</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">sales_person</span><span class="p">[</span><span class="o">~</span><span class="n">sales_person</span><span class="p">[</span><span class="sh">'</span><span class="s">sales_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="sh">"</span><span class="s">sales_id</span><span class="sh">"</span><span class="p">][</span><span class="n">orders</span><span class="p">[</span><span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">red_com_id</span><span class="p">])][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sales_person</span><span class="p">[[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="æµ‹éªŒé¢˜-2">æµ‹éªŒé¢˜</h1>

<h2 id="2041-é¢è¯•ä¸­è¢«å½•å–çš„å€™é€‰äºº">2041. é¢è¯•ä¸­è¢«å½•å–çš„å€™é€‰äºº</h2>

<p><a href="https://leetcode.cn/problems/accepted-candidates-from-the-interviews/">2041. é¢è¯•ä¸­è¢«å½•å–çš„å€™é€‰äºº</a></p>

<p>è¡¨ï¼š<code class="language-plaintext highlighter-rouge">Candidates</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+--------------+----------+
| Column Name  | Type     |
+--------------+----------+
| candidate_id | int      |
| name         | varchar  |
| years_of_exp | int      |
| interview_id | int      |
+--------------+----------+
candidate_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—ï¼‰ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå€™é€‰äººçš„å§“åã€å·¥ä½œå¹´é™ä»¥åŠé¢è¯• ID ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è¡¨ï¼š<code class="language-plaintext highlighter-rouge">Rounds</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+--------------+------+
| Column Name  | Type |
+--------------+------+
| interview_id | int  |
| round_id     | int  |
| score        | int  |
+--------------+------+
(interview_id, round_idï¼‰æ˜¯æœ¬è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆï¼‰ã€‚
æœ¬è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºä¸€è½®é¢è¯•çš„åˆ†æ•°
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡º <strong>è‡³å°‘æœ‰ä¸¤å¹´</strong> å·¥ä½œç»éªŒã€ä¸”é¢è¯•åˆ†æ•°ä¹‹å’Œ <strong>ä¸¥æ ¼å¤§äº <code class="language-plaintext highlighter-rouge">15</code></strong> çš„å€™é€‰äººçš„ ID <strong>ã€‚</strong></p>

<p>å¯ä»¥ä»¥ <strong>ä»»ä½•é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>è¾“å…¥ï¼š
Candidates table:
+--------------+---------+--------------+--------------+
| candidate_id | name    | years_of_exp | interview_id |
+--------------+---------+--------------+--------------+
| 11           | Atticus | 1            | 101          |
| 9            | Ruben   | 6            | 104          |
| 6            | Aliza   | 10           | 109          |
| 8            | Alfredo | 0            | 107          |
+--------------+---------+--------------+--------------+
Rounds table:
+--------------+----------+-------+
| interview_id | round_id | score |
+--------------+----------+-------+
| 109          | 3        | 4     |
| 101          | 2        | 8     |
| 109          | 4        | 1     |
| 107          | 1        | 3     |
| 104          | 3        | 6     |
| 109          | 1        | 4     |
| 104          | 4        | 7     |
| 104          | 1        | 2     |
| 109          | 2        | 1     |
| 104          | 2        | 7     |
| 107          | 2        | 3     |
| 101          | 1        | 8     |
+--------------+----------+-------+
è¾“å‡ºï¼š
+--------------+
| candidate_id |
+--------------+
| 9            |
+--------------+
è§£é‡Šï¼š
- å€™é€‰äºº 11 ï¼šæ€»åˆ†æ˜¯ 16 ï¼Œ1 å¹´å·¥ä½œç»éªŒã€‚ç”±äºå·¥ä½œå¹´é™ï¼Œä¸åˆ—å…¥ç»“æœè¡¨ã€‚
- å€™é€‰äºº 9 ï¼šæ€»åˆ†æ˜¯ 22 ï¼Œ6 å¹´å·¥ä½œç»éªŒã€‚åˆ—å…¥ç»“æœè¡¨ã€‚
- å€™é€‰äºº 6 ï¼šæ€»åˆ†æ˜¯ 10 ï¼Œ10 å¹´å·¥ä½œç»éªŒã€‚ç”±äºåˆ†æ•°ä¸è¶³ï¼Œä¸åˆ—å…¥ç»“æœè¡¨ã€‚
- å€™é€‰äºº 8 ï¼šæ€»åˆ†æ˜¯ 6 ï¼Œ0 å¹´å·¥ä½œç»éªŒã€‚ç”±äºå·¥ä½œå¹´é™å’Œåˆ†æ•°ï¼Œä¸åˆ—å…¥ç»“æœè¡¨ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æµ‹è¯•æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>æˆ‘å†™çš„ç­”æ¡ˆï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">accepted_candidates</span><span class="p">(</span><span class="n">candidates</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rounds</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">sum_</span> <span class="o">=</span> <span class="n">merged</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">candidates</span><span class="p">[(</span><span class="n">candidates</span><span class="p">[</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">sum_</span><span class="p">[</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">][</span><span class="n">sum_</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="sh">'</span><span class="s">years_of_exp</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)][[</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">]]</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>ä»¥ä¸Šå°±å®Œæˆäº†æ•´ä¸ªåˆ·é¢˜è®¡åˆ’ã€‚</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250303114303211.png" alt="image-20250303114303211" style="zoom:50%;" /></p>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2025/03/02/%E5%90%B4%E6%81%A9%E8%BE%BEML2-5/" data-toggle="tooltip" data-placement="top" title="2-5 æ¢¯åº¦ä¸‹é™  Gradient Descent">
                        Previous<br>
                        <span>2-5 æ¢¯åº¦ä¸‹é™  Gradient Descent</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2025/03/03/%E5%90%B4%E6%81%A9%E8%BE%BEML2-6/" data-toggle="tooltip" data-placement="top" title="2-6 æ¢¯åº¦ä¸‹é™çŸ¥è¯†ç‚¹æ€»ç»“">
                        Next<br>
                        <span>2-6 æ¢¯åº¦ä¸‹é™çŸ¥è¯†ç‚¹æ€»ç»“</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0108" 
                    href="/archive/?tag=%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB"
                    title="ä¹¦ç±é˜…è¯»"
                    rel="3">ä¹¦ç±é˜…è¯»</a>
        
                <a data-sort="0087" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95"
                    title="ç®—æ³•"
                    rel="24">ç®—æ³•</a>
        
                <a data-sort="0093" 
                    href="/archive/?tag=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI%E5%9F%BA%E7%A1%80"
                    title="äººå·¥æ™ºèƒ½AIåŸºç¡€"
                    rel="18">äººå·¥æ™ºèƒ½AIåŸºç¡€</a>
        
                <a data-sort="0094" 
                    href="/archive/?tag=python%E5%9F%BA%E7%A1%80"
                    title="pythonåŸºç¡€"
                    rel="17">pythonåŸºç¡€</a>
        
                <a data-sort="0099" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%90%B4%E6%81%A9%E8%BE%BE"
                    title="æœºå™¨å­¦ä¹ -å´æ©è¾¾"
                    rel="12">æœºå™¨å­¦ä¹ -å´æ©è¾¾</a>
        
                <a data-sort="0101" 
                    href="/archive/?tag=%E5%8A%9B%E6%89%A3"
                    title="åŠ›æ‰£"
                    rel="10">åŠ›æ‰£</a>
        
                <a data-sort="0106" 
                    href="/archive/?tag=numpy"
                    title="numpy"
                    rel="5">numpy</a>
        
                <a data-sort="0108" 
                    href="/archive/?tag=spring6"
                    title="spring6"
                    rel="3">spring6</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=Java%E5%9F%BA%E7%A1%80"
                    title="JavaåŸºç¡€"
                    rel="2">JavaåŸºç¡€</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=ollama%E5%B7%A5%E5%85%B7"
                    title="ollamaå·¥å…·"
                    rel="2">ollamaå·¥å…·</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=pandas"
                    title="pandas"
                    rel="2">pandas</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=python%E7%88%AC%E8%99%AB"
                    title="pythonçˆ¬è™«"
                    rel="2">pythonçˆ¬è™«</a>
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://m.freebuf.com/">freebuf</a></li>
  
  <li><a href="https://xz.aliyun.com/">å…ˆçŸ¥</a></li>
  
  <li><a href="https://www.sec-in.com/All">sec-in</a></li>
  
  <li><a href="https://paper.seebug.org/">see-bug</a></li>
  
  <li><a href="https://twitter.com/Concurr21486093">æˆ‘çš„æ¨ç‰¹</a></li>
  
  <li><a href="https://pdai.tech/">pdai</a></li>
  
  <li><a href="https://nodejs.org/dist/">nodejs index of dist</a></li>
  
  <li><a href="#">å…¬ä¼—å·ï¼šå°ä¸œæ–¹ä¸è´¥</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/Concurr21486093">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/Hilda">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">çŸ¥</i>
      </span>
    </a>
  </li>
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/kirsten-1">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Hilda 2025
                    <br>
                    Powered by <a href="https://kirsten-1.github.io/">hilda Blog</a>
<!--                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"-->
<!--                        height="20px"-->
<!--                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">-->
<!--                    </iframe>-->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
