<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="这里是 Hilda 的个人博客，与你一起发现更大的世界 | 要做一个有 swag 的程序员">
    <meta name="keywords" content="Hilda">
    <meta name="theme-color" content="#000000">

    <!-- Open Graph -->
    <meta property="og:title"
        content="力扣 30天pandas挑战 - Hilda的博客 | Your genius girlfriend's blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="

">
    
    <meta property="article:published_time" content=" 2025-03-03T00:00:00Z">
    
    
    <meta property="article:author" content="Hilda">
    
    
    <meta property="article:tag" content="力扣">
    
    
    <meta property="og:image" content="https://kirsten-1.github.io">
    <meta property="og:url" content="https://kirsten-1.github.io/2025/03/03/%E5%8A%9B%E6%89%A3-30%E5%A4%A9Pandas%E6%8C%91%E6%88%98/">
    <meta property="og:site_name" content="Hilda的博客 | Your genius girlfriend's blog">

    <title>力扣 30天pandas挑战 - Hilda的博客 | Your genius girlfriend's blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://kirsten-1.github.io/2025/03/03/%E5%8A%9B%E6%89%A3-30%E5%A4%A9Pandas%E6%8C%91%E6%88%98/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href=" /css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"
        type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-6487568398225121" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Hilda</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-2015.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-bg-2015.jpg');
        background: ;
    }

    
</style>




<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=%E5%8A%9B%E6%89%A3" title="力扣">力扣</a>
                        
                    </div>
                    <h1>力扣 30天pandas挑战</h1>
                    
                    <h2 class="subheading">33题  题目+测试数据+完成挑战</h2>
                    <span class="meta">Posted by Hilda on March 3, 2025</span>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>

<p>NumPy 博客总结：</p>

<p><a href="https://kirsten-1.github.io/2025/02/14/NumPy%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97(%E7%AC%AC2%E7%89%88)%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93/">《Python数据分析基础教程：NumPy学习指南（第2版）》所有章节阅读笔记+代码</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/21/NumPy70%E9%A2%98/">70道NumPy 面试题(题目+答案)</a></p>

<p>pandas博客总结：</p>

<p><a href="https://kirsten-1.github.io/2025/02/21/Pandas(1)%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/">pandas(1)数据预处理</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/24/Pandas(2)%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">pandas(2)数据分析</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/24/pandas(3)%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C/">pandas(3)常用函数操作</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/25/Pandas(4)%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%8A%80%E5%B7%A7/">pandas(4)大数据处理技巧</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/25/%E5%8A%9B%E6%89%A3pandas%E5%85%A5%E9%97%A815%E9%A2%98/">【力扣】pandas入门15题</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/28/pandas%E9%87%8D%E8%A6%81%E5%87%BD%E6%95%B0transform/">返回与输入组具有相同形状的结果的transform函数</a></p>

<p><a href="https://kirsten-1.github.io/2025/02/28/%E8%BD%AC%E6%8D%A2%E4%B8%8E%E9%87%8D%E5%A1%91df-melt%E5%87%BD%E6%95%B0/">melt函数-df长宽变形大师 - melt的重塑神功【melt函数的介绍与练习】</a></p>

<hr />

<p>本篇博客是力扣的“30天pandas挑战”。—–一共30题</p>

<h1 id="第一类条件筛选">第一类：条件筛选</h1>

<h2 id="595-大的国家">595. 大的国家</h2>

<p><a href="https://leetcode.cn/problems/big-countries/">595. 大的国家</a></p>

<p><code class="language-plaintext highlighter-rouge">World</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| name        | varchar |
| continent   | varchar |
| area        | int     |
| population  | int     |
| gdp         | bigint  |
+-------------+---------+
name 是该表的主键（具有唯一值的列）。
这张表的每一行提供：国家名称、所属大陆、面积、人口和 GDP 值。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>如果一个国家满足下述两个条件之一，则认为该国是 <strong>大国</strong> ：</p>

<ul>
  <li>面积至少为 300 万平方公里（即，<code class="language-plaintext highlighter-rouge">3000000 km2</code>），或者</li>
  <li>人口至少为 2500 万（即 <code class="language-plaintext highlighter-rouge">25000000</code>）</li>
</ul>

<p>编写解决方案找出 <strong>大国</strong> 的国家名称、人口和面积。</p>

<p>按 <strong>任意顺序</strong> 返回结果表。</p>

<p>返回结果格式如下例所示。</p>

<p><strong>示例：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>输入：
World 表：
+-------------+-----------+---------+------------+--------------+
| name        | continent | area    | population | gdp          |
+-------------+-----------+---------+------------+--------------+
| Afghanistan | Asia      | 652230  | 25500100   | 20343000000  |
| Albania     | Europe    | 28748   | 2831741    | 12960000000  |
| Algeria     | Africa    | 2381741 | 37100000   | 188681000000 |
| Andorra     | Europe    | 468     | 78115      | 3712000000   |
| Angola      | Africa    | 1246700 | 20609294   | 100990000000 |
+-------------+-----------+---------+------------+--------------+
输出：
+-------------+------------+---------+
| name        | population | area    |
+-------------+------------+---------+
| Afghanistan | 25500100   | 652230  |
| Algeria     | 37100000   | 2381741 |
+-------------+------------+---------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">big_countries</span><span class="p">(</span><span class="n">world</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">world</span><span class="p">[(</span><span class="n">world</span><span class="p">[</span><span class="sh">'</span><span class="s">area</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3000000</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">world</span><span class="p">[</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">25000000</span><span class="p">)][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">area</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1757-可回收且低脂的产品">1757. 可回收且低脂的产品</h2>

<p><a href="https://leetcode.cn/problems/recyclable-and-low-fat-products/">1757. 可回收且低脂的产品</a></p>

<p>表：<code class="language-plaintext highlighter-rouge">Products</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| product_id  | int     |
| low_fats    | enum    |
| recyclable  | enum    |
+-------------+---------+
product_id 是该表的主键（具有唯一值的列）。
low_fats 是枚举类型，取值为以下两种 ('Y', 'N')，其中 'Y' 表示该产品是低脂产品，'N' 表示不是低脂产品。
recyclable 是枚举类型，取值为以下两种 ('Y', 'N')，其中 'Y' 表示该产品可回收，而 'N' 表示不可回收。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案找出既是低脂又是可回收的产品编号。</p>

<p>返回结果 <strong>无顺序要求</strong> 。</p>

<p>返回结果格式如下例所示：</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>输入：
Products 表：
+-------------+----------+------------+
| product_id  | low_fats | recyclable |
+-------------+----------+------------+
| 0           | Y        | N          |
| 1           | Y        | Y          |
| 2           | N        | Y          |
| 3           | Y        | Y          |
| 4           | N        | N          |
+-------------+----------+------------+
输出：
+-------------+
| product_id  |
+-------------+
| 1           |
| 3           |
+-------------+
解释：
只有产品 id 为 1 和 3 的产品，既是低脂又是可回收的产品。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_products</span><span class="p">(</span><span class="n">products</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">products</span><span class="p">[(</span><span class="n">products</span><span class="p">[</span><span class="sh">'</span><span class="s">low_fats</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">"</span><span class="s">Y</span><span class="sh">"</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">products</span><span class="p">[</span><span class="sh">'</span><span class="s">recyclable</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">"</span><span class="s">Y</span><span class="sh">"</span><span class="p">)][[</span><span class="sh">'</span><span class="s">product_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="183-从不订购的客户">🌟183. 从不订购的客户</h2>

<p><a href="https://leetcode.cn/problems/customers-who-never-order/">183. 从不订购的客户</a></p>

<p><code class="language-plaintext highlighter-rouge">Customers</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
在 SQL 中，id 是该表的主键。
该表的每一行都表示客户的 ID 和名称。
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Orders</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| customerId  | int  |
+-------------+------+
在 SQL 中，id 是该表的主键。
customerId 是 Customers 表中 ID 的外键( Pandas 中的连接键)。
该表的每一行都表示订单的 ID 和订购该订单的客户的 ID。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>找出所有从不点任何东西的顾客。</p>

<p>以 <strong>任意顺序</strong> 返回结果表。</p>

<p>结果格式如下所示。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>输入：
Customers table:
+----+-------+
| id | name  |
+----+-------+
| 1  | Joe   |
| 2  | Henry |
| 3  | Sam   |
| 4  | Max   |
+----+-------+
Orders table:
+----+------------+
| id | customerId |
+----+------------+
| 1  | 3          |
| 2  | 1          |
+----+------------+
输出：
+-----------+
| Customers |
+-----------+
| Henry     |
| Max       |
+-----------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_customers</span><span class="p">(</span><span class="n">customers</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">customers</span><span class="p">,</span> <span class="n">orders</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="o">~</span><span class="n">merged_df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="nf">isnull</span><span class="p">()][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
    <span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Customers</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>是一步一步调试出来的，参考下面代码：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1"># Customers 表的数据
</span><span class="n">customers_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                  <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Joe</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Henry</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Max</span><span class="sh">'</span><span class="p">]}</span>

<span class="c1"># Orders 表的数据
</span><span class="n">orders_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
               <span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>

<span class="c1"># 创建 Customers DataFrame
</span><span class="n">customers</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">customers_data</span><span class="p">)</span>
<span class="n">customers</span> <span class="o">=</span> <span class="n">customers</span><span class="p">.</span><span class="nf">set_index</span><span class="p">(</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># 设置 id 列为主键（索引）
</span>
<span class="c1"># 创建 Orders DataFrame
</span><span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">orders_data</span><span class="p">)</span>
<span class="n">orders</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="nf">set_index</span><span class="p">(</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 设置 id 列为主键（索引）
</span>
<span class="nf">display</span><span class="p">(</span><span class="n">orders</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">customers</span><span class="p">)</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">customers</span><span class="p">,</span> <span class="n">orders</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">display</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>


<span class="n">res</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="nf">isnull</span><span class="p">()][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
<span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Customers</span><span class="sh">"</span><span class="p">]</span>
<span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250225164429895.png" alt="image-20250225164429895" style="zoom:50%;" /></p>

<p>但是运行过了，提交就有错。</p>

<p>更简单的方法：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_customers</span><span class="p">(</span><span class="n">customers</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">customers</span><span class="p">[</span><span class="o">~</span><span class="n">customers</span><span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="sh">'</span><span class="s">customerId</span><span class="sh">'</span><span class="p">])][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
    <span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Customers</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1148-文章浏览-i">1148. 文章浏览 I</h2>

<p><a href="https://leetcode.cn/problems/article-views-i/">1148. 文章浏览 I</a></p>

<p><code class="language-plaintext highlighter-rouge">Views</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| article_id    | int     |
| author_id     | int     |
| viewer_id     | int     |
| view_date     | date    |
+---------------+---------+
此表可能会存在重复行。（换句话说，在 SQL 中这个表没有主键）
此表的每一行都表示某人在某天浏览了某位作者的某篇文章。
请注意，同一人的 author_id 和 viewer_id 是相同的。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>请查询出所有浏览过自己文章的作者</p>

<p>结果按照 <code class="language-plaintext highlighter-rouge">id</code> 升序排列。</p>

<p>查询结果的格式如下所示：</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>输入：
Views 表：
+------------+-----------+-----------+------------+
| article_id | author_id | viewer_id | view_date  |
+------------+-----------+-----------+------------+
| 1          | 3         | 5         | 2019-08-01 |
| 1          | 3         | 6         | 2019-08-02 |
| 2          | 7         | 7         | 2019-08-01 |
| 2          | 7         | 6         | 2019-08-02 |
| 4          | 7         | 1         | 2019-07-22 |
| 3          | 4         | 4         | 2019-07-21 |
| 3          | 4         | 4         | 2019-07-21 |
+------------+-----------+-----------+------------+

输出：
+------+
| id   |
+------+
| 4    |
| 7    |
+------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">article_views</span><span class="p">(</span><span class="n">views</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">views</span><span class="p">[</span><span class="n">views</span><span class="p">[</span><span class="sh">'</span><span class="s">author_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">views</span><span class="p">[</span><span class="sh">'</span><span class="s">viewer_id</span><span class="sh">'</span><span class="p">]][[</span><span class="sh">'</span><span class="s">author_id</span><span class="sh">'</span><span class="p">]].</span><span class="nf">drop_duplicates</span><span class="p">()</span>
    <span class="n">res</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="第二类字符串函数">第二类：字符串函数</h1>

<h2 id="1683-无效的推文">1683. 无效的推文</h2>

<p><a href="https://leetcode.cn/problems/invalid-tweets/">1683. 无效的推文</a></p>

<p>表：<code class="language-plaintext highlighter-rouge">Tweets</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+----------------+---------+
| Column Name    | Type    |
+----------------+---------+
| tweet_id       | int     |
| content        | varchar |
+----------------+---------+
在 SQL 中，tweet_id 是这个表的主键。
content 只包含美式键盘上的字符，不包含其它特殊字符。
这个表包含某社交媒体 App 中所有的推文。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询所有无效推文的编号（ID）。当推文内容中的字符数<strong>严格大于</strong> <code class="language-plaintext highlighter-rouge">15</code> 时，该推文是无效的。</p>

<p>以<strong>任意顺序</strong>返回结果表。</p>

<p>查询结果格式如下所示：</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>输入：
Tweets 表：
+----------+----------------------------------+
| tweet_id | content                          |
+----------+----------------------------------+
| 1        | Vote for Biden                   |
| 2        | Let us make America great again! |
+----------+----------------------------------+

输出：
+----------+
| tweet_id |
+----------+
| 2        |
+----------+
解释：
推文 1 的长度 length = 14。该推文是有效的。
推文 2 的长度 length = 32。该推文是无效的。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">invalid_tweets</span><span class="p">(</span><span class="n">tweets</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">tweets</span><span class="p">[</span><span class="n">tweets</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">15</span> <span class="p">)][[</span><span class="sh">'</span><span class="s">tweet_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>然后看到一个方法，是我原先的想法：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">invalid_tweets</span><span class="p">(</span><span class="n">tweets</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">tweets</span><span class="p">[</span><span class="n">tweets</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">][[</span><span class="sh">'</span><span class="s">tweet_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>注：<code class="language-plaintext highlighter-rouge">len(tweets['content'].str)</code> 会报错，这个语句返回的是一个series对象，不可迭代；len函数需要是可迭代对象才能计数</p>

<h2 id="1873-计算特殊奖金">1873. 计算特殊奖金</h2>

<p><a href="https://leetcode.cn/problems/calculate-special-bonus/">1873. 计算特殊奖金</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Employees</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| 列名        | 类型     |
+-------------+---------+
| employee_id | int     |
| name        | varchar |
| salary      | int     |
+-------------+---------+
employee_id 是这个表的主键(具有唯一值的列)。
此表的每一行给出了雇员id ，名字和薪水。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案，计算每个雇员的奖金。如果一个雇员的 id 是 <strong>奇数</strong> 并且他的名字不是以 <code class="language-plaintext highlighter-rouge">'M'</code> <strong>开头</strong>，那么他的奖金是他工资的 <code class="language-plaintext highlighter-rouge">100%</code> ，否则奖金为 <code class="language-plaintext highlighter-rouge">0</code> 。</p>

<p>返回的结果按照 <code class="language-plaintext highlighter-rouge">employee_id</code> 排序。</p>

<p>返回结果格式如下面的例子所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>输入：
Employees 表:
+-------------+---------+--------+
| employee_id | name    | salary |
+-------------+---------+--------+
| 2           | Meir    | 3000   |
| 3           | Michael | 3800   |
| 7           | Addilyn | 7400   |
| 8           | Juan    | 6100   |
| 9           | Kannon  | 7700   |
+-------------+---------+--------+
输出：
+-------------+-------+
| employee_id | bonus |
+-------------+-------+
| 2           | 0     |
| 3           | 0     |
| 7           | 7400  |
| 8           | 0     |
| 9           | 7700  |
+-------------+-------+
解释：
因为雇员id是偶数，所以雇员id 是2和8的两个雇员得到的奖金是0。
雇员id为3的因为他的名字以'M'开头，所以，奖金是0。
其他的雇员得到了百分之百的奖金。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">calculate_special_bonus</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">][(</span><span class="o">~</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> 
                    <span class="p">(</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="sh">"</span><span class="s">M</span><span class="sh">"</span><span class="p">))</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">"</span><span class="s">salary</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">bonus</span><span class="sh">"</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bonus</span><span class="sh">'</span><span class="p">]].</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>参考答案：（别人写的，但我感觉很不错）</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">calculate_special_bonus</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">bonus</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="sh">'</span><span class="s">M</span><span class="sh">'</span><span class="p">))</span> <span class="o">*</span> <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">employees</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">employees</span><span class="p">[[</span><span class="sh">'</span><span class="s">employee_id</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">bonus</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1667-修复表中的名字">1667. 修复表中的名字</h2>

<p><a href="https://leetcode.cn/problems/fix-names-in-a-table/">1667. 修复表中的名字</a></p>

<p>表： <code class="language-plaintext highlighter-rouge">Users</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+----------------+---------+
| Column Name    | Type    |
+----------------+---------+
| user_id        | int     |
| name           | varchar |
+----------------+---------+
user_id 是该表的主键(具有唯一值的列)。
该表包含用户的 ID 和名字。名字仅由小写和大写字符组成。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案，修复名字，使得只有第一个字符是大写的，其余都是小写的。</p>

<p>返回按 <code class="language-plaintext highlighter-rouge">user_id</code> 排序的结果表。</p>

<p>返回结果格式示例如下。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>输入：
Users table:
+---------+-------+
| user_id | name  |
+---------+-------+
| 1       | aLice |
| 2       | bOB   |
+---------+-------+
输出：
+---------+-------+
| user_id | name  |
+---------+-------+
| 1       | Alice |
| 2       | Bob   |
+---------+-------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">fix_names</span><span class="p">(</span><span class="n">users</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">users</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">users</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">capitalize</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">users</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>这道题其实就是考察一个函数<code class="language-plaintext highlighter-rouge">capitalize()</code>，没啥新鲜的。</p>

<h2 id="1517-查找拥有有效邮箱的用户">🌟1517. 查找拥有有效邮箱的用户</h2>

<p><a href="https://leetcode.cn/problems/find-users-with-valid-e-mails/">1517. 查找拥有有效邮箱的用户</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Users</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| user_id       | int     |
| name          | varchar |
| mail          | varchar |
+---------------+---------+
user_id 是该表的主键（具有唯一值的列）。
该表包含了网站已注册用户的信息。有一些电子邮件是无效的。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写一个解决方案，以查找具有有效电子邮件的用户。</p>

<p>一个有效的电子邮件具有前缀名称和域，其中：</p>

<ol>
  <li><strong>前缀</strong> 名称是一个字符串，可以包含字母（大写或小写），数字，下划线 <code class="language-plaintext highlighter-rouge">'_'</code> ，点 <code class="language-plaintext highlighter-rouge">'.'</code> 和/或破折号 <code class="language-plaintext highlighter-rouge">'-'</code> 。前缀名称 <strong>必须</strong> 以字母开头。</li>
  <li><strong>域</strong> 为 <code class="language-plaintext highlighter-rouge">'@leetcode.com'</code> 。</li>
</ol>

<p>以任何顺序返回结果表。</p>

<p>结果的格式如以下示例所示：</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>输入：
Users 表:
+---------+-----------+-------------------------+
| user_id | name      | mail                    |
+---------+-----------+-------------------------+
| 1       | Winston   | winston@leetcode.com    |
| 2       | Jonathan  | jonathanisgreat         |
| 3       | Annabelle | bella-@leetcode.com     |
| 4       | Sally     | sally.come@leetcode.com |
| 5       | Marwan    | quarz#2020@leetcode.com |
| 6       | David     | david69@gmail.com       |
| 7       | Shapiro   | .shapo@leetcode.com     |
+---------+-----------+-------------------------+
输出：
+---------+-----------+-------------------------+
| user_id | name      | mail                    |
+---------+-----------+-------------------------+
| 1       | Winston   | winston@leetcode.com    |
| 3       | Annabelle | bella-@leetcode.com     |
| 4       | Sally     | sally.come@leetcode.com |
+---------+-----------+-------------------------+
解释：
用户 2 的电子邮件没有域。 
用户 5 的电子邮件带有不允许的 '#' 符号。
用户 6 的电子邮件没有 leetcode 域。 
用户 7 的电子邮件以点开头。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">valid_emails</span><span class="p">(</span><span class="n">users</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">^[A-Za-z][A-Za-z0-9_./-]*@leetcode\.com$</span><span class="sh">'</span>
    <span class="k">return</span> <span class="n">users</span><span class="p">[</span><span class="n">users</span><span class="p">[</span><span class="sh">'</span><span class="s">mail</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>这道题关键是把正则看懂：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">^</code>: 匹配字符串的开头。</li>
  <li><code class="language-plaintext highlighter-rouge">[A-Za-z]</code>: 必须以字母（大写或小写）开头。</li>
  <li><code class="language-plaintext highlighter-rouge">[A-Za-z0-9_.-]*</code>: 允许字母、数字、下划线、点和破折号的组合，可以出现 0 次或多次。</li>
  <li><code class="language-plaintext highlighter-rouge">@XXX\.com</code>: 强制要求以”<code class="language-plaintext highlighter-rouge">@XXX.com</code>“结尾，<code class="language-plaintext highlighter-rouge">\.</code> 表示匹配实际的点字符.</li>
  <li><code class="language-plaintext highlighter-rouge">$</code>: 匹配字符串的结尾.</li>
</ul>

<p>最好@也转义一下：<code class="language-plaintext highlighter-rouge">\@</code>?   其实<code class="language-plaintext highlighter-rouge">python 3.7</code>以后的<code class="language-plaintext highlighter-rouge">@</code>字符不再需要转义</p>

<p>另外case=False可以不写，因为一开始已经写了<code class="language-plaintext highlighter-rouge">^[A-Za-z]</code></p>

<hr />

<h2 id="1527-患某种疾病的患者">1527. 患某种疾病的患者</h2>

<p><a href="https://leetcode.cn/problems/patients-with-a-condition/">1527. 患某种疾病的患者</a></p>

<p>患者信息表： <code class="language-plaintext highlighter-rouge">Patients</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| patient_id   | int     |
| patient_name | varchar |
| conditions   | varchar |
+--------------+---------+
在 SQL 中，patient_id （患者 ID）是该表的主键。
'conditions' （疾病）包含 0 个或以上的疾病代码，以空格分隔。
这个表包含医院中患者的信息。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询患有 I 类糖尿病的患者 ID （patient_id）、患者姓名（patient_name）以及其患有的所有疾病代码（conditions）。I 类糖尿病的代码总是包含前缀 <code class="language-plaintext highlighter-rouge">DIAB1</code> 。</p>

<p>按 <strong>任意顺序</strong> 返回结果表。</p>

<p>查询结果格式如下示例所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>输入：
Patients表：
+------------+--------------+--------------+
| patient_id | patient_name | conditions   |
+------------+--------------+--------------+
| 1          | Daniel       | YFEV COUGH   |
| 2          | Alice        |              |
| 3          | Bob          | DIAB100 MYOP |
| 4          | George       | ACNE DIAB100 |
| 5          | Alain        | DIAB201      |
+------------+--------------+--------------+
输出：
+------------+--------------+--------------+
| patient_id | patient_name | conditions   |
+------------+--------------+--------------+
| 3          | Bob          | DIAB100 MYOP |
| 4          | George       | ACNE DIAB100 | 
+------------+--------------+--------------+
解释：Bob 和 George 都患有代码以 DIAB1 开头的疾病。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_patients</span><span class="p">(</span><span class="n">patients</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">patients</span><span class="p">[</span><span class="n">patients</span><span class="p">[</span><span class="sh">'</span><span class="s">conditions</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">^DIAB1|\sDIAB1</span><span class="sh">'</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>这题是真不会写了.因为无法提交成功，但是我拿官方的答案（方法1）试了下也通过不了（<code class="language-plaintext highlighter-rouge">+DIAB1</code>这个测试用例无法通过），和我的情况是一样的。上面这个解答是方法1修改成功之后的解法，也是评论区看的。</p>

<p>解释这个正则：<code class="language-plaintext highlighter-rouge">^DIAB1</code>匹配conditions字段以DIAB1开头的情况。 <code class="language-plaintext highlighter-rouge">\sDIAB1</code>匹配conditions中空格后紧跟DIAB1的情况。 <code class="language-plaintext highlighter-rouge">| </code>是逻辑“或”的运算符，表示匹配两种情况中的任意一种。</p>

<hr />

<h1 id="测验题">测验题</h1>

<h2 id="2738-统计文本中单词的出现次数">2738. 统计文本中单词的出现次数</h2>

<p><a href="https://leetcode.cn/problems/count-occurrences-in-text/">2738. 统计文本中单词的出现次数</a></p>

<p>表：<code class="language-plaintext highlighter-rouge">Files</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| 列名        | 类型    |
+-- ----------+---------+
| file_name   | varchar |
| content     | text    |
+-------------+---------+
file_name 为该表的主键（具有唯一值的列）。
每行包含 file_name 和该文件的内容。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案，找出单词 <strong>‘bull’</strong> 和 <strong>‘bear’</strong> 作为 <strong>独立词</strong> 有出现的文件数量，不考虑任何它出现在两侧没有空格的情况（例如，’bullet’, ‘bears’, ‘bull.’，或者 ‘bear’ 在句首或句尾 <strong>不会</strong> 被考虑）。</p>

<p>返回单词 ‘bull’ 和 ‘bear’ 以及它们对应的出现文件数量，<strong>顺序没有限制</strong> 。</p>

<p>结果的格式如下所示：</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>输入：
Files 表:
+------------+----------------------------------------------------------------------------------+
| file_name  | contenet                                                                         | 
+------------+----------------------------------------------------------------------------------+
| draft1.txt | The stock exchange predicts a bull market which would make many investors happy. | 
| draft2.txt | The stock exchange predicts a bull market which would make many investors happy, |
|            | but analysts warn of possibility of too much optimism and that in fact we are    |
|            | awaiting a bear market.                                                          | 
| draft3.txt | The stock exchange predicts a bull market which would make many investors happy, |
|            | but analysts warn of possibility of too much optimism and that in fact we are    |
|            | awaiting a bear market. As always predicting the future market is an uncertain   |
|            | game and all investors should follow their instincts and best practices.         | 
+------------+----------------------------------------------------------------------------------+
输出： 
+------+-------+
| word | count |  
+------+-------+
| bull | 3     | 
| bear | 2     | 
+------+-------+
解释：
- 单词 "bull" 在 "draft1.txt" 中出现1次，在 "draft2.txt" 中出现 1 次，在 "draft3.txt" 中出现 1 次。因此，单词 "bull" 出现在 3 个文件中。
- 单词 "bear" 在 "draft2.txt" 中出现1次，在 "draft3.txt" 中出现 1 次。因此，单词 "bear" 出现在 2 个文件中。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_occurrences</span><span class="p">(</span><span class="n">files</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="sh">'</span><span class="s">word</span><span class="sh">'</span><span class="p">:[</span><span class="sh">'</span><span class="s">bull</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bear</span><span class="sh">'</span><span class="p">],</span> 
        <span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">:[</span><span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">\sbull\s</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">(),</span> 
        <span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">\sbear\s</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()]}</span>
    <span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">\s</code>表示空格。</p>

<h1 id="数据操作">数据操作</h1>

<h2 id="177-第n高的薪水">177. 第N高的薪水</h2>

<p><a href="https://leetcode.cn/problems/nth-highest-salary/">177. 第N高的薪水</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Employee</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| salary      | int  |
+-------------+------+
在 SQL 中，id 是该表的主键。
该表的每一行都包含有关员工工资的信息。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询 <code class="language-plaintext highlighter-rouge">Employee</code> 表中第 <code class="language-plaintext highlighter-rouge">n</code> 高的工资。如果没有第 <code class="language-plaintext highlighter-rouge">n</code> 个最高工资，查询结果应该为 <code class="language-plaintext highlighter-rouge">null</code> 。</p>

<p>查询结果格式如下所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>输入: 
Employee table:
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
n = 2
输出: 
+------------------------+
| getNthHighestSalary(2) |
+------------------------+
| 200                    |
+------------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>示例 2:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>输入: 
Employee 表:
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
+----+--------+
n = 2
输出: 
+------------------------+
| getNthHighestSalary(2) |
+------------------------+
| null                   |
+------------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我的答案：（改了好多次）</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">nth_highest_salary</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">distinct_salaries</span> <span class="o">=</span> <span class="n">employee</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">drop_duplicates</span><span class="p">().</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">N</span> <span class="o">&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">distinct_salaries</span><span class="p">):</span>  <span class="c1">#Simplified condition
</span>        <span class="n">res</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">distinct_salaries</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">res</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="sh">'</span><span class="s">getNthHighestSalary(</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s">)</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="176-第二高的薪水">176. 第二高的薪水</h2>

<p><a href="https://leetcode.cn/problems/second-highest-salary/">176. 第二高的薪水</a></p>

<p><code class="language-plaintext highlighter-rouge">Employee</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| salary      | int  |
+-------------+------+
id 是这个表的主键。
表的每一行包含员工的工资信息。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询并返回 <code class="language-plaintext highlighter-rouge">Employee</code> 表中第二高的 <strong>不同</strong> 薪水 。如果不存在第二高的薪水，查询应该返回 <code class="language-plaintext highlighter-rouge">null(Pandas 则返回 None)</code> 。</p>

<p>查询结果如下例所示。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>输入：
Employee 表：
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
输出：
+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>示例 2：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>输入：
Employee 表：
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
+----+--------+
输出：
+---------------------+
| SecondHighestSalary |
+---------------------+
| null                |
+---------------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>只不过就是前一题变成了N=2的特殊情况：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">second_highest_salary</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">sorted_salary</span> <span class="o">=</span> <span class="n">employee</span><span class="p">[</span><span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">drop_duplicates</span><span class="p">().</span><span class="nf">sort_values</span><span class="p">(</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span>  <span class="nf">len</span><span class="p">(</span><span class="n">sorted_salary</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">sorted_salary</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">SecondHighestSalary</span><span class="sh">'</span><span class="p">],</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="184-部门工资最高的员工">184. 部门工资最高的员工</h2>

<p><a href="https://leetcode.cn/problems/department-highest-salary/">184. 部门工资最高的员工</a></p>

<p>表： <code class="language-plaintext highlighter-rouge">Employee</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| 列名          | 类型    |
+--------------+---------+
| id           | int     |
| name         | varchar |
| salary       | int     |
| departmentId | int     |
+--------------+---------+
在 SQL 中，id是此表的主键。
departmentId 是 Department 表中 id 的外键（在 Pandas 中称为 join key）。
此表的每一行都表示员工的 id、姓名和工资。它还包含他们所在部门的 id。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>表： <code class="language-plaintext highlighter-rouge">Department</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| 列名         | 类型    |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
在 SQL 中，id 是此表的主键列。
此表的每一行都表示一个部门的 id 及其名称。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查找出每个部门中薪资最高的员工。
按 <strong>任意顺序</strong> 返回结果表。
查询结果格式如下例所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>输入：
Employee 表:
+----+-------+--------+--------------+
| id | name  | salary | departmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 70000  | 1            |
| 2  | Jim   | 90000  | 1            |
| 3  | Henry | 80000  | 2            |
| 4  | Sam   | 60000  | 2            |
| 5  | Max   | 90000  | 1            |
+----+-------+--------+--------------+
Department 表:
+----+-------+
| id | name  |
+----+-------+
| 1  | IT    |
| 2  | Sales |
+----+-------+
输出：
+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Jim      | 90000  |
| Sales      | Henry    | 80000  |
| IT         | Max      | 90000  |
+------------+----------+--------+
解释：Max 和 Jim 在 IT 部门的工资都是最高的，Henry 在销售部的工资最高。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这道题我将调试部分也附上代码：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Employee DataFrame
</span><span class="n">employee_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Joe</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Jim</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Henry</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Max</span><span class="sh">'</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">70000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="n">employee</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">employee_data</span><span class="p">)</span>

<span class="c1"># Department DataFrame
</span><span class="n">department_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">IT</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sales</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">Department</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">department_data</span><span class="p">)</span>

<span class="n">Department</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">employee</span> <span class="o">=</span> <span class="n">employee</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">merge_table</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employee</span><span class="p">,</span> <span class="n">Department</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)</span>


<span class="nf">display</span><span class="p">(</span><span class="n">merge_table</span><span class="p">)</span>
<span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_table</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">merge_table</span><span class="p">)</span>

<span class="n">merge_table</span><span class="p">[</span><span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]][[</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228134040360.png" alt="image-20250228134040360" style="zoom:50%;" /></p>

<p>关于transform函数，可以复习：<a href="https://kirsten-1.github.io/2025/02/28/pandas%E9%87%8D%E8%A6%81%E5%87%BD%E6%95%B0transform/">返回与输入组具有相同形状的结果的transform函数</a></p>

<p>题解答案是：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">department_highest_salary</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">department</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">department</span> <span class="o">=</span> <span class="n">department</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">employee</span> <span class="o">=</span> <span class="n">employee</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">merge_table</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employee</span><span class="p">,</span> <span class="n">department</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_table</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">departmentId</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">merge_table</span><span class="p">[</span><span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">merge_table</span><span class="p">[</span><span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]][[</span><span class="sh">'</span><span class="s">Department</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Employee</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Salary</span><span class="sh">'</span><span class="p">]]</span>
    
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="178-分数排名">178. 分数排名</h2>

<p><a href="https://leetcode.cn/problems/rank-scores/">178. 分数排名</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Scores</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| score       | decimal |
+-------------+---------+
id 是该表的主键（有不同值的列）。
该表的每一行都包含了一场比赛的分数。Score 是一个有两位小数点的浮点值。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写一个解决方案来查询分数的排名。排名按以下规则计算:</p>

<ul>
  <li>分数应按从高到低排列。</li>
  <li>如果两个分数相等，那么两个分数的排名应该相同。</li>
  <li>在排名相同的分数后，排名数应该是下一个连续的整数。换句话说，排名之间不应该有空缺的数字。</li>
</ul>

<p>按 <code class="language-plaintext highlighter-rouge">score</code> 降序返回结果表。</p>

<p>查询结果格式如下所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>输入: 
Scores 表:
+----+-------+
| id | score |
+----+-------+
| 1  | 3.50  |
| 2  | 3.65  |
| 3  | 4.00  |
| 4  | 3.85  |
| 5  | 4.00  |
| 6  | 3.65  |
+----+-------+
输出: 
+-------+------+
| score | rank |
+-------+------+
| 4.00  | 1    |
| 4.00  | 1    |
| 3.85  | 2    |
| 3.65  | 3    |
| 3.65  | 3    |
| 3.50  | 4    |
+-------+------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这道题我研究了一下rank函数的参数,最终机缘巧合居然做出来了：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">order_scores</span><span class="p">(</span><span class="n">scores</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">dense</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">sorted_df</span> <span class="o">=</span> <span class="n">scores</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sorted_df</span><span class="p">[[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>补充：<code class="language-plaintext highlighter-rouge">df['rank'] = df['score'].rank(ascending=False, method='dense')</code>中的<code class="language-plaintext highlighter-rouge">method</code>参数：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">dense</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140539122.png" alt="image-20250228140539122" style="zoom:50%;" /></p>

<p>average是默认参数：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">average</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140646508.png" alt="image-20250228140646508" style="zoom:50%;" /></p>

<p>补充：前面的1.5是这么算的：</p>

<p>应该是排名1和2，但是不分前后，所以<code class="language-plaintext highlighter-rouge">（1+2）/2=1.5</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">min</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140801289.png" alt="image-20250228140801289" style="zoom:50%;" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140820912.png" alt="image-20250228140820912" style="zoom:50%;" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">rank</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">first</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228140903602.png" alt="image-20250228140903602" style="zoom:50%;" /></p>

<ul>
  <li><strong>method</strong>: 指定如何处理平局 (相同的值)。这是 rank() 函数最重要的参数之一。 选项包括：
    <ul>
      <li>‘average’ (默认): 将平均排名分配给每个平局组中的值。</li>
      <li>‘min’: 将最小的排名分配给每个平局组中的值。</li>
      <li>‘max’: 将最大的排名分配给每个平局组中的值。</li>
      <li>‘first’: 按照值在数据中出现的顺序分配排名。</li>
      <li>‘dense’: 类似于 ‘min’，但排名之间没有间隔。即，下一个非平局值将获得紧随其后的排名。</li>
    </ul>
  </li>
</ul>

<hr />

<h4 id="rank常见的三种排序方式">rank常见的三种排序方式</h4>

<ul>
  <li>First 顺序排名，1，2，3，4，5</li>
  <li>Min 跳跃排名，1，2，2，4，5（并列2/3名，取小的2）</li>
  <li>Dense 密集排名，1，2，2，3，4</li>
</ul>

<hr />

<h2 id="196-删除重复的电子邮箱">196. 删除重复的电子邮箱</h2>

<p><a href="https://leetcode.cn/problems/delete-duplicate-emails/">196. 删除重复的电子邮箱</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Person</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| email       | varchar |
+-------------+---------+
id 是该表的主键列(具有唯一值的列)。
该表的每一行包含一封电子邮件。电子邮件将不包含大写字母。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案 <strong>删除</strong> 所有重复的电子邮件，只保留一个具有最小 <code class="language-plaintext highlighter-rouge">id</code> 的唯一电子邮件。</p>

<p>（对于 SQL 用户，请注意你应该编写一个 <code class="language-plaintext highlighter-rouge">DELETE</code> 语句而不是 <code class="language-plaintext highlighter-rouge">SELECT</code> 语句。）</p>

<p>（对于 Pandas 用户，请注意你应该直接修改 <code class="language-plaintext highlighter-rouge">Person</code> 表。）</p>

<p>运行脚本后，显示的答案是 <code class="language-plaintext highlighter-rouge">Person</code> 表。驱动程序将首先编译并运行您的代码片段，然后再显示 <code class="language-plaintext highlighter-rouge">Person</code> 表。<code class="language-plaintext highlighter-rouge">Person</code> 表的最终顺序 <strong>无关紧要</strong> 。</p>

<p>返回结果格式如下示例所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>输入: 
Person 表:
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
| 3  | john@example.com |
+----+------------------+
输出: 
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
+----+------------------+
解释: john@example.com重复两次。我们保留最小的Id = 1。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这题多少有点脱裤子放屁了，就为了强调用<code class="language-plaintext highlighter-rouge">inplace=True</code>，而且用2次 , 用返回值再赋值都不行</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1"># Person 表:
# | id | email       |
# | -- | ----------- |
# | 2  | abc@efg.com |
# | 1  | abc@efg.com |
</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="sh">'</span><span class="s">email</span><span class="sh">'</span><span class="p">:[</span><span class="sh">'</span><span class="s">abc@efg.com</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">abc@efg.com</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">person</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>

<span class="n">person</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
<span class="n">person</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">email</span><span class="sh">'</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="sh">'</span><span class="s">first</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250228143321106.png" alt="image-20250228143321106" style="zoom:50%;" /></p>

<h2 id="1795-每个产品在不同商店的价格">1795. 每个产品在不同商店的价格</h2>

<p><a href="https://leetcode.cn/problems/rearrange-products-table/">1795. 每个产品在不同商店的价格</a></p>

<p>表：<code class="language-plaintext highlighter-rouge">Products</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| product_id  | int     |
| store1      | int     |
| store2      | int     |
| store3      | int     |
+-------------+---------+
在 SQL 中，这张表的主键是 product_id（产品Id）。
每行存储了这一产品在不同商店 store1, store2, store3 的价格。
如果这一产品在商店里没有出售，则值将为 null。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>请你重构 <code class="language-plaintext highlighter-rouge">Products</code> 表，查询每个产品在不同商店的价格，使得输出的格式变为<code class="language-plaintext highlighter-rouge">(product_id, store, price)</code> 。如果这一产品在商店里没有出售，则不输出这一行。</p>

<p>输出结果表中的 <strong>顺序不作要求</strong> 。</p>

<p>查询输出格式请参考下面示例。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>输入：
Products table:
+------------+--------+--------+--------+
| product_id | store1 | store2 | store3 |
+------------+--------+--------+--------+
| 0          | 95     | 100    | 105    |
| 1          | 70     | null   | 80     |
+------------+--------+--------+--------+
输出：
+------------+--------+-------+
| product_id | store  | price |
+------------+--------+-------+
| 0          | store1 | 95    |
| 0          | store2 | 100   |
| 0          | store3 | 105   |
| 1          | store1 | 70    |
| 1          | store3 | 80    |
+------------+--------+-------+
解释：
产品 0 在 store1、store2、store3 的价格分别为 95、100、105。
产品 1 在 store1、store3 的价格分别为 70、80。在 store2 无法买到。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">rearrange_products_table</span><span class="p">(</span><span class="n">products</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df_melted</span> <span class="o">=</span> <span class="n">products</span><span class="p">.</span><span class="nf">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">product_id</span><span class="sh">'</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">store1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">store2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">store3</span><span class="sh">'</span><span class="p">],</span><span class="n">var_name</span><span class="o">=</span><span class="sh">'</span><span class="s">store</span><span class="sh">'</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="sh">'</span><span class="s">price</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_melted</span><span class="p">.</span><span class="nf">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">price</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>关于pandas中重塑的大师—— melt函数，更多的介绍、总结、记忆方法和练习参考博客：<a href="https://kirsten-1.github.io/2025/02/28/%E8%BD%AC%E6%8D%A2%E4%B8%8E%E9%87%8D%E5%A1%91df-melt%E5%87%BD%E6%95%B0/">df长宽变形大师 - melt的重塑神功</a></p>

<hr />

<h1 id="数据统计">数据统计</h1>

<h2 id="2082-富有客户的数量">2082. 富有客户的数量</h2>

<p><a href="https://leetcode.cn/problems/the-number-of-rich-customers/">2082. 富有客户的数量</a></p>

<p>表： <code class="language-plaintext highlighter-rouge">Store</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| bill_id     | int  |
| customer_id | int  |
| amount      | int  |
+-------------+------+
bill_id 是这个表的主键(具有唯一值的列)。
每一行包含一个订单的金额及相关客户的信息。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案找出 <strong>至少有一个</strong> 订单的金额 <strong>严格大于</strong> <code class="language-plaintext highlighter-rouge">500</code> 的客户的数量。</p>

<p>返回结果格式如下示例所示：</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>输入：
Store 表:
+---------+-------------+--------+
| bill_id | customer_id | amount |
+---------+-------------+--------+
| 6       | 1           | 549    |
| 8       | 1           | 834    |
| 4       | 2           | 394    |
| 11      | 3           | 657    |
| 13      | 3           | 257    |
+---------+-------------+--------+
输出： 
+------------+
| rich_count |
+------------+
| 2          |
+------------+
解释：
客户 1 有 2 个订单金额严格大于 500。
客户 2 没有任何订单金额严格大于 500。
客户 3 有 1 个订单金额严格大于 500。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_rich_customers</span><span class="p">(</span><span class="n">store</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">).</span><span class="nf">any</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">store</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">customer_id</span><span class="sh">'</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">rich_count</span><span class="sh">'</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">res</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>可以通过。</p>

<p>官方的答案：</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="n">pandas</span> <span class="n">as</span> <span class="n">pd</span>

<span class="n">def</span> <span class="n">count_rich_customers</span><span class="p">(</span><span class="n">store</span><span class="o">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="o">:</span>
    <span class="n">rich_customers</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="n">store</span><span class="p">[</span><span class="err">'</span><span class="n">amount</span><span class="err">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">]</span>
    
    <span class="n">count</span> <span class="o">=</span> <span class="n">rich_customers</span><span class="p">[</span><span class="err">'</span><span class="n">customer_id</span><span class="err">'</span><span class="p">].</span><span class="n">nunique</span><span class="p">()</span>

    <span class="n">answer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="err">'</span><span class="n">rich_count</span><span class="err">'</span><span class="o">:</span><span class="p">[</span><span class="n">count</span><span class="p">]})</span>

    <span class="k">return</span> <span class="n">answer</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250301145758041.png" alt="image-20250301145758041" style="zoom:50%;" /></p>

<hr />

<p>学到一个新函数：<code class="language-plaintext highlighter-rouge">nunique</code>统计unique的个数的。</p>

<h2 id="1173-即时食物配送-i">1173. 即时食物配送 I</h2>

<p><a href="https://leetcode.cn/problems/immediate-food-delivery-i/">1173. 即时食物配送 I</a></p>

<p>配送表: <code class="language-plaintext highlighter-rouge">Delivery</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+-----------------------------+---------+
| Column Name                 | Type    |
+-----------------------------+---------+
| delivery_id                 | int     |
| customer_id                 | int     |
| order_date                  | date    |
| customer_pref_delivery_date | date    |
+-----------------------------+---------+
delivery_id 是表的主键(具有唯一值的列)。
该表保存着顾客的食物配送信息，顾客在某个日期下了订单，并指定了一个期望的配送日期（和下单日期相同或者在那之后）。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>如果顾客期望的配送日期和下单日期相同，则该订单称为 「即时订单」，否则称为「计划订单」。</p>

<p>编写解决方案统计即时订单所占的百分比， <strong>保留两位小数。</strong></p>

<p>返回结果如下所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>输入：
Delivery 表:
+-------------+-------------+------------+-----------------------------+
| delivery_id | customer_id | order_date | customer_pref_delivery_date |
+-------------+-------------+------------+-----------------------------+
| 1           | 1           | 2019-08-01 | 2019-08-02                  |
| 2           | 5           | 2019-08-02 | 2019-08-02                  |
| 3           | 1           | 2019-08-11 | 2019-08-11                  |
| 4           | 3           | 2019-08-24 | 2019-08-26                  |
| 5           | 4           | 2019-08-21 | 2019-08-22                  |
| 6           | 2           | 2019-08-11 | 2019-08-13                  |
+-------------+-------------+------------+-----------------------------+
输出：
+----------------------+
| immediate_percentage |
+----------------------+
| 33.33                |
+----------------------+
解释：2 和 3 号订单为即时订单，其他的为计划订单。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>本题测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c1"># 数据
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">delivery_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">customer_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2019-08-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-11</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-24</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-21</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-11</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2019-08-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-11</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-26</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-22</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2019-08-13</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># 创建 DataFrame
</span><span class="n">delivery</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># 将日期字符串转换为 datetime 对象
</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">])</span>
<span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">])</span>

<span class="nf">display</span><span class="p">(</span><span class="n">delivery</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">delivery</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span>


<span class="n">rate</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">])</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">delivery</span><span class="p">)</span>
<span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">immediate_percentage</span><span class="sh">'</span><span class="p">:[</span><span class="n">rate</span><span class="p">]})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>我写的答案:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">food_delivery</span><span class="p">(</span><span class="n">delivery</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">delivery</span><span class="p">[</span><span class="sh">'</span><span class="s">customer_pref_delivery_date</span><span class="sh">'</span><span class="p">])</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">delivery</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">immediate_percentage</span><span class="sh">'</span><span class="p">:[</span><span class="nf">round</span><span class="p">(</span><span class="n">rate</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1907-按分类统计薪水">1907. 按分类统计薪水</h2>

<p><a href="https://leetcode.cn/problems/count-salary-categories/">1907. 按分类统计薪水</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Accounts</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+------+
| 列名        | 类型  |
+-------------+------+
| account_id  | int  |
| income      | int  |
+-------------+------+
在 SQL 中，account_id 是这个表的主键。
每一行都包含一个银行帐户的月收入的信息。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询每个工资类别的银行账户数量。 工资类别如下：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">"Low Salary"</code>：所有工资 <strong>严格低于</strong> <code class="language-plaintext highlighter-rouge">20000</code> 美元。</li>
  <li><code class="language-plaintext highlighter-rouge">"Average Salary"</code>： <strong>包含</strong> 范围内的所有工资 <code class="language-plaintext highlighter-rouge">[$20000, $50000]</code> 。</li>
  <li><code class="language-plaintext highlighter-rouge">"High Salary"</code>：所有工资 <strong>严格大于</strong> <code class="language-plaintext highlighter-rouge">50000</code> 美元。</li>
</ul>

<p>结果表 <strong>必须</strong> 包含所有三个类别。 如果某个类别中没有帐户，则报告 <code class="language-plaintext highlighter-rouge">0</code> 。</p>

<p>按 <strong>任意顺序</strong> 返回结果表。</p>

<p>查询结果格式如下示例。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>输入：
Accounts 表:
+------------+--------+
| account_id | income |
+------------+--------+
| 3          | 108939 |
| 2          | 12747  |
| 8          | 87709  |
| 6          | 91796  |
+------------+--------+
输出：
+----------------+----------------+
| category       | accounts_count |
+----------------+----------------+
| Low Salary     | 1              |
| Average Salary | 0              |
| High Salary    | 3              |
+----------------+----------------+
解释：
低薪: 有一个账户 2.
中等薪水: 没有.
高薪: 有三个账户，他们是 3, 6和 8.
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1"># 数据
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">account_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">108939</span><span class="p">,</span> <span class="mi">12747</span><span class="p">,</span> <span class="mi">87709</span><span class="p">,</span> <span class="mi">91796</span><span class="p">]</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_salary_categories</span><span class="p">(</span><span class="n">accounts</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">(</span><span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">20000</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">((</span><span class="mi">20000</span> <span class="o">&lt;=</span> <span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">50000</span><span class="p">)).</span><span class="nf">sum</span><span class="p">()</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">accounts</span><span class="p">[</span><span class="sh">'</span><span class="s">income</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">:[</span><span class="sh">'</span><span class="s">Low Salary</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Average Salary</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">High Salary</span><span class="sh">'</span><span class="p">],</span> <span class="sh">'</span><span class="s">accounts_count</span><span class="sh">'</span><span class="p">:[</span><span class="n">l</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">h</span><span class="p">]})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>答案和我写的类似。</p>

<h1 id="测验题-1">测验题</h1>

<h2 id="1322-广告效果">1322. 广告效果</h2>

<p><a href="https://leetcode.cn/problems/ads-performance/">1322. 广告效果</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Ads</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| ad_id         | int     |
| user_id       | int     |
| action        | enum    |
+---------------+---------+
(ad_id, user_id) 是该表的主键(具有唯一值的列的组合)
该表的每一行包含一条广告的 ID(ad_id)，用户的 ID(user_id) 和用户对广告采取的行为 (action)
action 列是一个枚举类型 ('Clicked', 'Viewed', 'Ignored') 。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>一家公司正在运营这些广告并想计算每条广告的效果。</p>

<p>广告效果用点击通过率（Click-Through Rate：CTR）来衡量，公式如下:</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/sql1.png" alt="image-20250301161341752" /></p>

<p>编写解决方案找出每一条广告的 <code class="language-plaintext highlighter-rouge">ctr</code> ，<code class="language-plaintext highlighter-rouge">ctr</code> 要 <strong>保留两位小数</strong> 。</p>

<p>返回结果需要按 <code class="language-plaintext highlighter-rouge">ctr</code> <strong>降序</strong>、按 <code class="language-plaintext highlighter-rouge">ad_id</code> <strong>升序</strong> 进行排序。</p>

<p>返回结果示例如下：</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>输入：
Ads 表:
+-------+---------+---------+
| ad_id | user_id | action  |
+-------+---------+---------+
| 1     | 1       | Clicked |
| 2     | 2       | Clicked |
| 3     | 3       | Viewed  |
| 5     | 5       | Ignored |
| 1     | 7       | Ignored |
| 2     | 7       | Viewed  |
| 3     | 5       | Clicked |
| 1     | 4       | Viewed  |
| 2     | 11      | Viewed  |
| 1     | 2       | Clicked |
+-------+---------+---------+
输出：
+-------+-------+
| ad_id | ctr   |
+-------+-------+
| 1     | 66.67 |
| 3     | 50.00 |
| 2     | 33.33 |
| 5     | 0.00  |
+-------+-------+
解释：
对于 ad_id = 1, ctr = (2/(2+1)) * 100 = 66.67
对于 ad_id = 2, ctr = (1/(1+2)) * 100 = 33.33
对于 ad_id = 3, ctr = (1/(1+1)) * 100 = 50.00
对于 ad_id = 5, ctr = 0.00, 注意 ad_id = 5 没有被点击 (Clicked) 或查看 (Viewed) 过
注意我们不关心 action 为 Ingnored 的广告
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ignored</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ignored</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：（时间复杂度略大）：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">ads_performance</span><span class="p">(</span><span class="n">ads</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">ad_id</span> <span class="o">=</span> <span class="n">ads</span><span class="p">[</span><span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ad_id</span><span class="p">:</span>
        <span class="n">ads_i</span> <span class="o">=</span> <span class="n">ads</span><span class="p">[</span><span class="n">ads</span><span class="p">[</span><span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="nb">id</span><span class="p">]</span>
        <span class="n">clicked</span> <span class="o">=</span> <span class="p">(</span><span class="n">ads_i</span><span class="p">[</span><span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Clicked</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
        <span class="n">viewed</span> <span class="o">=</span> <span class="p">(</span><span class="n">ads_i</span><span class="p">[</span><span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Viewed</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
        <span class="n">ctr</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">clicked</span> <span class="o">+</span> <span class="n">viewed</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nf">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">clicked</span><span class="o">/</span><span class="p">(</span><span class="n">clicked</span> <span class="o">+</span> <span class="n">viewed</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>   
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">:</span><span class="n">ad_id</span><span class="p">,</span> <span class="sh">'</span><span class="s">ctr</span><span class="sh">'</span><span class="p">:</span><span class="n">ctr</span><span class="p">}).</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">ctr</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ad_id</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="数据分组">数据分组</h1>

<h2 id="1741-查找每个员工花费的总时间">1741. 查找每个员工花费的总时间</h2>

<p><a href="https://leetcode.cn/problems/find-total-time-spent-by-each-employee/">1741. 查找每个员工花费的总时间</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Employees</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| emp_id      | int  |
| event_day   | date |
| in_time     | int  |
| out_time    | int  |
+-------------+------+
在 SQL 中，(emp_id, event_day, in_time) 是这个表的主键。
该表显示了员工在办公室的出入情况。
event_day 是此事件发生的日期，in_time 是员工进入办公室的时间，而 out_time 是他们离开办公室的时间。
in_time 和 out_time 的取值在1到1440之间。
题目保证同一天没有两个事件在时间上是相交的，并且保证 in_time 小于 out_time。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>计算每位员工每天在办公室花费的总时间（以分钟为单位）。 请注意，在一天之内，同一员工是可以多次进入和离开办公室的。 在办公室里一次进出所花费的时间为out_time 减去 in_time。</p>

<p>返回结果表单的顺序无要求。
查询结果的格式如下：</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>输入：
Employees table:
+--------+------------+---------+----------+
| emp_id | event_day  | in_time | out_time |
+--------+------------+---------+----------+
| 1      | 2020-11-28 | 4       | 32       |
| 1      | 2020-11-28 | 55      | 200      |
| 1      | 2020-12-03 | 1       | 42       |
| 2      | 2020-11-28 | 3       | 33       |
| 2      | 2020-12-09 | 47      | 74       |
+--------+------------+---------+----------+
输出：
+------------+--------+------------+
| day        | emp_id | total_time |
+------------+--------+------------+
| 2020-11-28 | 1      | 173        |
| 2020-11-28 | 2      | 30         |
| 2020-12-03 | 1      | 41         |
| 2020-12-09 | 2      | 27         |
+------------+--------+------------+
解释：
雇员 1 有三次进出: 有两次发生在 2020-11-28 花费的时间为 (32 - 4) + (200 - 55) = 173, 有一次发生在 2020-12-03 花费的时间为 (42 - 1) = 41。
雇员 2 有两次进出: 有一次发生在 2020-11-28 花费的时间为 (33 - 3) = 30,  有一次发生在 2020-12-09 花费的时间为 (74 - 47) = 27。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2020-11-28</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-11-28</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-03</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-11-28</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-09</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">in_time</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">47</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">out_time</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">74</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">total_time</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">total</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">out_time</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">in_time</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">employees</span><span class="p">[</span><span class="sh">'</span><span class="s">total_time</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">])[</span><span class="sh">'</span><span class="s">total</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">sum</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">])</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">event_day</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">day</span><span class="sh">'</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">day</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">emp_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">total_time</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>官方答案有一个函数<code class="language-plaintext highlighter-rouge">reset_index</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># 示例 DataFrame
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">col1</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">col2</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">])</span>  <span class="c1"># 使用自定义索引
</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">原始 DataFrame:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="c1"># 使用 reset_index()
</span><span class="n">df_reset</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">reset_index</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">重置索引后的 DataFrame:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_reset</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250301171532540.png" alt="image-20250301171532540" style="zoom:50%;" /></p>

<h2 id="511-游戏玩法分析-i">511. 游戏玩法分析 I</h2>

<p><a href="https://leetcode.cn/problems/game-play-analysis-i/">511. 游戏玩法分析 I</a></p>

<p>活动表 <code class="language-plaintext highlighter-rouge">Activity</code>：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| player_id    | int     |
| device_id    | int     |
| event_date   | date    |
| games_played | int     |
+--------------+---------+
在 SQL 中，表的主键是 (player_id, event_date)。
这张表展示了一些游戏玩家在游戏平台上的行为活动。
每行数据记录了一名玩家在退出平台之前，当天使用同一台设备登录平台后打开的游戏的数目（可能是 0 个）。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询每位玩家 <strong>第一次登录平台的日期</strong>。</p>

<p>查询结果的格式如下所示：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>Activity 表：
+-----------+-----------+------------+--------------+
| player_id | device_id | event_date | games_played |
+-----------+-----------+------------+--------------+
| 1         | 2         | 2016-03-01 | 5            |
| 1         | 2         | 2016-05-02 | 6            |
| 2         | 3         | 2017-06-25 | 1            |
| 3         | 1         | 2016-03-02 | 0            |
| 3         | 4         | 2018-07-03 | 5            |
+-----------+-----------+------------+--------------+

Result 表：
+-----------+-------------+
| player_id | first_login |
+-----------+-------------+
| 1         | 2016-03-01  |
| 2         | 2017-06-25  |
| 3         | 2016-03-02  |
+-----------+-------------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">device_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2016-03-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2016-05-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2017-06-25</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2016-03-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2018-07-03</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">games_played</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">device_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2016-03-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2016-02-03</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">games_played</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>不知道我写的有什么问题，碰到力扣一个贼长的测试用例，懒得查为什么了。。。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">game_analysis</span><span class="p">(</span><span class="n">activity</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">activity</span><span class="p">[</span><span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">activity</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">].</span><span class="nf">transform</span><span class="p">(</span><span class="sh">'</span><span class="s">min</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">activity</span> <span class="o">=</span> <span class="n">activity</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">activity</span><span class="p">[[</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>官方答案是：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">game_analysis</span><span class="p">(</span><span class="n">activity</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">activity</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">player_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">].</span><span class="nf">min</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">event_date</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">first_login</span><span class="sh">'</span><span class="p">})</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>和我写的差不多，但是有<code class="language-plaintext highlighter-rouge">reset_index()</code></p>

<p>GPT说这两段代码会返回相同的结果，即一个 DataFrame，其中包含每个 player_id 及其对应的最早登录日期。</p>

<hr />

<h2 id="2356-每位教师所教授的科目种类的数量">2356. 每位教师所教授的科目种类的数量</h2>

<p><a href="https://leetcode.cn/problems/number-of-unique-subjects-taught-by-each-teacher/">2356. 每位教师所教授的科目种类的数量</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Teacher</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| teacher_id  | int  |
| subject_id  | int  |
| dept_id     | int  |
+-------------+------+
在 SQL 中，(subject_id, dept_id) 是该表的主键。
该表中的每一行都表示带有 teacher_id 的教师在系 dept_id 中教授科目 subject_id。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询每位老师在大学里教授的科目种类的数量。</p>

<p>以 <strong>任意顺序</strong> 返回结果表。</p>

<p>查询结果格式示例如下。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>输入: 
Teacher 表:
+------------+------------+---------+
| teacher_id | subject_id | dept_id |
+------------+------------+---------+
| 1          | 2          | 3       |
| 1          | 2          | 4       |
| 1          | 3          | 3       |
| 2          | 1          | 1       |
| 2          | 2          | 1       |
| 2          | 3          | 1       |
| 2          | 4          | 1       |
+------------+------------+---------+
输出:  
+------------+-----+
| teacher_id | cnt |
+------------+-----+
| 1          | 2   |
| 2          | 4   |
+------------+-----+
解释: 
教师 1:
  - 他在 3、4 系教科目 2。
  - 他在 3 系教科目 3。
教师 2:
  - 他在 1 系教科目 1。
  - 他在 1 系教科目 2。
  - 他在 1 系教科目 3。
  - 他在 1 系教科目 4。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">dept_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>

<span class="n">teacher</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">teacher</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这题我写的比较顺利：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_unique_subjects</span><span class="p">(</span><span class="n">teacher</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">teacher</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span>  <span class="c1"># .str.len() 方法来获取每个列表中元素的数量。
</span>    <span class="k">return</span> <span class="n">sub</span><span class="p">[[</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>补充：<code class="language-plaintext highlighter-rouge">reset_index() </code>在这段代码中的作用至关重要，它影响着 groupby 操作的结果以及后续计算列表长度的方式。</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">teacher.groupby('teacher_id')['subject_id'].unique()</code></strong>: 这一步按 <code class="language-plaintext highlighter-rouge">teacher_id </code>分组，并获取每个教师对应的唯一 <code class="language-plaintext highlighter-rouge">subject_id </code>列表。 结果是一个 Series，其中 teacher_id 是索引。</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">.reset_index()</code></strong>: <strong>关键作用：</strong><code class="language-plaintext highlighter-rouge"> reset_index() </code>将索引 <code class="language-plaintext highlighter-rouge">teacher_id </code>转换为 DataFrame 的一个普通列。 这会将 Series 转换为 DataFrame，其中包含两列：<code class="language-plaintext highlighter-rouge">teacher_id </code>和 <code class="language-plaintext highlighter-rouge">subject_id</code>（包含唯一科目列表）。 这样做的目的是让 <code class="language-plaintext highlighter-rouge">teacher_id </code>成为一个可以操作的列，而不是索引。</p>
  </li>
</ul>

<p>如果没有 <code class="language-plaintext highlighter-rouge">reset_index()</code>，sub 仍然是一个 Series，其中 <code class="language-plaintext highlighter-rouge">teacher_id</code> 是索引，而包含唯一科目列表是 Series 的值。</p>

<p>因为sub是Series，所以要先使用<code class="language-plaintext highlighter-rouge">to_frame()</code>函数转换为Dataframe，索引会默认成为Dataframe的索引</p>

<p>所以也可以写成：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">count_unique_subjects</span><span class="p">(</span><span class="n">teacher</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">teacher</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>  <span class="c1"># 去掉reset_index()
</span>    <span class="n">sub</span> <span class="o">=</span> <span class="n">sub</span><span class="p">.</span><span class="nf">to_frame</span><span class="p">()</span>  <span class="c1"># 将 Series 转换为 DataFrame, 索引成为DataFrame的索引
</span>    <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="sh">'</span><span class="s">subject_id</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span>  <span class="c1"># .str.len() 方法来获取每个列表中元素的数量。
</span>    <span class="k">return</span> <span class="n">sub</span><span class="p">.</span><span class="nf">rename_axis</span><span class="p">(</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">).</span><span class="nf">reset_index</span><span class="p">()[[</span><span class="sh">'</span><span class="s">teacher_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cnt</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>最终还是要再用<code class="language-plaintext highlighter-rouge">reset_index()</code>转换为列。</p>

<hr />

<h2 id="596-超过-5-名学生的课">596. 超过 5 名学生的课</h2>

<p><a href="https://leetcode.cn/problems/classes-more-than-5-students/">596. 超过 5 名学生的课</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Courses</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| student     | varchar |
| class       | varchar |
+-------------+---------+
(student, class)是该表的主键（不同值的列的组合）。
该表的每一行表示学生的名字和他们注册的班级。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询 <strong>至少有 5 个学生</strong> 的所有班级。</p>

<p>以 <strong>任意顺序</strong> 返回结果表。</p>

<p>结果格式如下所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>输入: 
Courses table:
+---------+----------+
| student | class    |
+---------+----------+
| A       | Math     |
| B       | English  |
| C       | Math     |
| D       | Biology  |
| E       | Math     |
| F       | Computer |
| G       | Math     |
| H       | Math     |
| I       | Math     |
+---------+----------+
输出: 
+---------+ 
| class   | 
+---------+ 
| Math    | 
+---------+
解释: 
-数学课有 6 个学生，所以我们包括它。
-英语课有 1 名学生，所以我们不包括它。
-生物课有 1 名学生，所以我们不包括它。
-计算机课有 1 个学生，所以我们不包括它。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">student</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">G</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">H</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">I</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">class</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">English</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Biology</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Computer</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这题经过前面这么多题目的训练，变得非常简单了：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_classes</span><span class="p">(</span><span class="n">courses</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">courses</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">class</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">student</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span> <span class="p">.</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">student</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">][[</span><span class="sh">'</span><span class="s">class</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="586-订单最多的客户">586. 订单最多的客户</h2>

<p><a href="https://leetcode.cn/problems/customer-placing-the-largest-number-of-orders/">586. 订单最多的客户</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Orders</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-----------------+----------+
| Column Name     | Type     |
+-----------------+----------+
| order_number    | int      |
| customer_number | int      |
+-----------------+----------+
在 SQL 中，Order_number是该表的主键。
此表包含关于订单ID和客户ID的信息。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查找下了 <strong>最多订单</strong> 的客户的 <code class="language-plaintext highlighter-rouge">customer_number</code> 。</p>

<p>测试用例生成后， <strong>恰好有一个客户</strong> 比任何其他客户下了更多的订单。</p>

<p>查询结果格式如下所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>输入: 
Orders 表:
+--------------+-----------------+
| order_number | customer_number |
+--------------+-----------------+
| 1            | 1               |
| 2            | 2               |
| 3            | 3               |
| 4            | 3               |
+--------------+-----------------+
输出: 
+-----------------+
| customer_number |
+-----------------+
| 3               |
+-----------------+
解释: 
customer_number 为 '3' 的顾客有两个订单，比顾客 '1' 或者 '2' 都要多，因为他们只有一个订单。
所以结果是该顾客的 customer_number ，也就是 3 。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">customer_number</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">largest_orders</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">customer_number</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">].</span><span class="nf">max</span><span class="p">()</span> <span class="o">==</span> <span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">order_number</span><span class="sh">'</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">customer_number</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p><strong>进阶：</strong> 如果有多位顾客订单数并列最多，你能找到他们所有的 <code class="language-plaintext highlighter-rouge">customer_number</code> 吗？</p>

<p>用我上面的解法也没问题啊：</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250302104618377.png" alt="image-20250302104618377" style="zoom:50%;" /></p>

<h2 id="1484-按日期分组销售产品">1484. 按日期分组销售产品</h2>

<p><a href="https://leetcode.cn/problems/group-sold-products-by-the-date/">1484. 按日期分组销售产品</a></p>

<p>表 <code class="language-plaintext highlighter-rouge">Activities</code>：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| 列名         | 类型    |
+-------------+---------+
| sell_date   | date    |
| product     | varchar |
+-------------+---------+
该表没有主键(具有唯一值的列)。它可能包含重复项。
此表的每一行都包含产品名称和在市场上销售的日期。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案找出每个日期、销售的不同产品的数量及其名称。
每个日期的销售产品名称应按词典序排列。
返回按 <code class="language-plaintext highlighter-rouge">sell_date</code> 排序的结果表。
结果表结果格式如下例所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>输入：
Activities 表：
+------------+-------------+
| sell_date  | product     |
+------------+-------------+
| 2020-05-30 | Headphone   |
| 2020-06-01 | Pencil      |
| 2020-06-02 | Mask        |
| 2020-05-30 | Basketball  |
| 2020-06-01 | Bible       |
| 2020-06-02 | Mask        |
| 2020-05-30 | T-Shirt     |
+------------+-------------+
输出：
+------------+----------+------------------------------+
| sell_date  | num_sold | products                     |
+------------+----------+------------------------------+
| 2020-05-30 | 3        | Basketball,Headphone,T-shirt |
| 2020-06-01 | 2        | Bible,Pencil                 |
| 2020-06-02 | 1        | Mask                         |
+------------+----------+------------------------------+
解释：
对于2020-05-30，出售的物品是 (Headphone, Basketball, T-shirt)，按词典序排列，并用逗号 ',' 分隔。
对于2020-06-01，出售的物品是 (Pencil, Bible)，按词典序排列，并用逗号分隔。
对于2020-06-02，出售的物品是 (Mask)，只需返回该物品名。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">sell_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2020-05-30</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-05-30</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-06-02</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-05-30</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">product</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Headphone</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pencil</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mask</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Basketball</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bible</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mask</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">T-Shirt</span><span class="sh">'</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这道题的类型我还没有结束过。用了gpt，下面的写法太强了：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">categorize_products</span><span class="p">(</span><span class="n">activities</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">activities</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">sell_date</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">product</span><span class="sh">'</span><span class="p">].</span><span class="nf">agg</span><span class="p">([</span><span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nf">unique</span><span class="p">()))]).</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">num_sold</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">&lt;lambda_0&gt;</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">products</span><span class="sh">'</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1693-每天的领导和合伙人">1693. 每天的领导和合伙人</h2>

<p><a href="https://leetcode.cn/problems/daily-leads-and-partners/">1693. 每天的领导和合伙人</a></p>

<p>表：<code class="language-plaintext highlighter-rouge">DailySales</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| date_id     | date    |
| make_name   | varchar |
| lead_id     | int     |
| partner_id  | int     |
+-------------+---------+
该表没有主键(具有唯一值的列)。它可能包含重复项。
该表包含日期、产品的名称，以及售给的领导和合伙人的编号。
名称只包含小写英文字母。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>对于每一个 <code class="language-plaintext highlighter-rouge">date_id</code> 和 <code class="language-plaintext highlighter-rouge">make_name</code>，找出 <strong>不同</strong> 的 <code class="language-plaintext highlighter-rouge">lead_id</code> 以及 <strong>不同</strong> 的 <code class="language-plaintext highlighter-rouge">partner_id</code> 的数量。</p>

<p>按 <strong>任意顺序</strong> 返回结果表。</p>

<p>返回结果格式如下示例所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>输入：
DailySales 表：
+-----------+-----------+---------+------------+
| date_id   | make_name | lead_id | partner_id |
+-----------+-----------+---------+------------+
| 2020-12-8 | toyota    | 0       | 1          |
| 2020-12-8 | toyota    | 1       | 0          |
| 2020-12-8 | toyota    | 1       | 2          |
| 2020-12-7 | toyota    | 0       | 2          |
| 2020-12-7 | toyota    | 0       | 1          |
| 2020-12-8 | honda     | 1       | 2          |
| 2020-12-8 | honda     | 2       | 1          |
| 2020-12-7 | honda     | 0       | 1          |
| 2020-12-7 | honda     | 1       | 2          |
| 2020-12-7 | honda     | 2       | 1          |
+-----------+-----------+---------+------------+
输出：
+-----------+-----------+--------------+-----------------+
| date_id   | make_name | unique_leads | unique_partners |
+-----------+-----------+--------------+-----------------+
| 2020-12-8 | toyota    | 2            | 3               |
| 2020-12-7 | toyota    | 1            | 2               |
| 2020-12-8 | honda     | 2            | 2               |
| 2020-12-7 | honda     | 3            | 2               |
+-----------+-----------+--------------+-----------------+
解释：
在 2020-12-8，丰田（toyota）有领导者 = [0, 1] 和合伙人 = [0, 1, 2] ，同时本田（honda）有领导者 = [1, 2] 和合伙人 = [1, 2]。
在 2020-12-7，丰田（toyota）有领导者 = [0] 和合伙人 = [1, 2] ，同时本田（honda）有领导者 = [0, 1, 2] 和合伙人 = [1, 2]。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">date_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2020-12-7</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">make_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">toyota</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">honda</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">lead_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">partner_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>通过这道题可以领略agg函数的强大：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">daily_leads_and_partners</span><span class="p">(</span><span class="n">daily_sales</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">daily_sales</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">date_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">make_name</span><span class="sh">'</span><span class="p">]).</span><span class="nf">agg</span><span class="p">(</span>
        <span class="n">unique_leads</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">lead_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">),</span>
        <span class="n">unique_partners</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">partner_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">reset_index</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="数据合并">数据合并</h1>

<h2 id="1050-合作过至少三次的演员和导演">1050. 合作过至少三次的演员和导演</h2>

<p><a href="https://leetcode.cn/problems/actors-and-directors-who-cooperated-at-least-three-times/">1050. 合作过至少三次的演员和导演</a></p>

<p><code class="language-plaintext highlighter-rouge">ActorDirector</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| actor_id    | int     |
| director_id | int     |
| timestamp   | int     |
+-------------+---------+
timestamp 是这张表的主键(具有唯一值的列).
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案找出合作过至少三次的演员和导演的 id 对 <code class="language-plaintext highlighter-rouge">(actor_id, director_id)</code></p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>输入：
ActorDirector 表：
+-------------+-------------+-------------+
| actor_id    | director_id | timestamp   |
+-------------+-------------+-------------+
| 1           | 1           | 0           |
| 1           | 1           | 1           |
| 1           | 1           | 2           |
| 1           | 2           | 3           |
| 1           | 2           | 4           |
| 2           | 1           | 5           |
| 2           | 1           | 6           |
+-------------+-------------+-------------+
输出：
+-------------+-------------+
| actor_id    | director_id |
+-------------+-------------+
| 1           | 1           |
+-------------+-------------+
解释：
唯一的 id 对是 (1, 1)，他们恰好合作了 3 次。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">actor_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">director_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这题比较简单，我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">actors_and_directors</span><span class="p">(</span><span class="n">actor_director</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">actor_director</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">actor_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">director_id</span><span class="sh">'</span><span class="p">])[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">grouped</span><span class="p">[</span><span class="n">grouped</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span><span class="mi">3</span><span class="p">][[</span><span class="sh">'</span><span class="s">actor_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">director_id</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="1378-使用唯一标识码替换员工id">1378. 使用唯一标识码替换员工ID</h2>

<p><a href="https://leetcode.cn/problems/replace-employee-id-with-the-unique-identifier/">1378. 使用唯一标识码替换员工ID</a></p>

<p><code class="language-plaintext highlighter-rouge">Employees</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| name          | varchar |
+---------------+---------+
在 SQL 中，id 是这张表的主键。
这张表的每一行分别代表了某公司其中一位员工的名字和 ID 。
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">EmployeeUNI</code> 表：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| unique_id     | int     |
+---------------+---------+
在 SQL 中，(id, unique_id) 是这张表的主键。
这张表的每一行包含了该公司某位员工的 ID 和他的唯一标识码（unique ID）。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>展示每位用户的 <strong>唯一标识码（unique ID ）</strong>；如果某位员工没有唯一标识码，使用 null 填充即可。</p>

<p>你可以以 <strong>任意</strong> 顺序返回结果表。</p>

<p>返回结果的格式如下例所示。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre>输入：
Employees 表:
+----+----------+
| id | name     |
+----+----------+
| 1  | Alice    |
| 7  | Bob      |
| 11 | Meir     |
| 90 | Winston  |
| 3  | Jonathan |
+----+----------+
EmployeeUNI 表:
+----+-----------+
| id | unique_id |
+----+-----------+
| 3  | 1         |
| 11 | 2         |
| 90 | 3         |
+----+-----------+
输出：
+-----------+----------+
| unique_id | name     |
+-----------+----------+
| null      | Alice    |
| null      | Bob      |
| 2         | Meir     |
| 3         | Winston  |
| 1         | Jonathan |
+-----------+----------+
解释：
Alice and Bob 没有唯一标识码, 因此我们使用 null 替代。
Meir 的唯一标识码是 2 。
Winston 的唯一标识码是 3 。
Jonathan 唯一标识码是 1 。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                  <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Alice</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bob</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Meir</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Winston</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Jonathan</span><span class="sh">'</span><span class="p">]}</span>

<span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
                     <span class="sh">'</span><span class="s">unique_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>这题非常简单啊，一个merge搞定（注意how值是left）</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">replace_employee_id</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">employee_uni</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">employee_uni</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)[[</span><span class="sh">'</span><span class="s">unique_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="1280-学生们参加各科测试的次数">1280. 学生们参加各科测试的次数</h2>

<p><a href="https://leetcode.cn/problems/students-and-examinations/">1280. 学生们参加各科测试的次数</a></p>

<p>学生表: <code class="language-plaintext highlighter-rouge">Students</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| student_id    | int     |
| student_name  | varchar |
+---------------+---------+
在 SQL 中，主键为 student_id（学生ID）。
该表内的每一行都记录有学校一名学生的信息。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>科目表: <code class="language-plaintext highlighter-rouge">Subjects</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| subject_name | varchar |
+--------------+---------+
在 SQL 中，主键为 subject_name（科目名称）。
每一行记录学校的一门科目名称。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>考试表: <code class="language-plaintext highlighter-rouge">Examinations</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| student_id   | int     |
| subject_name | varchar |
+--------------+---------+
这个表可能包含重复数据（换句话说，在 SQL 中，这个表没有主键）。
学生表里的一个学生修读科目表里的每一门科目。
这张考试表的每一行记录就表示学生表里的某个学生参加了一次科目表里某门科目的测试。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查询出每个学生参加每一门科目测试的次数，结果按 <code class="language-plaintext highlighter-rouge">student_id</code> 和 <code class="language-plaintext highlighter-rouge">subject_name</code> 排序。</p>

<p>查询结构格式如下所示。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre>输入：
Students table:
+------------+--------------+
| student_id | student_name |
+------------+--------------+
| 1          | Alice        |
| 2          | Bob          |
| 13         | John         |
| 6          | Alex         |
+------------+--------------+
Subjects table:
+--------------+
| subject_name |
+--------------+
| Math         |
| Physics      |
| Programming  |
+--------------+
Examinations table:
+------------+--------------+
| student_id | subject_name |
+------------+--------------+
| 1          | Math         |
| 1          | Physics      |
| 1          | Programming  |
| 2          | Programming  |
| 1          | Physics      |
| 1          | Math         |
| 13         | Math         |
| 13         | Programming  |
| 13         | Physics      |
| 2          | Math         |
| 1          | Math         |
+------------+--------------+
输出：
+------------+--------------+--------------+----------------+
| student_id | student_name | subject_name | attended_exams |
+------------+--------------+--------------+----------------+
| 1          | Alice        | Math         | 3              |
| 1          | Alice        | Physics      | 2              |
| 1          | Alice        | Programming  | 1              |
| 2          | Bob          | Math         | 1              |
| 2          | Bob          | Physics      | 0              |
| 2          | Bob          | Programming  | 1              |
| 6          | Alex         | Math         | 0              |
| 6          | Alex         | Physics      | 0              |
| 6          | Alex         | Programming  | 0              |
| 13         | John         | Math         | 1              |
| 13         | John         | Physics      | 1              |
| 13         | John         | Programming  | 1              |
+------------+--------------+--------------+----------------+
解释：
结果表需包含所有学生和所有科目（即便测试次数为0）：
Alice 参加了 3 次数学测试, 2 次物理测试，以及 1 次编程测试；
Bob 参加了 1 次数学测试, 1 次编程测试，没有参加物理测试；
Alex 啥测试都没参加；
John  参加了数学、物理、编程测试各 1 次。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">students_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                 <span class="sh">'</span><span class="s">student_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Alice</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bob</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">John</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Alex</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">subjects_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">]}</span>
<span class="n">examinations_data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                     <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Programming</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Physics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Math</span><span class="sh">'</span><span class="p">]}</span>



<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">students_data</span><span class="p">)</span>
<span class="n">subjects</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">subjects_data</span><span class="p">)</span>
<span class="n">examinations</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">examinations_data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">students</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">subjects</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">examinations</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>要完成这道题要首先掌握<strong>笛卡尔积</strong>：计算所有可能的元素对的乘积</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">students</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">subjects</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">subjects</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250302221843742.png" alt="image-20250302221843742" style="zoom:50%;" /></p>

<p>这样就有了输出的雏形。</p>

<hr />

<p>这道题，还有很多小细节要注意。可以边写边测试，有了结果提交发现不通过 也可以再调试。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">students_and_examinations</span><span class="p">(</span><span class="n">students</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">subjects</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">examinations</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">students</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">subjects</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">subjects</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">count_examinations</span> <span class="o">=</span> <span class="n">examinations</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">]).</span><span class="nf">size</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">count_examinations</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[[</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">student_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">attended_exams</span><span class="sh">'</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">student_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">subject_name</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>注：</p>

<p>1.size()和count()</p>

<p>2.某一列的值（含NaN）赋值：<code class="language-plaintext highlighter-rouge">res['attended_exams'] = res['attended_exams'].fillna(0)</code>， 因为名字这一列可能出现null，不可被覆盖，所以只对一列进行nan的填充。</p>

<p>3.<code class="language-plaintext highlighter-rouge">reset_index(name='attended_exams')</code>，groupby后统计的结果赋值给某一列，给那一列取个新名字</p>

<p>4.笛卡尔积：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>    <span class="n">students</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">subjects</span><span class="p">[</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">subjects</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">key</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="570-至少有5名直接下属的经理">570. 至少有5名直接下属的经理</h2>

<p><a href="https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/">570. 至少有5名直接下属的经理</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">Employee</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| name        | varchar |
| department  | varchar |
| managerId   | int     |
+-------------+---------+
id 是此表的主键（具有唯一值的列）。
该表的每一行表示雇员的名字、他们的部门和他们的经理的id。
如果managerId为空，则该员工没有经理。
没有员工会成为自己的管理者。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写一个解决方案，找出至少有<strong>五个直接下属</strong>的经理。</p>

<p>以 <strong>任意顺序</strong> 返回结果表。</p>

<p>查询结果格式如下所示。</p>

<p><strong>示例 1:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>输入: 
Employee 表:
+-----+-------+------------+-----------+
| id  | name  | department | managerId |
+-----+-------+------------+-----------+
| 101 | John  | A          | Null      |
| 102 | Dan   | A          | 101       |
| 103 | James | A          | 101       |
| 104 | Amy   | A          | 101       |
| 105 | Anne  | A          | 101       |
| 106 | Ron   | B          | 101       |
+-----+-------+------------+-----------+
输出: 
+------+
| name |
+------+
| John |
+------+
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">employee_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">John</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Dan</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">James</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Amy</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Anne</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ron</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">department</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">managerId</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>  <span class="c1"># 使用 np.nan 表示 Null
</span><span class="p">}</span>

<span class="n">employee</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">employee_data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">employee</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">find_managers</span><span class="p">(</span><span class="n">employee</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">count_managerId</span> <span class="o">=</span> <span class="n">employee</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">managerId</span><span class="sh">'</span><span class="p">).</span><span class="nf">size</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">count_e</span><span class="sh">'</span><span class="p">).</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">managerId</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">})</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">employee</span><span class="p">,</span> <span class="n">count_managerId</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">count_e</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="607-销售员">607. 销售员</h2>

<p><a href="https://leetcode.cn/problems/sales-person/">607. 销售员</a></p>

<p>表: <code class="language-plaintext highlighter-rouge">SalesPerson</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>+-----------------+---------+
| Column Name     | Type    |
+-----------------+---------+
| sales_id        | int     |
| name            | varchar |
| salary          | int     |
| commission_rate | int     |
| hire_date       | date    |
+-----------------+---------+
sales_id 是该表的主键列(具有唯一值的列)。
该表的每一行都显示了销售人员的姓名和 ID ，以及他们的工资、佣金率和雇佣日期。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>表: <code class="language-plaintext highlighter-rouge">Company</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| com_id      | int     |
| name        | varchar |
| city        | varchar |
+-------------+---------+
com_id 是该表的主键列(具有唯一值的列)。
该表的每一行都表示公司的名称和 ID ，以及公司所在的城市。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>表: <code class="language-plaintext highlighter-rouge">Orders</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| order_id    | int  |
| order_date  | date |
| com_id      | int  |
| sales_id    | int  |
| amount      | int  |
+-------------+------+
order_id 是该表的主键列(具有唯一值的列)。
com_id 是 Company 表中 com_id 的外键（reference 列）。
sales_id 是来自销售员表 sales_id 的外键（reference 列）。
该表的每一行包含一个订单的信息。这包括公司的 ID 、销售人员的 ID 、订单日期和支付的金额。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案，找出没有任何与名为 <strong>“RED”</strong> 的公司相关的订单的所有销售人员的姓名。</p>

<p>以 <strong>任意顺序</strong> 返回结果表。</p>

<p>返回结果格式如下所示。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre>输入：
SalesPerson 表:
+----------+------+--------+-----------------+------------+
| sales_id | name | salary | commission_rate | hire_date  |
+----------+------+--------+-----------------+------------+
| 1        | John | 100000 | 6               | 4/1/2006   |
| 2        | Amy  | 12000  | 5               | 5/1/2010   |
| 3        | Mark | 65000  | 12              | 12/25/2008 |
| 4        | Pam  | 25000  | 25              | 1/1/2005   |
| 5        | Alex | 5000   | 10              | 2/3/2007   |
+----------+------+--------+-----------------+------------+
Company 表:
+--------+--------+----------+
| com_id | name   | city     |
+--------+--------+----------+
| 1      | RED    | Boston   |
| 2      | ORANGE | New York |
| 3      | YELLOW | Boston   |
| 4      | GREEN  | Austin   |
+--------+--------+----------+
Orders 表:
+----------+------------+--------+----------+--------+
| order_id | order_date | com_id | sales_id | amount |
+----------+------------+--------+----------+--------+
| 1        | 1/1/2014   | 3      | 4        | 10000  |
| 2        | 2/1/2014   | 4      | 5        | 5000   |
| 3        | 3/1/2014   | 1      | 1        | 50000  |
| 4        | 4/1/2014   | 1      | 4        | 25000  |
+----------+------------+--------+----------+--------+
输出：
+------+
| name |
+------+
| Amy  |
| Mark |
| Alex |
+------+
解释：
根据表 orders 中的订单 '3' 和 '4' ，容易看出只有 'John' 和 'Pam' 两个销售员曾经向公司 'RED' 销售过。
所以我们需要输出表 salesperson 中所有其他人的名字。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="n">salesperson_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">sales_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">John</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Amy</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Alex</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">salary</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">12000</span><span class="p">,</span> <span class="mi">65000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">commission_rate</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">hire_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">4/1/2006</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">5/1/2010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">12/25/2008</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">1/1/2005</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2/3/2007</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">company_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">RED</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ORANGE</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">YELLOW</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">GREEN</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Boston</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">New York</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Boston</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Austin</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">orders_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">order_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">order_date</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">1/1/2014</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2/1/2014</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">3/1/2014</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">4/1/2014</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">sales_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">]</span>
<span class="p">}</span>


<span class="n">sales_person</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">salesperson_data</span><span class="p">)</span>
<span class="n">company</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">company_data</span><span class="p">)</span>
<span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">orders_data</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">sales_person</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">company</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">orders</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>本来都写完了，跑“提交”的时候出现了没有RED公司的情况，所以多加一层判断(直接返回所有的销售人员姓名)：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">sales_person</span><span class="p">(</span><span class="n">sales_person</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">company</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">orders</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="nf">if </span><span class="p">(</span><span class="n">company</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">RED</span><span class="sh">'</span><span class="p">).</span><span class="nf">any</span><span class="p">():</span>
        <span class="n">red_com_id</span> <span class="o">=</span> <span class="n">company</span><span class="p">[</span><span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">][</span><span class="n">company</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">RED</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">sales_person</span><span class="p">[</span><span class="o">~</span><span class="n">sales_person</span><span class="p">[</span><span class="sh">'</span><span class="s">sales_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="sh">"</span><span class="s">sales_id</span><span class="sh">"</span><span class="p">][</span><span class="n">orders</span><span class="p">[</span><span class="sh">'</span><span class="s">com_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">red_com_id</span><span class="p">])][[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sales_person</span><span class="p">[[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="测验题-2">测验题</h1>

<h2 id="2041-面试中被录取的候选人">2041. 面试中被录取的候选人</h2>

<p><a href="https://leetcode.cn/problems/accepted-candidates-from-the-interviews/">2041. 面试中被录取的候选人</a></p>

<p>表：<code class="language-plaintext highlighter-rouge">Candidates</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>+--------------+----------+
| Column Name  | Type     |
+--------------+----------+
| candidate_id | int      |
| name         | varchar  |
| years_of_exp | int      |
| interview_id | int      |
+--------------+----------+
candidate_id 是这个表的主键（具有唯一值的列）。
该表的每一行都表示候选人的姓名、工作年限以及面试 ID 。
</pre></td></tr></tbody></table></code></pre></div></div>

<p>表：<code class="language-plaintext highlighter-rouge">Rounds</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>+--------------+------+
| Column Name  | Type |
+--------------+------+
| interview_id | int  |
| round_id     | int  |
| score        | int  |
+--------------+------+
(interview_id, round_id）是本表的主键（具有唯一值的列的组合）。
本表的每一行都表示一轮面试的分数
</pre></td></tr></tbody></table></code></pre></div></div>

<p>编写解决方案，找出 <strong>至少有两年</strong> 工作经验、且面试分数之和 <strong>严格大于 <code class="language-plaintext highlighter-rouge">15</code></strong> 的候选人的 ID <strong>。</strong></p>

<p>可以以 <strong>任何顺序</strong> 返回结果表。</p>

<p>查询结果的格式如下例所示。</p>

<p><strong>示例 1：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>输入：
Candidates table:
+--------------+---------+--------------+--------------+
| candidate_id | name    | years_of_exp | interview_id |
+--------------+---------+--------------+--------------+
| 11           | Atticus | 1            | 101          |
| 9            | Ruben   | 6            | 104          |
| 6            | Aliza   | 10           | 109          |
| 8            | Alfredo | 0            | 107          |
+--------------+---------+--------------+--------------+
Rounds table:
+--------------+----------+-------+
| interview_id | round_id | score |
+--------------+----------+-------+
| 109          | 3        | 4     |
| 101          | 2        | 8     |
| 109          | 4        | 1     |
| 107          | 1        | 3     |
| 104          | 3        | 6     |
| 109          | 1        | 4     |
| 104          | 4        | 7     |
| 104          | 1        | 2     |
| 109          | 2        | 1     |
| 104          | 2        | 7     |
| 107          | 2        | 3     |
| 101          | 1        | 8     |
+--------------+----------+-------+
输出：
+--------------+
| candidate_id |
+--------------+
| 9            |
+--------------+
解释：
- 候选人 11 ：总分是 16 ，1 年工作经验。由于工作年限，不列入结果表。
- 候选人 9 ：总分是 22 ，6 年工作经验。列入结果表。
- 候选人 6 ：总分是 10 ，10 年工作经验。由于分数不足，不列入结果表。
- 候选人 8 ：总分是 6 ，0 年工作经验。由于工作年限和分数，不列入结果表。
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>测试数据：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>我写的答案：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="k">def</span> <span class="nf">accepted_candidates</span><span class="p">(</span><span class="n">candidates</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">rounds</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">rounds</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">sum_</span> <span class="o">=</span> <span class="n">merged</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">candidates</span><span class="p">[(</span><span class="n">candidates</span><span class="p">[</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">sum_</span><span class="p">[</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">][</span><span class="n">sum_</span><span class="p">[</span><span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="sh">'</span><span class="s">years_of_exp</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)][[</span><span class="sh">'</span><span class="s">candidate_id</span><span class="sh">'</span><span class="p">]]</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>以上就完成了整个刷题计划。</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250303114303211.png" alt="image-20250303114303211" style="zoom:50%;" /></p>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2025/03/02/%E5%90%B4%E6%81%A9%E8%BE%BEML2-5/" data-toggle="tooltip" data-placement="top" title="2-5 梯度下降  Gradient Descent">
                        Previous<br>
                        <span>2-5 梯度下降  Gradient Descent</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2025/03/03/%E5%90%B4%E6%81%A9%E8%BE%BEML2-6/" data-toggle="tooltip" data-placement="top" title="2-6 梯度下降知识点总结">
                        Next<br>
                        <span>2-6 梯度下降知识点总结</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0108" 
                    href="/archive/?tag=%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB"
                    title="书籍阅读"
                    rel="3">书籍阅读</a>
        
                <a data-sort="0087" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95"
                    title="算法"
                    rel="24">算法</a>
        
                <a data-sort="0093" 
                    href="/archive/?tag=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI%E5%9F%BA%E7%A1%80"
                    title="人工智能AI基础"
                    rel="18">人工智能AI基础</a>
        
                <a data-sort="0094" 
                    href="/archive/?tag=python%E5%9F%BA%E7%A1%80"
                    title="python基础"
                    rel="17">python基础</a>
        
                <a data-sort="0099" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%90%B4%E6%81%A9%E8%BE%BE"
                    title="机器学习-吴恩达"
                    rel="12">机器学习-吴恩达</a>
        
                <a data-sort="0101" 
                    href="/archive/?tag=%E5%8A%9B%E6%89%A3"
                    title="力扣"
                    rel="10">力扣</a>
        
                <a data-sort="0106" 
                    href="/archive/?tag=numpy"
                    title="numpy"
                    rel="5">numpy</a>
        
                <a data-sort="0108" 
                    href="/archive/?tag=spring6"
                    title="spring6"
                    rel="3">spring6</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=Java%E5%9F%BA%E7%A1%80"
                    title="Java基础"
                    rel="2">Java基础</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=ollama%E5%B7%A5%E5%85%B7"
                    title="ollama工具"
                    rel="2">ollama工具</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=pandas"
                    title="pandas"
                    rel="2">pandas</a>
        
                <a data-sort="0109" 
                    href="/archive/?tag=python%E7%88%AC%E8%99%AB"
                    title="python爬虫"
                    rel="2">python爬虫</a>
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://m.freebuf.com/">freebuf</a></li>
  
  <li><a href="https://xz.aliyun.com/">先知</a></li>
  
  <li><a href="https://www.sec-in.com/All">sec-in</a></li>
  
  <li><a href="https://paper.seebug.org/">see-bug</a></li>
  
  <li><a href="https://twitter.com/Concurr21486093">我的推特</a></li>
  
  <li><a href="https://pdai.tech/">pdai</a></li>
  
  <li><a href="https://nodejs.org/dist/">nodejs index of dist</a></li>
  
  <li><a href="#">公众号：小东方不败</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/Concurr21486093">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/Hilda">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">知</i>
      </span>
    </a>
  </li>
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/kirsten-1">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Hilda 2025
                    <br>
                    Powered by <a href="https://kirsten-1.github.io/">hilda Blog</a>
<!--                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"-->
<!--                        height="20px"-->
<!--                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">-->
<!--                    </iframe>-->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
