<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="è¿™é‡Œæ˜¯ Hilda çš„ä¸ªäººåšå®¢ï¼Œä¸ä½ ä¸€èµ·å‘ç°æ›´å¤§çš„ä¸–ç•Œ | è¦åšä¸€ä¸ªæœ‰ swag çš„ç¨‹åºå‘˜">
    <meta name="keywords" content="Hilda">
    <meta name="theme-color" content="#000000">

    <!-- Open Graph -->
    <meta property="og:title"
        content="ã€AIæ€æƒ³å¯è’™04ã€‘çº¿æ€§å›å½’3çªç ´ç“¶é¢ˆï¼Œæ¨¡å‹æ•ˆæœçš„æå‡  - Hildaçš„åšå®¢ | Your genius girlfriend's blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="

">
    
    <meta property="article:published_time" content=" 2025-10-27T00:00:00Z">
    
    
    <meta property="article:author" content="Hilda">
    
    
    <meta property="article:tag" content="AIæ€æƒ³å¯è’™">
    
    
    <meta property="og:image" content="https://kirsten-1.github.io">
    <meta property="og:url" content="https://kirsten-1.github.io/2025/10/27/AI%E6%80%9D%E6%83%B3%E5%90%AF%E8%92%9904/">
    <meta property="og:site_name" content="Hildaçš„åšå®¢ | Your genius girlfriend's blog">

    <title>ã€AIæ€æƒ³å¯è’™04ã€‘çº¿æ€§å›å½’3çªç ´ç“¶é¢ˆï¼Œæ¨¡å‹æ•ˆæœçš„æå‡  - Hildaçš„åšå®¢ | Your genius girlfriend's blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://kirsten-1.github.io/2025/10/27/AI%E6%80%9D%E6%83%B3%E5%90%AF%E8%92%9904/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href=" /css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"
        type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-6487568398225121" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Hilda</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-2015.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-bg-2015.jpg');
        background: ;
    }

    
</style>




<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=AI%E6%80%9D%E6%83%B3%E5%90%AF%E8%92%99" title="AIæ€æƒ³å¯è’™">AIæ€æƒ³å¯è’™</a>
                        
                    </div>
                    <h1>ã€AIæ€æƒ³å¯è’™04ã€‘çº¿æ€§å›å½’3çªç ´ç“¶é¢ˆï¼Œæ¨¡å‹æ•ˆæœçš„æå‡ </h1>
                    
                    <h2 class="subheading">å¤šå…ƒçº¿æ€§å›å½’å¤„ç†å¤šç‰¹å¾æ•°æ®ï¼Œé€šè¿‡å¢å¹¿å‘é‡ç»Ÿä¸€è¡¨è¾¾ï¼ŒMSEä¼˜åŒ–æƒé‡ã€‚å¤šé¡¹å¼å›å½’æ‹Ÿåˆéçº¿æ€§ï¼Œéœ€å¹³è¡¡è¿‡æ‹Ÿåˆã€‚éšæœºç‰¹å¾æƒé‡æœŸæœ›ä¸º0ï¼Œå…±çº¿æ€§å¯¼è‡´ç³»æ•°ä¸ç¨³å®šï¼Œéœ€ç‰¹å¾é€‰æ‹©æˆ–æ­£åˆ™åŒ–ã€‚</h2>
                    <span class="meta">Posted by Hilda on October 27, 2025</span>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>

<p>ç°å®ä¸­ï¼Œçº¿æ€§å›å½’çš„é—®é¢˜å¾€å¾€æ˜¯å¤šå…ƒçš„ã€‚</p>

<h1 id="1å¤šå…ƒå›å½’æ¨¡å‹åŸºæœ¬æè¿°">1.å¤šå…ƒå›å½’æ¨¡å‹åŸºæœ¬æè¿°</h1>

<p>å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹æ˜¯å¤„ç†å…·æœ‰å¤šä¸ªç‰¹å¾ï¼ˆ\(X\) å‘é‡ï¼‰çš„å›å½’é—®é¢˜ã€‚</p>

<p>æ¨¡å‹æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°†è¾“å…¥ \(X\) æ˜ å°„åˆ°è¾“å‡º \(Y\)ã€‚</p>

<p>ç›®æ ‡å€¼ \(y\) æ˜¯ç”±å¤šä¸ªç‰¹å¾ \(x_i\) åŠå…¶å¯¹åº”çš„æƒé‡ \(w_i\) çš„çº¿æ€§ç»„åˆæ„æˆã€‚</p>

\[y = w_1 x_1 + w_2 x_2 + \cdots + w_n x_n + w_0\]

<p>ä¸Šé¢çš„æ˜¯æ ‡é‡å½¢å¼ï¼Œä¹Ÿå¯ä»¥å†™æˆå‘é‡å½¢å¼/çŸ©é˜µä¹˜æ³•å½¢å¼ï¼Œè¿™æ˜¯ä¸€ç§æ›´è§„èŒƒã€æ›´ç´§å‡‘çš„è¡¨è¾¾æ–¹å¼ï¼š</p>

\[\hat{y} = \mathbf{W}^{\text{T}} \mathbf{X} + w_0\]

<p>å…¶ä¸­ï¼Œ\(\mathbf{W} = \begin{pmatrix} w_1 \\ \vdots \\ w_n \end{pmatrix}\) æ˜¯æƒé‡å‘é‡ã€‚\(\mathbf{X} = \begin{pmatrix} x_1 \\ \vdots \\ x_n \end{pmatrix}\) æ˜¯ç‰¹å¾å‘é‡ã€‚\(w_0\)ï¼ˆæˆ– \(b\)ï¼‰æ˜¯åç½®ï¼ˆæˆªè·ï¼‰é¡¹ã€‚</p>

<p>æ¨¡å‹çš„ç›®æ ‡æ˜¯æ‰¾åˆ°æœ€ä¼˜çš„æƒé‡ \(\mathbf{W}\) å’Œåç½® \(w_0\)ï¼Œä½¿å¾—é¢„æµ‹å€¼ \(\hat{y}\) ä¸çœŸå®å€¼ \(y\) ä¹‹é—´çš„è¯¯å·®æœ€å°ã€‚</p>

<p>å’Œä¸€å…ƒçš„çº¿æ€§å›å½’é—®é¢˜ä¸€æ ·ï¼Œè¡¡é‡æ¨¡å‹æ€§èƒ½æœ€å¸¸ç”¨çš„æŒ‡æ ‡è¿˜æ˜¯MSEï¼ˆå‡æ–¹è¯¯å·®ï¼‰ï¼š</p>

\[\text{MSE} = \frac{1}{n}\sum_{i=1}^n (\hat{y}_i - y_i)^2\]

<p>ä¸ºäº†å°†åç½®é¡¹ \(w_0\) èå…¥çŸ©é˜µä¹˜æ³•ä¸­ï¼Œä½¿å…¶æˆä¸ºæƒé‡ \(\mathbf{W}\) çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç‰¹å¾å‘é‡ \(\mathbf{X}\) è¿›è¡Œ<strong>å¢å¹¿ï¼ˆAugmentationï¼‰</strong>ï¼š</p>

<p>å¢å¹¿ç‰¹å¾å‘é‡ \(\mathbf{X}\)ï¼šåœ¨åŸå§‹ç‰¹å¾å‘é‡ \(\mathbf{X}\) çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼ˆæˆ–æœ€åä¸€ä¸ªä½ç½®ï¼‰æ·»åŠ ä¸€ä¸ªæ’ä¸º1çš„å…ƒç´ ã€‚</p>

\[\mathbf{X} = \begin{pmatrix} 1 \\ x_1 \\ x_2 \\ \vdots \\ x_n \end{pmatrix}\]

<p>è¿™ä¸ªå¸¸æ•° $1$ ç¡®ä¿äº† $w_0$ åœ¨çŸ©é˜µä¹˜æ³•ä¸­è¢«ä¿ç•™ã€‚</p>

<p><strong>å¢å¹¿æƒé‡å‘é‡ \(\mathbf{W}\)ï¼š</strong> å°†åç½®é¡¹ \(w_0\) ä½œä¸ºæƒé‡å‘é‡ \(\mathbf{W}\) çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå¯¹åº”äºå¢å¹¿ç‰¹å¾1ï¼‰ã€‚</p>

\[\mathbf{W} = \begin{pmatrix} w_0 \\ w_1 \\ w_2 \\ \vdots \\ w_n \end{pmatrix}\]

<p>é€šè¿‡è¿™ç§å¢å¹¿ï¼Œå¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹å¯ä»¥ç»Ÿä¸€è¡¨è¾¾ä¸ºä¸€ä¸ªç®€å•çš„å‘é‡å†…ç§¯ï¼ˆçŸ©é˜µä¹˜æ³•ï¼‰ï¼š</p>

\[\hat{y} = \mathbf{W}^{\text{T}} \mathbf{X}\]

<p>æˆ–</p>

\[\hat{y} = \mathbf{X}^{\text{T}} \mathbf{W}\]

<p>è¿™ç§ç®€åŒ–è¡¨è¾¾æ˜¯æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­çš„<strong>æ ‡å‡†åšæ³•</strong>,ç®€åŒ–æ‰€æœ‰æ•°å­¦æ¨å¯¼ï¼ˆå¦‚æ¢¯åº¦ã€æ­£è§„æ–¹ç¨‹ï¼‰ã€‚åŒæ—¶ç®€åŒ–äº†ç¼–ç¨‹å®ç°ï¼Œè€Œä¸”MSE æŸå¤±å‡½æ•°ä»ç„¶é€‚ç”¨äºè¿™ç§ç®€åŒ–å½¢å¼ï¼š</p>

\[\text{MSE} = \frac{1}{m}\sum_{i=1}^m (\mathbf{W}^{\text{T}} \mathbf{X}_i - y_i)^2\]

<p>è¿™ç§ç®€æ´çš„è¡¨è¾¾æ–¹å¼ä½¿å¾—å¤æ‚çš„å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹åœ¨ä»£æ•°å’Œç¼–ç¨‹ä¸Šéƒ½å˜å¾—é«˜æ•ˆå’Œä¼˜é›…ã€‚</p>

<h1 id="2å¤šå…ƒå›å½’-å®æˆ˜">2.å¤šå…ƒå›å½’-å®æˆ˜</h1>

<p>1.è¯»å–æ•°æ®ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">ast</span>

<span class="k">def</span> <span class="nf">load_data_from_list_format</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    åŠ è½½å¹¶è§£ææ‚¨çš„ç‰¹å®šæ ¼å¼ï¼ˆ[[...], ...]ï¼‰çš„æ•°æ®æ–‡ä»¶ã€‚
    </span><span class="sh">"""</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="c1"># 1. ä½¿ç”¨ ast.literal_eval å®‰å…¨åœ°å°†å­—ç¬¦ä¸²è§£æä¸º Python åˆ—è¡¨
</span>            <span class="k">try</span><span class="p">:</span>
                <span class="n">data_tuple</span> <span class="o">=</span> <span class="n">ast</span><span class="p">.</span><span class="nf">literal_eval</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">())</span>
                
                <span class="c1"># 2. è§£åŒ…ï¼šç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç‰¹å¾åˆ—è¡¨ï¼Œç¬¬äºŒä¸ªæ˜¯ç›®æ ‡å€¼
</span>                <span class="n">X_row</span> <span class="o">=</span> <span class="n">data_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">y_value</span> <span class="o">=</span> <span class="n">data_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                
                <span class="n">features</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">X_row</span><span class="p">)</span>
                <span class="n">targets</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">y_value</span><span class="p">)</span>
                
            <span class="nf">except </span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="nb">SyntaxError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Skipping line due to error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s"> in line: </span><span class="si">{</span><span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">continue</span>
                
    <span class="c1"># 3. è½¬æ¢ä¸º NumPy æ•°ç»„
</span>    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>

<span class="c1"># ç¤ºä¾‹è°ƒç”¨
</span><span class="n">file_path</span> <span class="o">=</span> <span class="sh">"</span><span class="s">../boston/train_data</span><span class="sh">"</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="nf">load_data_from_list_format</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Features (X_train) shape: </span><span class="si">{</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Targets (y_train) shape: </span><span class="si">{</span><span class="n">y_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">First row of features:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">First target value:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20251027180907089.png" alt="image-20251027180907089" style="zoom:50%;" /></p>

<p>2.ä½¿ç”¨å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹å¯¹åŠ è½½çš„å…¨éƒ¨æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œå¹¶æ‰“å°å‡ºæ¨¡å‹çš„å‚æ•°ï¼ˆå³æˆªè·å’Œç³»æ•°ï¼‰ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1"># ----------------- æ¨¡å‹è®­ç»ƒ -----------------
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ğŸš€ æ­£åœ¨ä½¿ç”¨å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹è¿›è¡Œè®­ç»ƒ...</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 1. åˆå§‹åŒ–æ¨¡å‹
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">LinearRegression</span><span class="p">()</span>

<span class="c1"># 2. è®­ç»ƒæ¨¡å‹
# æ³¨æ„ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ‚¨é€šå¸¸ä¼šåˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œä½†æ ¹æ®æ‚¨çš„è¯·æ±‚ï¼Œæˆ‘ä»¬ä½¿ç”¨å…¨éƒ¨æ•°æ®è¿›è¡Œè®­ç»ƒã€‚
</span><span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">âœ… æ¨¡å‹è®­ç»ƒå®Œæˆã€‚</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- æ¨¡å‹å‚æ•° ---</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 3. æ‰“å°æ¨¡å‹å‚æ•°
# æˆªè· (Intercept)
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">**æˆªè· (Intercept, $</span><span class="se">\\</span><span class="s">beta_0$):** </span><span class="si">{</span><span class="n">model</span><span class="p">.</span><span class="n">intercept_</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># ç³»æ•° (Coefficients)
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">**ç‰¹å¾ç³»æ•° (Coefficients, $</span><span class="se">\\</span><span class="s">beta_{1}$ åˆ° $</span><span class="se">\\</span><span class="s">beta_{13}$):**</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># å°†ç³»æ•°æ‰“å°æˆæ˜“äºé˜…è¯»çš„æ ¼å¼
</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coef</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">coefficients</span><span class="p">):</span>
    <span class="c1"># å‡è®¾ç‰¹å¾ç´¢å¼•å¯¹åº”äºç¬¬ 1 åˆ° ç¬¬ 13 ä¸ªç‰¹å¾
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  - Feature </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s"> (X</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">): </span><span class="si">{</span><span class="n">coef</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># å¦‚æœæ‚¨æƒ³ä»¥ NumPy æ•°ç»„å½¢å¼æŸ¥çœ‹æ‰€æœ‰ç³»æ•°
# print(f"\næ‰€æœ‰ç³»æ•°æ•°ç»„: \n{coefficients}")
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20251027181202802.png" alt="image-20251027181202802" style="zoom:50%;" /></p>

<p>æ³¨æ„ï¼Œä¸Šé¢çš„13ä¸ªå˜é‡æ²¡æœ‰è¿›è¡Œæ ‡å‡†åŒ–ï¼Œåªæœ‰åœ¨æ‰€æœ‰ç‰¹å¾ï¼ˆè‡ªå˜é‡ \(X_i\)ï¼‰éƒ½ç»è¿‡<strong>æ ‡å‡†åŒ–ï¼ˆStandardizationï¼‰</strong>å¤„ç†ï¼Œå³å®ƒä»¬å…·æœ‰ç›¸åŒçš„å°ºåº¦ï¼ˆä¾‹å¦‚ï¼Œå‡å€¼ä¸º 0ï¼Œæ ‡å‡†å·®ä¸º 1ï¼‰æ—¶ï¼Œå‚æ•°ï¼ˆç³»æ•°ï¼‰çš„ç»å¯¹å€¼è¶Šå¤§ï¼Œæ‰è¯´æ˜è¯¥å˜é‡å¯¹ \(Y\) çš„å½±å“è¶Šå¤§ã€‚</p>

<blockquote>
  <p>åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰ï¼Œå¯¹æ‰€æœ‰ç‰¹å¾ \(X\) è¿›è¡Œæ ‡å‡†åŒ–ï¼ˆStandardScalerï¼‰ï¼Œç„¶åå†æ¬¡è®­ç»ƒæ¨¡å‹ã€‚</p>

\[\text{æ ‡å‡†åŒ–} (X') = \frac{X - \mu}{\sigma}\]
</blockquote>

<h1 id="3å¤šé¡¹å¼å›å½’">3.å¤šé¡¹å¼å›å½’</h1>

<p>ä½¿ç”¨çº¿æ€§å›å½’çš„å‰ææ¡ä»¶ï¼šæ•°æ®å°½é‡åœ¨ä¸€æ¡ç›´çº¿ä¸Š</p>

<p>ä½†æ˜¯å¦‚æœæœ‰ä¸‹é¢è¿™æ ·çš„æ•°æ®ï¼Œå¦‚ä½•æ‹Ÿåˆï¼Ÿ</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">load_and_clean_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    ä»æŒ‡å®šæ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œæ¸…ç†å­—ç¬¦ä¸²æ ¼å¼ï¼Œå¹¶è¿”å› NumPy æ•°ç»„ã€‚
    æ•°æ®æ ¼å¼é¢„æœŸä¸ºï¼š[[x], [y]]
    </span><span class="sh">"""</span>
    <span class="n">cleaned_data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">line_number</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># ç”¨äºè·Ÿè¸ªè¡Œå·
</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="c1"># 1. æ¸…ç†è¡Œé¦–å’Œè¡Œå°¾çš„ç©ºç™½å­—ç¬¦
</span>                <span class="n">line_stripped</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span>
                
                <span class="c1"># ä¸¥æ ¼è·³è¿‡ç©ºè¡Œæˆ–ä»…åŒ…å«ç©ºç™½å­—ç¬¦çš„è¡Œ
</span>                <span class="k">if</span> <span class="ow">not</span> <span class="n">line_stripped</span><span class="p">:</span>
                    <span class="c1"># å¦‚æœéœ€è¦è°ƒè¯•ï¼Œå¯ä»¥å–æ¶ˆæ³¨é‡Šä¸‹é¢è¿™è¡Œ
</span>                    <span class="c1"># print(f"è·³è¿‡æ–‡ä»¶ä¸­çš„ç©ºè¡Œæˆ–ç©ºç™½è¡Œ (è¡Œå·: {line_number})")
</span>                    <span class="k">continue</span>
                    
                <span class="c1"># 2. ç§»é™¤æ‰€æœ‰æ–¹æ‹¬å· '[]' å’Œç©ºæ ¼ï¼Œåªç•™ä¸‹æ•°å­—å’Œé€—å·
</span>                <span class="c1"># ç¤ºä¾‹: "[[5.34...], [30.91...]]" -&gt; "5.34...,30.91..."
</span>                <span class="n">clean_value_str</span> <span class="o">=</span> <span class="n">line_stripped</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">[</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">]</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">)</span>
                
                <span class="c1"># 3. æŒ‰é€—å·åˆ†éš”ï¼Œå¾—åˆ° X å’Œ y çš„å­—ç¬¦ä¸²
</span>                <span class="n">x_str</span><span class="p">,</span> <span class="n">y_str</span> <span class="o">=</span> <span class="n">clean_value_str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">)</span>
                
                <span class="c1"># 4. è½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å­˜å‚¨
</span>                <span class="n">x_val</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">x_str</span><span class="p">)</span>
                <span class="n">y_val</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">y_str</span><span class="p">)</span>
                <span class="n">cleaned_data_list</span><span class="p">.</span><span class="nf">append</span><span class="p">([</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">])</span>
                
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">âŒ é”™è¯¯ï¼šæœªæ‰¾åˆ°æ–‡ä»¶ </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s">ã€‚è¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„ã€‚</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    <span class="k">except</span> <span class="nb">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">âŒ é”™è¯¯ï¼šæ•°æ®æ ¼å¼ä¸æ­£ç¡®ï¼Œæ— æ³•è½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚è¯·æ£€æŸ¥æ•°æ®è¡Œ (è¡Œå·: </span><span class="si">{</span><span class="n">line_number</span><span class="si">}</span><span class="s">): </span><span class="si">{</span><span class="n">line_stripped</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">å…·ä½“é”™è¯¯ä¿¡æ¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">âŒ å‘ç”ŸæœªçŸ¥é”™è¯¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

    <span class="c1"># 5. è½¬æ¢ä¸ºæœ€ç»ˆçš„ NumPy æ•°ç»„
</span>    <span class="n">cleaned_data_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">cleaned_data_list</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">float64</span><span class="p">)</span>
    
    <span class="c1"># 6. åˆ†ç¦»ç‰¹å¾ (X) å’Œç›®æ ‡å€¼ (y)
</span>    <span class="c1"># X å¿…é¡»æ˜¯äºŒç»´æ•°ç»„ (n, 1)
</span>    <span class="n">X</span> <span class="o">=</span> <span class="n">cleaned_data_np</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">].</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">cleaned_data_np</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># y æ˜¯ä¸€ç»´æ•°ç»„ (n,)
</span>    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>

<span class="c1"># ----------------- ä¿®æ”¹åçš„ä½¿ç”¨ç¤ºä¾‹ -----------------
</span><span class="n">file_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">train_paracurve_data</span><span class="sh">'</span> <span class="c1"># å»ºè®®ä½¿ç”¨ .txt æ‰©å±•åï¼Œä»¥æ˜ç¡®æ–‡ä»¶ç±»å‹
</span>
<span class="c1"># **æ³¨æ„:** è¯·ç¡®ä¿æ‚¨çš„æ•°æ®å·²ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­
</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">load_and_clean_data</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

<span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">--- âœ… æ•°æ®è¯»å–æˆåŠŸ ---</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ç‰¹å¾ X çš„å½¢çŠ¶: </span><span class="si">{</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ç›®æ ‡ y çš„å½¢çŠ¶: </span><span class="si">{</span><span class="n">y</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">X çš„å‰ 5 ä¸ªæ ·æœ¬:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">y çš„å‰ 5 ä¸ªæ ·æœ¬:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">y</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">æ•°æ®å·²æ¸…ç†å¹¶å‡†å¤‡å¥½è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼ˆæœªåˆ†å‰²æ•°æ®é›†ï¼‰ã€‚</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># **********************************************
</span>    <span class="c1"># ç§»é™¤çš„åˆ†å‰²ä»£ç åŸæœ¬åœ¨æ­¤å¤„ï¼Œç°åœ¨ç›´æ¥å¯¹ X å’Œ y è¿›è¡Œæ“ä½œ
</span>    <span class="c1"># **********************************************
</span>    
    <span class="c1"># ç°åœ¨æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨æ•´ä¸ª X å’Œ y è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼ˆä¾‹å¦‚ï¼Œè®­ç»ƒé›†å°±æ˜¯æ•´ä¸ªæ•°æ®é›†ï¼‰
</span>    <span class="c1"># from sklearn.linear_model import LinearRegression
</span>    <span class="c1"># model = LinearRegression()
</span>    <span class="c1"># model.fit(X, y) # ç›´æ¥ä½¿ç”¨æ‰€æœ‰æ•°æ®è¿›è¡Œè®­ç»ƒ
</span>    
<span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ğŸ¨ æ­£åœ¨ç”Ÿæˆæ•£ç‚¹å›¾...</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># ç»˜åˆ¶æ•£ç‚¹å›¾
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    
    <span class="c1"># ç»˜åˆ¶åŸå§‹æ•°æ®ç‚¹ (æ•£ç‚¹å›¾)
</span>    <span class="c1"># X å¿…é¡»è¢«å±•å¹³ä¸ºä¸€ç»´æ•°ç»„æ‰èƒ½ä½œä¸º x è½´è¾“å…¥
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nf">flatten</span><span class="p">(),</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    
    <span class="c1"># æ·»åŠ æ ‡é¢˜å’Œæ ‡ç­¾
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ç‰¹å¾ X ä¸ç›®æ ‡ Y çš„æ•°æ®æ•£ç‚¹å›¾</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ç‰¹å¾ X å€¼</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ç›®æ ‡å€¼ Y å€¼</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># æ˜¾ç¤ºç½‘æ ¼
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    
    <span class="c1"># æ˜¾ç¤ºå›¾å½¢
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">âœ… æ•£ç‚¹å›¾ç»˜åˆ¶å®Œæˆã€‚</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20251027182028140.png" alt="image-20251027182028140" /></p>

<p>å¯ä»¥ç”¨ä¸‹é¢çš„æ¨¡å‹æ‹Ÿåˆï¼šï¼ˆå› ä¸ºé€šè¿‡è§‚å¯ŸçŒœæµ‹å¯ä»¥ç”¨æŠ›ç‰©çº¿æ‹Ÿåˆï¼‰</p>

\[y = a x_1^2 + b x_1 + c\]

<p>è¿™è¢«ç§°ä¸º <strong>äºŒæ¬¡å¤šé¡¹å¼å›å½’ (Quadratic Polynomial Regression)</strong>ã€‚</p>

<p>ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">sklearn</code> çš„ <code class="language-plaintext highlighter-rouge">PolynomialFeatures</code> æ¥ç”Ÿæˆ \(x^2\) å’Œ \(x\) è¿™ä¸¤ä¸ªç‰¹å¾ï¼Œç„¶åä½¿ç”¨ <code class="language-plaintext highlighter-rouge">LinearRegression</code> è¿›è¡Œæ‹Ÿåˆã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="c1"># ä¸ºä¿è¯ç»˜å›¾å¹³æ»‘ï¼Œæˆ‘ä»¬å¯¹ X è¿›è¡Œæ’åº
</span><span class="n">sort_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nf">flatten</span><span class="p">())</span>
<span class="n">X_sorted</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">sort_index</span><span class="p">]</span>
<span class="n">y_sorted</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">sort_index</span><span class="p">]</span>

<span class="c1"># -------------------------- 1. ç‰¹å¾å·¥ç¨‹ï¼šç”Ÿæˆå¤šé¡¹å¼ç‰¹å¾ --------------------------
# æˆ‘ä»¬éœ€è¦åˆ›å»º X^2 å’Œ X è¿™ä¸¤ä¸ªç‰¹å¾
# å…¬å¼: y = a*x^2 + b*x + c
# è¿™ç›¸å½“äºä¸€ä¸ªçº¿æ€§æ¨¡å‹: y = a*Z1 + b*Z2 + cï¼Œå…¶ä¸­ Z1=x^2, Z2=x
</span>
<span class="c1"># degree=2 ä¼šç”Ÿæˆ [1, x, x^2] (å¦‚æœ include_bias=True)
# æˆ‘ä»¬è®¾ç½®ä¸º include_bias=Falseï¼Œå› ä¸º LinearRegression é»˜è®¤ä¼šæ·»åŠ æˆªè· (c)
</span><span class="n">poly</span> <span class="o">=</span> <span class="nc">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">X_sorted</span><span class="p">)</span>

<span class="c1"># X_poly ç°åœ¨æœ‰ä¸¤åˆ—: [x, x^2] (æ³¨æ„ï¼šPolynomialFeatures é»˜è®¤æŒ‰å¹‚æ¬¡å‡åº [x^1, x^2])
</span>
<span class="c1"># ä¸ºäº†å¯¹åº”æ‚¨å…¬å¼ä¸­çš„é¡ºåº (x^2, x)ï¼Œæˆ‘ä»¬æ‰‹åŠ¨è°ƒæ•´åˆ—çš„é¡ºåºï¼ˆå¯é€‰ï¼Œä½†æœ‰åŠ©äºå‚æ•°å¯¹åº”ï¼‰
# ç¡®ä¿ X_poly çš„åˆ—é¡ºåºæ˜¯ [x^2, x]
# å®é™…ä¸Šï¼Œç”±äºç³»æ•°æ˜¯è‡ªåŠ¨æ‹Ÿåˆçš„ï¼Œä¿æŒé»˜è®¤é¡ºåº [x, x^2] æ›´ç®€å•ã€‚
# æˆ‘ä»¬ä¿æŒé»˜è®¤é¡ºåºï¼Œå¹¶åœ¨è§£é‡Šç³»æ•°æ—¶è¯´æ˜ã€‚
# é»˜è®¤åˆ—é¡ºåº: X_poly = [x^1, x^2]
</span>
<span class="c1"># -------------------------- 2. æ¨¡å‹è®­ç»ƒ --------------------------
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_poly</span><span class="p">,</span> <span class="n">y_sorted</span><span class="p">)</span>

<span class="c1"># 3. é¢„æµ‹æ‹Ÿåˆæ›²çº¿
# ç”¨äºç»˜å›¾çš„é¢„æµ‹å€¼
</span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_poly</span><span class="p">)</span>

<span class="c1"># -------------------------- 4. æ‰“å°å‚æ•° --------------------------
# ç³»æ•°é¡ºåº: model.coef_[0] å¯¹åº” xï¼Œ model.coef_[1] å¯¹åº” x^2
# æˆªè·: model.intercept_ å¯¹åº” c
</span><span class="n">coef_x</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">coef_x2</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">intercept_c</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">intercept_</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">--- âœ… æ¨¡å‹è®­ç»ƒå®Œæˆ ---</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">æ‹Ÿåˆå…¬å¼: y = </span><span class="si">{</span><span class="n">coef_x2</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> * x^2 + </span><span class="si">{</span><span class="n">coef_x</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> * x + </span><span class="si">{</span><span class="n">intercept_c</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">--- æ¨¡å‹å‚æ•° ---</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">a (x^2 çš„ç³»æ•°): </span><span class="si">{</span><span class="n">coef_x2</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">b (x çš„ç³»æ•°): </span><span class="si">{</span><span class="n">coef_x</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">c (æˆªè·): </span><span class="si">{</span><span class="n">intercept_c</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">æ‹Ÿåˆä¼˜åº¦ RÂ²: </span><span class="si">{</span><span class="nf">r2_score</span><span class="p">(</span><span class="n">y_sorted</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>


<span class="c1"># -------------------------- 5. ç»˜å›¾ --------------------------
# Matplotlib ç»˜å›¾è®¾ç½®
</span><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="sh">"</span><span class="s">font.sans-serif</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">SimHei</span><span class="sh">"</span><span class="p">]</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="sh">"</span><span class="s">axes.unicode_minus</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># è§£å†³è´Ÿå·æ˜¾ç¤ºçš„é—®é¢˜
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># ç»˜åˆ¶åŸå§‹æ•°æ®ç‚¹ (æ•£ç‚¹å›¾)
</span><span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">X_sorted</span><span class="p">.</span><span class="nf">flatten</span><span class="p">(),</span> <span class="n">y_sorted</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">åŸå§‹æ•°æ®ç‚¹</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># ç»˜åˆ¶æ‹Ÿåˆæ›²çº¿
</span><span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">X_sorted</span><span class="p">.</span><span class="nf">flatten</span><span class="p">(),</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="s">æ‹Ÿåˆæ›²çº¿: y = a*xÂ² + b*x + c</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># æ·»åŠ æ ‡é¢˜å’Œæ ‡ç­¾
</span><span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">äºŒæ¬¡å¤šé¡¹å¼å›å½’æ‹Ÿåˆ</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ç‰¹å¾ X</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ç›®æ ‡å€¼ Y</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># æ·»åŠ å›¾ä¾‹
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="c1"># æ˜¾ç¤ºç½‘æ ¼
</span><span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># æ˜¾ç¤ºå›¾å½¢
</span><span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20251027182554921.png" alt="image-20251027182554921" /></p>

<p><strong>\(R^2\)â€‹ (R-squared) ï¼Œä¹Ÿç§°ä¸ºå†³å®šç³»æ•° (Coefficient of Determination)</strong>,æ˜¯ç”¨æ¥è¡¡é‡å»ºç«‹çš„å›å½’æ¨¡å‹å¯¹åŸå§‹æ•°æ®çš„æ‹Ÿåˆç¨‹åº¦çš„ä¸€ä¸ªæŒ‡æ ‡ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼ˆéå¿…è¦äº†è§£ï¼Œä½†å¯å¸®åŠ©ç†è§£ï¼‰ï¼š</p>

\[R^2 = 1 - \frac{SS_{res}}{SS_{tot}}\]

<ul>
  <li>\(SS_{res}\)ï¼ˆResidual Sum of Squaresï¼‰ï¼šæ®‹å·®å¹³æ–¹å’Œï¼Œå³é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´å·®å¼‚çš„å¹³æ–¹å’Œã€‚</li>
  <li>\(SS_{tot}\)ï¼ˆTotal Sum of Squaresï¼‰ï¼šæ€»å¹³æ–¹å’Œï¼Œå³å®é™…å€¼ä¸å®é™…å€¼å¹³å‡å€¼ä¹‹é—´å·®å¼‚çš„å¹³æ–¹å’Œï¼ˆä»£è¡¨äº† $Y$ çš„æ€»å˜å¼‚ï¼‰ã€‚</li>
</ul>

<p>\(R^2\) çš„å–å€¼èŒƒå›´é€šå¸¸åœ¨ 0 åˆ° 1 ä¹‹é—´ã€‚</p>

<table>
  <thead>
    <tr>
      <th><strong>R^2 å€¼</strong></th>
      <th><strong>å«ä¹‰</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>\(R^2 \approx 1\)</strong></td>
      <td>æ¨¡å‹èƒ½å¾ˆå¥½åœ°è§£é‡Šæ•°æ®çš„å˜å¼‚ã€‚è¿™æ„å‘³ç€æ¨¡å‹å¯¹æ•°æ®çš„æ‹Ÿåˆéå¸¸å¥½ï¼Œé¢„æµ‹å€¼ä¸å®é™…å€¼éå¸¸æ¥è¿‘ã€‚</td>
    </tr>
    <tr>
      <td><strong>\(R^2 \approx 0\)</strong></td>
      <td>æ¨¡å‹å‡ ä¹ä¸èƒ½è§£é‡Šæ•°æ®çš„å˜å¼‚ã€‚è¿™æ„å‘³ç€æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›å¾ˆå¼±ï¼Œå¯èƒ½è¿˜ä¸å¦‚ç›´æ¥ä½¿ç”¨ \(Y\) çš„å¹³å‡å€¼æ¥é¢„æµ‹ã€‚</td>
    </tr>
    <tr>
      <td><strong>\(R^2 &lt; 0\)</strong></td>
      <td>è¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼Œä½†å¯èƒ½å‘ç”Ÿåœ¨æ‹Ÿåˆä¸€ä¸ª<strong>éçº¿æ€§æ¨¡å‹</strong>ï¼ˆå¦‚æ‚¨åˆšæ‰åšçš„å¤šé¡¹å¼å›å½’ï¼‰æˆ–ä½¿ç”¨<strong>ä¸åˆé€‚çš„æ¨¡å‹</strong>æ—¶ã€‚å®ƒæ„å‘³ç€æ‚¨çš„æ¨¡å‹æ‹Ÿåˆæ•ˆæœæ¯”ç®€å•åœ°ä½¿ç”¨ \(Y\) çš„å¹³å‡å€¼è¿›è¡Œé¢„æµ‹è¿˜è¦å·®ã€‚</td>
    </tr>
  </tbody>
</table>

<hr />

<p>ä¸Šé¢æ¼”ç¤ºçš„æ˜¯äºŒæ¬¡ï¼Œä¸‰æ¬¡ç”šè‡³é«˜æ¬¡éƒ½æ˜¯åŒç†ã€‚</p>

<p>æ ¹æ®æ³°å‹’å…¬å¼ï¼Œä»»æ„å‡½æ•°éƒ½å¯ä»¥è¡¨ç¤ºæˆ\(y = \beta_n x^n + \beta_{n-1} x^{n-1} + \dots + \beta_1 x + \beta_0\)</p>

<blockquote>
  <p>æ ¹æ® <strong>æ³°å‹’å…¬å¼ (Taylorâ€™s Formula)</strong>ï¼Œ<strong>åœ¨ä¸€å®šæ¡ä»¶ä¸‹</strong>ï¼Œä¸€ä¸ªå¹³æ»‘ï¼ˆå¯å¯¼ï¼‰çš„å‡½æ•° \(f(x)\) å¯ä»¥åœ¨æŸä¸€ç‚¹ \(x_0\) é™„è¿‘ç”¨ä¸€ä¸ª<strong>å¤šé¡¹å¼</strong>æ¥è¿‘ä¼¼è¡¨ç¤ºï¼š</p>

\[f(x) \approx f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + \dots + \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n\]

  <p><strong>è¿™æ­£æ˜¯å¤šé¡¹å¼å›å½’çš„ç†è®ºåŸºç¡€ï¼</strong></p>

  <p>å¤šé¡¹å¼å›å½’çš„æœ¬è´¨å°±æ˜¯åˆ©ç”¨çº¿æ€§æ¨¡å‹æ¥æ‹Ÿåˆç‰¹å¾çš„<strong>å¤šé¡¹å¼ç»„åˆ</strong>ï¼Œä»è€Œ<strong>åˆ©ç”¨æ³°å‹’å¤šé¡¹å¼çš„èƒ½åŠ›å»é€¼è¿‘æ•°æ®é›†ä¸­å­˜åœ¨çš„ä»»ä½•æ½œåœ¨çš„éçº¿æ€§å…³ç³»</strong>ã€‚</p>
</blockquote>

<p>åªéœ€é€šè¿‡ <code class="language-plaintext highlighter-rouge">PolynomialFeatures(degree=n)</code> æ¥ç”Ÿæˆ \(x\) çš„ \(n\) æ¬¡æ–¹ç›´åˆ° 1 æ¬¡æ–¹çš„ç‰¹å¾ï¼Œç„¶åå°†å…¶è¾“å…¥åˆ°çº¿æ€§å›å½’æ¨¡å‹ä¸­è¿›è¡Œæ‹Ÿåˆå³å¯ã€‚</p>

<p>æ¬¡æ•°è¶Šé«˜ï¼Œè®¡ç®—é‡<strong>ä¸ä¸€å®š</strong>æ˜¯è¶Šæ¥è¶Šå¤§çš„ï¼ˆå› ä¸ºçº¿æ€§å›å½’çš„è®¡ç®—å¤æ‚åº¦ä¸»è¦å–å†³äºæ ·æœ¬é‡ \(N\) å’Œç‰¹å¾æ•° \(P\)ï¼‰ï¼Œ<strong>ä½†æ¨¡å‹å¼•å…¥çš„é£é™©æ˜¯è¶Šæ¥è¶Šé«˜çš„ã€‚</strong>ç†ç”±å¦‚ä¸‹ï¼š</p>

<p>1.è¿‡æ‹Ÿåˆæ˜¯æœ€ä¸»è¦çš„é—®é¢˜ã€‚é«˜æ¬¡å¤šé¡¹å¼èƒ½å¤Ÿ<strong>å®Œç¾</strong>ç©¿è¿‡æ‰€æœ‰è®­ç»ƒæ•°æ®ç‚¹ï¼Œä½†å®ƒå­¦åˆ°çš„æ˜¯æ•°æ®ä¸­çš„<strong>å™ªå£°</strong>å’Œéšæœºè¯¯å·®ï¼Œè€Œä¸æ˜¯æ•°æ®èƒŒåçš„çœŸå®è§„å¾‹ã€‚è¿™ä¼šå¯¼è‡´æ¨¡å‹åœ¨<strong>æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®</strong>ä¸Šçš„æ³›åŒ–èƒ½åŠ›æå·®ã€‚</p>

<p>2.å…±çº¿æ€§ï¼šå½“ \(x\) çš„æ•°å€¼èŒƒå›´è¾ƒå¤§æ—¶ï¼Œ\(x^2, x^3, \dots, x^n\) è¿™äº›é«˜æ¬¡é¡¹ä¹‹é—´çš„ç›¸å…³æ€§ä¼šéå¸¸é«˜ï¼Œå¯¼è‡´<strong>ç‰¹å¾å…±çº¿æ€§</strong>ã€‚è¿™ä¼šä½¿å›å½’ç³»æ•° \(\beta_i\) çš„ä¼°è®¡å˜å¾—éå¸¸ä¸ç¨³å®šï¼Œå¾®å°çš„æ•°æ®å˜åŠ¨éƒ½å¯èƒ½å¯¼è‡´ç³»æ•°çš„å·¨å¤§å˜åŒ–ã€‚</p>

<p>3.è®¡ç®—é‡ã€‚è™½ç„¶å¯¹å•å˜é‡è€Œè¨€è®¡ç®—é‡å¢åŠ ä¸æ˜¾è‘—ï¼Œä½†å¯¹äº<strong>å¤šå˜é‡</strong>ï¼ˆå¦‚ \(x_1, x_2\)ï¼‰çš„é«˜æ¬¡æ¨¡å‹ï¼Œç‰¹å¾æ•°é‡ä¼šå‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œæ­¤æ—¶è®¡ç®—æ—¶é—´å’Œå†…å­˜æ¶ˆè€—ä¼šæ€¥å‰§å¢åŠ ã€‚</p>

<p>4.éšç€å¤šé¡¹å¼æ¬¡æ•°çš„å¢åŠ ï¼Œæ¨¡å‹çš„ç³»æ•°å˜å¾—éš¾ä»¥è§£é‡Šï¼Œé™ä½äº†æ¨¡å‹çš„å¯è¯»æ€§å’Œå®ç”¨æ€§ã€‚</p>

<p>å› æ­¤ï¼Œåœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬é€šå¸¸é€‰æ‹©ä¸€ä¸ª<strong>è¾ƒä½çš„æ¬¡æ•°ï¼ˆå¦‚ 2 æ¬¡æˆ– 3 æ¬¡ï¼‰</strong>ï¼Œå¹¶åœ¨æ‹Ÿåˆåº¦ï¼ˆ\(R^2\)ï¼‰å’Œæ¨¡å‹å¤æ‚åº¦ä¹‹é—´æ‰¾åˆ°æœ€ä½³çš„å¹³è¡¡ç‚¹ã€‚</p>

<p>å¦å¤–ï¼Œå¦‚æœæ¨¡å‹è¿‡æ‹Ÿåˆï¼ˆåœ¨è®­ç»ƒé›†ä¸Šå­¦ä¹ è¿‡å¤šå™ªå£°ï¼‰ï¼Œä¸ä¸€å®šåœ¨æµ‹è¯•é›†ä¸Šå°±ä¸€å®šå¥½ï¼Œæ‰€ä»¥æ¬¡æ•°ä¸€å®šä¸æ˜¯è¶Šé«˜è¶Šå¥½ã€‚ï¼ˆè™½ç„¶æ¬¡æ•°è¶Šé«˜ï¼Œæ¨¡å‹å¯¹äºè®­ç»ƒé›†çš„æ‹Ÿåˆå°±è¶Šå¥½ï¼‰ã€‚è¿™ä¹Ÿæ˜¯ä¸€ç§trade off</p>

<h1 id="4èŠ±å¼ç©æ³•-æŠ—å™ªå£°">4.èŠ±å¼ç©æ³•-æŠ—å™ªå£°</h1>

<p>è€ƒè™‘è¿™æ ·çš„é—®é¢˜ï¼ŒåŸæ¥æœ‰æ•°æ®\([X, y]\)ï¼Œç°åœ¨å¼•å…¥éšæœºäº§ç”Ÿçš„æ•°æ®\(X_2\)ï¼Œå°±æœ‰äº†\([X_1, X_2, y]\)ï¼Œè¯·é—®æœ€åå¤šå…ƒçº¿æ€§å›å½’æ‹Ÿåˆçš„\(\hat{y}=w_1X_1+w_2X_2+b\)ä¸­ï¼Œ\(w_2\)çš„å–å€¼æ˜¯ä¸æ˜¯0ï¼Ÿ</p>

<p>ç»“è®ºï¼š\(w_2\) çš„<strong>æœŸæœ›</strong>å€¼æ˜¯0ï¼Œä½†<strong>å®é™…</strong>å€¼å¯èƒ½ä¸ä¸º0</p>

<p>\(X_2\) æ˜¯å®Œå…¨éšæœºç”Ÿæˆçš„ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª \(\mathcal{N}(0, 1)\) æˆ– \(\mathcal{U}(a, b)\) åˆ†å¸ƒï¼‰ã€‚\(X_2\) ä¸åŸå§‹ç‰¹å¾ \(X_1\) <strong>å®Œå…¨ç‹¬ç«‹</strong>ï¼Œå¹¶ä¸”ä¸ç›®æ ‡å˜é‡ \(y\) <strong>å®Œå…¨ç‹¬ç«‹</strong>ï¼ˆå³å®ƒä»¬ä¹‹é—´æ²¡æœ‰çœŸå®çš„çº¿æ€§å…³ç³»ï¼‰ã€‚</p>

<p>åœ¨çº¿æ€§å›å½’ä¸­ï¼Œæ¨¡å‹çš„ç³»æ•° \(w_i\) æ—¨åœ¨æœ€å°åŒ–æ®‹å·®å¹³æ–¹å’Œï¼ˆæœ€å°äºŒä¹˜æ³•ï¼‰ã€‚å¦‚æœ \(X_2\) ä¸ \(y\) ä¹‹é—´æ²¡æœ‰çœŸå®å…³ç³»ï¼Œé‚£ä¹ˆåœ¨<strong>æ— é™å¤§çš„æ ·æœ¬é›†</strong>ä¸Šï¼Œæœ€å°åŒ–æ®‹å·®å¹³æ–¹å’Œçš„æœ€ä½³è§£æ˜¯è®¾ç½® \(w_2\) ä¸º $0$ï¼Œå› ä¸ºä»»ä½•éé›¶çš„ \(w_2\) åªä¼šå¼•å…¥é¢å¤–çš„ã€ä¸å¯è§£é‡Šçš„è¯¯å·®ã€‚</p>

\[E[w_2] = 0\]

<p><strong>å®é™…åŸå›  (æœ‰é™æ ·æœ¬é›†å’Œéšæœºè¯¯å·®)ï¼š</strong></p>

<p>åœ¨ä»»ä½•<strong>æœ‰é™çš„å®é™…æ•°æ®é›†</strong>ä¸Šï¼Œå³ä½¿ \(X_2\) æ˜¯çº¯éšæœºçš„ï¼Œå®ƒä¹Ÿä¼šç”±äº<strong>æŠ½æ ·è¯¯å·®ï¼ˆSampling Errorï¼‰å’Œéšæœºå™ªå£°</strong>è€Œå‡ºç°ä»¥ä¸‹æƒ…å†µï¼š</p>

<ul>
  <li><strong>å¶ç„¶ç›¸å…³æ€§ (Spurious Correlation)ï¼š</strong> éšæœºç”Ÿæˆçš„ \(X_2\) ä¸ç›®æ ‡å˜é‡ \(y\) ä¹‹é—´ä¼šå­˜åœ¨å¾®å¼±ã€å¶ç„¶çš„éé›¶ç›¸å…³æ€§ã€‚æœ€å°äºŒä¹˜æ³•ä¼šè¯•å›¾åˆ©ç”¨è¿™ç§å¾®å¼±çš„ã€éšæœºçš„ç›¸å…³æ€§æ¥è¿›ä¸€æ­¥ç¨å¾®é™ä½æ®‹å·®å¹³æ–¹å’Œã€‚</li>
  <li><strong>å™ªå£°å¸æ”¶ï¼š</strong> \(X_2\) å¯èƒ½ä¼šâ€œå¸æ”¶â€æ¨¡å‹ä¸­æœªè¢« \(X_1\) è§£é‡Šçš„<strong>éšæœºå™ªå£°</strong>éƒ¨åˆ†ã€‚æ¨¡å‹å¯èƒ½ä¼šå°† \(w_2\) è®¾ç½®ä¸ºä¸€ä¸ªå¾®å°çš„éé›¶å€¼ï¼Œä»¥åˆ©ç”¨ \(X_2\) çš„éšæœºæ³¢åŠ¨æ¥å¾®è°ƒæ‹Ÿåˆï¼Œä½¿ \(\sum (y - \hat{y})^2\) ç•¥å¾®å‡å°ã€‚</li>
</ul>

<p>åœ¨å®é™…è¿è¡Œä»£ç æ—¶ï¼Œæ‚¨ä¼šå‘ç°æ‹Ÿåˆå¾—åˆ°çš„ \(w_2\) æ˜¯ä¸€ä¸ª<strong>æ¥è¿‘äº 0 çš„éé›¶å°æ•°</strong></p>

<hr />

<p>ä¸‹é¢æ˜¯æ¨¡æ‹Ÿçš„ä»£ç ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># --- 1. åˆ›å»ºæ¨¡æ‹Ÿæ•°æ® ---
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># è®¾ç½®éšæœºç§å­ä»¥ä¿è¯ç»“æœå¯é‡ç°
</span><span class="n">N_SAMPLES</span> <span class="o">=</span> <span class="mi">1000</span>    <span class="c1"># æ ·æœ¬æ•°é‡
</span><span class="n">TRUE_W1</span> <span class="o">=</span> <span class="mf">5.0</span>       <span class="c1"># X1 çš„çœŸå®ç³»æ•°
</span><span class="n">TRUE_B</span> <span class="o">=</span> <span class="mf">10.0</span>       <span class="c1"># çœŸå®æˆªè·
</span>
<span class="c1"># åŸå§‹ç‰¹å¾ X1 (ä¸ y æœ‰å…³)
</span><span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">N_SAMPLES</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> 

<span class="c1"># ç›®æ ‡å˜é‡ y (åŒ…å«éšæœºå™ªå£°)
# y = 5*X1 + 10 + å™ªå£°
</span><span class="n">y</span> <span class="o">=</span> <span class="n">TRUE_W1</span> <span class="o">*</span> <span class="n">X1</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">TRUE_B</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N_SAMPLES</span><span class="p">)</span>

<span class="c1"># --- 2. å¼•å…¥éšæœºç‰¹å¾ X2 ---
# X2 æ˜¯ä¸€ä¸ªå®Œå…¨éšæœºçš„ç‰¹å¾ï¼Œä¸ X1 å’Œ y å‡ç‹¬ç«‹
</span><span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="n">N_SAMPLES</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># --- 3. ç»„åˆç‰¹å¾çŸ©é˜µ ---
# ç°åœ¨çš„ç‰¹å¾çŸ©é˜µ X åŒ…å« X1 å’Œ X2
# X.shape -&gt; (1000, 2)
</span><span class="n">X_combined</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">hstack</span><span class="p">((</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">åŸå§‹ç‰¹å¾ X1 å½¢çŠ¶: </span><span class="si">{</span><span class="n">X1</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">éšæœºç‰¹å¾ X2 å½¢çŠ¶: </span><span class="si">{</span><span class="n">X2</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ç»„åˆç‰¹å¾ X å½¢çŠ¶: </span><span class="si">{</span><span class="n">X_combined</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># --- 4. è®­ç»ƒå¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ ---
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_combined</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># --- 5. æ‰“å°ç»“æœ ---
</span><span class="n">w1_fit</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w2_fit</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">b_fit</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">intercept_</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- æ¨¡å‹æ‹Ÿåˆç»“æœ ---</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ç‰¹å¾ X1 çš„çœŸå®ç³»æ•° (w1): </span><span class="si">{</span><span class="n">TRUE_W1</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">æ‹Ÿåˆå¾—åˆ°çš„ X1 ç³»æ•° (w1): </span><span class="si">{</span><span class="n">w1_fit</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">éšæœºç‰¹å¾ X2 çš„çœŸå®ç³»æ•° (w2): 0.0000</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">æ‹Ÿåˆå¾—åˆ°çš„ X2 ç³»æ•° (w2): </span><span class="si">{</span><span class="n">w2_fit</span><span class="si">:</span><span class="p">.</span><span class="mi">8</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">æˆªè·çš„çœŸå®å€¼ (b): </span><span class="si">{</span><span class="n">TRUE_B</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">æ‹Ÿåˆå¾—åˆ°çš„æˆªè· (b): </span><span class="si">{</span><span class="n">b_fit</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20251027204319656.png" alt="image-20251027204319656" style="zoom:50%;" /></p>

<p>ä¸Šé¢çš„ä¾‹å­å¯ä»¥è¯´æ˜<strong>çº¿æ€§å›å½’å…·æœ‰æŠ—å™ªå£°çš„èƒ½åŠ›ã€‚</strong></p>

<h1 id="5èŠ±å¼ç©æ³•-å…±çº¿æ€§">5.èŠ±å¼ç©æ³•-å…±çº¿æ€§</h1>

<p>å‡è®¾æˆ‘ä»¬ä»åŸå§‹ç‰¹å¾ \(x_1\) æ„é€ äº†ä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„ç‰¹å¾ \(X_{1a} = x_1\)å’Œ \(X_{1b} = x_1\)ï¼Œå¹¶å°†å®ƒä»¬ä»£å…¥æ¨¡å‹ï¼š</p>

\[y = w_{1a} X_{1a} + w_{1b} X_{1b} + w_0\]

<p>è¿™ç§å¤åˆ¶ç‰¹å¾çš„æ“ä½œåˆ›å»ºäº†<strong>å®Œç¾çš„å…±çº¿æ€§ï¼ˆPerfect Collinearityï¼‰</strong>ï¼Œå³ç‰¹å¾ \(X_{1a}\) å’Œ \(X_{1b}\) ä¹‹é—´çš„ç›¸å…³ç³»æ•°ä¸º1ã€‚</p>

<p>çº¿æ€§å›å½’æ¨¡å‹ï¼ˆæœ€å°äºŒä¹˜æ³•ï¼‰çš„ä¼˜åŒ–ç›®æ ‡æ˜¯æ‰¾åˆ°æœ€ä¼˜çš„æƒé‡ç»„åˆ \((w_{1a}, w_{1b})\)ï¼Œä½¿å¾—æ®‹å·®å¹³æ–¹å’Œæœ€å°ã€‚</p>

<p>å‡è®¾åŸå§‹çš„çœŸå®å…³ç³»æ˜¯ \(y = W_{\text{true}} x_1 + w_0\)ã€‚</p>

<p>å½“å¼•å…¥ \(X_{1a}\) å’Œ \(X_{1b}\) æ—¶ï¼Œæ¨¡å‹è¦æ‹Ÿåˆçš„æ˜¯ï¼š</p>

\[y = w_{1a} x_1 + w_{1b} x_1 + w_0 = (w_{1a} + w_{1b}) x_1 + w_0\]

<p><strong>é—®é¢˜åœ¨äºï¼š</strong> åªè¦ä¿æŒç³»æ•°ä¹‹å’Œ \((w_{1a} + w_{1b})\) ç­‰äºåŸå§‹çš„çœŸå®ç³»æ•° \(W_{\text{true}}\)ï¼Œæ¨¡å‹çš„é¢„æµ‹ç»“æœ \(\hat{y}\) å°±ä¸ä¼šæ”¹å˜ï¼Œæ®‹å·®å¹³æ–¹å’Œï¼ˆRSSï¼‰ä¹Ÿä¿æŒä¸å˜ã€‚</p>

<p>å› æ­¤ï¼Œæ¨¡å‹æ— æ³•ç¡®å®š \(w_{1a}\) å’Œ \(w_{1b}\) çš„å…·ä½“å–å€¼ï¼Œåªè¦æ»¡è¶³ï¼š</p>

\[w_{1a} + w_{1b} = W_{\text{true}}\]

<p>å³ï¼Œå­˜åœ¨<strong>æ— ç©·å¤šç»„</strong>è§£ï¼Œå®ƒä»¬éƒ½èƒ½æœ€å°åŒ– RSSã€‚è¿™ä½¿å¾—ç³»æ•°çŸ©é˜µåœ¨æ•°å­¦ä¸Šæ˜¯<strong>å¥‡å¼‚</strong>çš„ï¼ˆä¸å¯é€†ï¼‰ï¼Œå¯¼è‡´æœ€å°äºŒä¹˜è§£å˜å¾—ä¸ç¡®å®šæˆ–ä¸ç¨³å®šã€‚</p>

<p>è¿™ç§ç°è±¡è¯´æ˜äº†çº¿æ€§å›å½’çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼š</p>

<p><strong>çº¿æ€§å›å½’å¯¹ç‰¹å¾é—´çš„å…±çº¿æ€§é«˜åº¦æ•æ„Ÿã€‚å½“ç‰¹å¾ä¹‹é—´å­˜åœ¨é«˜åº¦ç›¸å…³æ€§æ—¶ï¼Œæ¨¡å‹çš„ç³»æ•°ä¼šè¢«â€œæ‘Šæ´¾â€ï¼Œå˜å¾—ä¸ç¨³å®šã€éš¾ä»¥è§£é‡Šï¼Œå¹¶ä¸”åœ¨ä¸åŒæ•°æ®é›†ä¸Šè¿è¡Œæ—¶ï¼Œç³»æ•°çš„å–å€¼å¯èƒ½ä¼šå‘ç”Ÿå‰§çƒˆå˜åŒ–ã€‚</strong></p>

<p>å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¤„ç†å…±çº¿æ€§æ˜¯ç‰¹å¾å·¥ç¨‹çš„ä¸€ä¸ªé‡è¦ç¯èŠ‚ï¼Œå¸¸ç”¨çš„è§£å†³æ–¹æ³•åŒ…æ‹¬ï¼š</p>

<ol>
  <li><strong>ç‰¹å¾é€‰æ‹©ï¼š</strong> åˆ é™¤é‡å¤æˆ–é«˜åº¦ç›¸å…³çš„ç‰¹å¾ï¼ˆä¾‹å¦‚ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­åˆ é™¤ \(X_{1b}\)ï¼‰ã€‚</li>
  <li><strong>æ­£åˆ™åŒ–ï¼š</strong> ä½¿ç”¨ <strong>å²­å›å½’ (Ridge Regression)</strong> æˆ– <strong>Lasso å›å½’</strong>ï¼Œå®ƒä»¬é€šè¿‡å¼•å…¥æƒ©ç½šé¡¹æ¥ç¨³å®šå’Œçº¦æŸç³»æ•°ï¼Œå‡è½»å…±çº¿æ€§çš„å½±å“ã€‚</li>
</ol>

<hr />

<p><strong>åŠ å™ªå£°å¯¹äºçº¿æ€§å›å½’æ²¡æœ‰ä¼¤å®³ï¼ŒåŠ ç›¸å…³æ€§å¼ºçš„å˜é‡ä¹Ÿä¸ä¼šå¸¦æ¥å¸®åŠ©ã€‚</strong>è¿™æ˜¯çº¿æ€§å›å½’å¾ˆé‡è¦çš„ç‰¹ç‚¹ã€‚</p>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2025/10/27/AI%E6%80%9D%E6%83%B3%E5%90%AF%E8%92%9903/" data-toggle="tooltip" data-placement="top" title="ã€AIæ€æƒ³å¯è’™03ã€‘çº¿æ€§å›å½’2ä»å‚»ç“œåˆ°æ™ºèƒ½ï¼Œæ¢¯åº¦ä¸‹é™æ³•å­¦ä¹ æ³•">
                        Previous<br>
                        <span>ã€AIæ€æƒ³å¯è’™03ã€‘çº¿æ€§å›å½’2ä»å‚»ç“œåˆ°æ™ºèƒ½ï¼Œæ¢¯åº¦ä¸‹é™æ³•å­¦ä¹ æ³•</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2025/11/12/redis01%E5%85%A5%E9%97%A8%E4%BB%8E%E7%A3%81%E7%9B%98%E7%93%B6%E9%A2%88%E5%88%B0Redis%E5%86%85%E5%AD%98%E7%8E%8B%E8%80%85-%E7%BC%93%E5%AD%98%E4%BD%93%E7%B3%BB%E5%85%A8%E8%A7%A3%E6%9E%90/" data-toggle="tooltip" data-placement="top" title="ã€rediså…¥é—¨ä¸å®æ“-01ã€‘ä»ç£ç›˜ç“¶é¢ˆåˆ°Rediså†…å­˜ç‹è€…ï¼šç¼“å­˜ä½“ç³»å…¨è§£æ">
                        Next<br>
                        <span>ã€rediså…¥é—¨ä¸å®æ“-01ã€‘ä»ç£ç›˜ç“¶é¢ˆåˆ°Rediså†…å­˜ç‹è€…ï¼šç¼“å­˜ä½“ç³»å…¨è§£æ</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0187" 
                    href="/archive/?tag=%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB"
                    title="ä¹¦ç±é˜…è¯»"
                    rel="3">ä¹¦ç±é˜…è¯»</a>
        
                <a data-sort="0149" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95"
                    title="ç®—æ³•"
                    rel="41">ç®—æ³•</a>
        
                <a data-sort="0172" 
                    href="/archive/?tag=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI%E5%9F%BA%E7%A1%80"
                    title="äººå·¥æ™ºèƒ½AIåŸºç¡€"
                    rel="18">äººå·¥æ™ºèƒ½AIåŸºç¡€</a>
        
                <a data-sort="0173" 
                    href="/archive/?tag=python%E5%9F%BA%E7%A1%80"
                    title="pythonåŸºç¡€"
                    rel="17">pythonåŸºç¡€</a>
        
                <a data-sort="0175" 
                    href="/archive/?tag=%E5%8A%9B%E6%89%A3"
                    title="åŠ›æ‰£"
                    rel="15">åŠ›æ‰£</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=AI%E6%80%9D%E6%83%B3%E5%90%AF%E8%92%99"
                    title="AIæ€æƒ³å¯è’™"
                    rel="13">AIæ€æƒ³å¯è’™</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=numpy"
                    title="numpy"
                    rel="13">numpy</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=pandas"
                    title="pandas"
                    rel="13">pandas</a>
        
                <a data-sort="0178" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%90%B4%E6%81%A9%E8%BE%BE"
                    title="æœºå™¨å­¦ä¹ -å´æ©è¾¾"
                    rel="12">æœºå™¨å­¦ä¹ -å´æ©è¾¾</a>
        
                <a data-sort="0179" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95"
                    title="æœºå™¨å­¦ä¹ ç®—æ³•"
                    rel="11">æœºå™¨å­¦ä¹ ç®—æ³•</a>
        
                <a data-sort="0184" 
                    href="/archive/?tag=matplotlib"
                    title="matplotlib"
                    rel="6">matplotlib</a>
        
                <a data-sort="0187" 
                    href="/archive/?tag=spring6"
                    title="spring6"
                    rel="3">spring6</a>
        
                <a data-sort="0188" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95%E9%A2%98%E5%BA%93"
                    title="ç®—æ³•é¢˜åº“"
                    rel="2">ç®—æ³•é¢˜åº“</a>
        
                <a data-sort="0188" 
                    href="/archive/?tag=Java%E5%9F%BA%E7%A1%80"
                    title="JavaåŸºç¡€"
                    rel="2">JavaåŸºç¡€</a>
        
                <a data-sort="0188" 
                    href="/archive/?tag=java%E9%9B%86%E5%90%88"
                    title="javaé›†åˆ"
                    rel="2">javaé›†åˆ</a>
        
                <a data-sort="0188" 
                    href="/archive/?tag=ollama%E5%B7%A5%E5%85%B7"
                    title="ollamaå·¥å…·"
                    rel="2">ollamaå·¥å…·</a>
        
                <a data-sort="0188" 
                    href="/archive/?tag=python%E7%88%AC%E8%99%AB"
                    title="pythonçˆ¬è™«"
                    rel="2">pythonçˆ¬è™«</a>
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://m.freebuf.com/">freebuf</a></li>
  
  <li><a href="https://xz.aliyun.com/">å…ˆçŸ¥</a></li>
  
  <li><a href="https://www.sec-in.com/All">sec-in</a></li>
  
  <li><a href="https://paper.seebug.org/">see-bug</a></li>
  
  <li><a href="https://twitter.com/Concurr21486093">æˆ‘çš„æ¨ç‰¹</a></li>
  
  <li><a href="https://pdai.tech/">pdai</a></li>
  
  <li><a href="https://nodejs.org/dist/">nodejs index of dist</a></li>
  
  <li><a href="#">å…¬ä¼—å·ï¼šå°ä¸œæ–¹ä¸è´¥</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/Concurr21486093">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/Hilda">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">çŸ¥</i>
      </span>
    </a>
  </li>
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/kirsten-1">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Hilda 2025
                    <br>
                    Powered by <a href="https://kirsten-1.github.io/">hilda Blog</a>
<!--                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"-->
<!--                        height="20px"-->
<!--                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">-->
<!--                    </iframe>-->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
