<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="这里是 Hilda 的个人博客，与你一起发现更大的世界 | 要做一个有 swag 的程序员">
    <meta name="keywords" content="Hilda">
    <meta name="theme-color" content="#000000">

    <!-- Open Graph -->
    <meta property="og:title"
        content="python基础-函数 - Hilda的博客 | Your genius girlfriend's blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="

">
    
    <meta property="article:published_time" content=" 2025-07-02T00:00:00Z">
    
    
    <meta property="article:author" content="Hilda">
    
    
    <meta property="article:tag" content="python基础">
    
    
    <meta property="og:image" content="https://kirsten-1.github.io">
    <meta property="og:url" content="https://kirsten-1.github.io/2025/07/02/python%E5%9F%BA%E7%A1%8010%E5%87%BD%E6%95%B0/">
    <meta property="og:site_name" content="Hilda的博客 | Your genius girlfriend's blog">

    <title>python基础-函数 - Hilda的博客 | Your genius girlfriend's blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://kirsten-1.github.io/2025/07/02/python%E5%9F%BA%E7%A1%8010%E5%87%BD%E6%95%B0/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href=" /css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"
        type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-6487568398225121" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Hilda</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-2015.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-bg-2015.jpg');
        background: ;
    }

    
</style>




<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=python%E5%9F%BA%E7%A1%80" title="python基础">python基础</a>
                        
                    </div>
                    <h1>python基础-函数</h1>
                    
                    <h2 class="subheading">函数是可复用代码块，通过def定义，调用时执行特定任务。Python函数支持“一等公民”特性，可赋值、传递、嵌套。参数传递为对象引用，需注意可变与不可变对象的不同行为及默认参数陷阱。返回值可单个、多个或None，遵循LEGB作用域规则。递归函数通过基本情况和递归步骤解决问题，需注意性能和栈溢出风险</h2>
                    <span class="meta">Posted by Hilda on July 2, 2025</span>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>

<h1 id="1函数的创建和调用">1、函数的创建和调用</h1>

<blockquote>
  <p>函数就是执行特定任和以完成特定功能的一段代码。</p>

  <p>为什么需要函数？</p>

  <ul>
    <li>复用代码</li>
    <li>隐藏实现细节</li>
    <li>可维护性</li>
    <li>可调试性</li>
    <li>可读性</li>
  </ul>
</blockquote>

<p>函数是组织良好、可重用的代码块，用于执行特定任务。在Python中，使用 def 关键字创建函数，并通过函数名后跟括号 () 来调用。</p>

<p>函数是Python中的“一等公民”（first-class citizens），这意味着它们可以像其他数据类型（如整数、字符串）一样被赋值给变量、作为参数传递给其他函数、或者作为其他函数的返回值。这种特性是函数式编程范式的基石。</p>

<p>● <strong>创建 (定义)：</strong> 使用 <code class="language-plaintext highlighter-rouge">def</code> 关键字后跟函数名、参数列表（可选）和冒号 <code class="language-plaintext highlighter-rouge">:</code>。函数体必须缩进。</p>

<p>● <strong>调用：</strong> 通过函数名后跟圆括号<code class="language-plaintext highlighter-rouge"> ()</code> 来执行函数。如果函数定义了参数，调用时需要提供相应数量和类型的实参。</p>

<blockquote>
  <p>当Python解释器遇到 def 语句时，它不会立即执行函数体内的代码。相反，它会做以下几件事：</p>

  <ul>
    <li>
      <p><strong>创建函数对象：</strong> 解释器会创建一个<strong>函数对象</strong>（<strong>一个 function 类的实例</strong>）。这个对象包含了函数的<strong>元数据</strong>，如函数名、参数信息、函数体的字节码（编译后的代码）以及<strong>函数定义时的作用域（闭包）</strong>。</p>
    </li>
    <li>
      <p><strong>绑定名称：</strong> 将这个函数对象绑定到函数名上。例如，<code class="language-plaintext highlighter-rouge">def my_func(): ... </code>会在当前作用域中创建一个名为 <code class="language-plaintext highlighter-rouge">my_func</code> 的变量，其值就是新创建的函数对象。</p>
    </li>
  </ul>

  <p>当函数被调用时：</p>

  <ul>
    <li>
      <p><strong>查找函数对象：</strong> 解释器通过函数名查找对应的函数对象。</p>
    </li>
    <li>
      <p><strong>创建新的栈帧 (Stack Frame)：</strong> 为这次函数调用创建一个新的执行环境，也称为<strong>栈帧</strong>。这个栈帧包含了函数的局部变量、参数以及返回地址等信息。</p>
    </li>
    <li>
      <p><strong>参数绑定：</strong> 将调用时传入的实参绑定到函数定义时的形参上。</p>
    </li>
    <li>
      <p><strong>执行函数体：</strong> 解释器开始执行函数对象中存储的字节码。</p>
    </li>
    <li>
      <p><strong>销毁栈帧：</strong> 函数执行完毕（遇到 <code class="language-plaintext highlighter-rouge">return </code>语句或函数体结束）后，其对应的栈帧被销毁，控制权返回到调用点。</p>
    </li>
  </ul>

  <p>这种机制确保了函数调用的独立性，每次调用都有自己的局部变量副本，互不干扰。</p>
</blockquote>

<h2 id="1函数的创建">（1）函数的创建</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    这是一个简单的问候函数。
    它接受一个名字作为参数，并打印问候语。
    </span><span class="sh">'''</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
<span class="nf">greet</span><span class="p">(</span><span class="sh">"</span><span class="s">Alice</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">greet</span><span class="p">(</span><span class="sh">"</span><span class="s">Bob</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add2Num</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    计算并且返回两个数的和
    </span><span class="sh">'''</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">res1</span> <span class="o">=</span> <span class="nf">add2Num</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">10+20是:</span><span class="si">{</span><span class="n">res1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="nf">add2Num</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">100+800是:</span><span class="si">{</span><span class="n">res2</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701200714467.png" alt="image-20250701200714467" style="zoom:50%;" /></p>

<h2 id="2函数的调用">（2）函数的调用</h2>

<p>上面两个函数：<code class="language-plaintext highlighter-rouge">greet(name)</code>和<code class="language-plaintext highlighter-rouge">add2Num(a, b)</code>的调用也已经在代码中给出了。</p>

<p>【1】下面解释：函数是“一等公民”的体现：<strong>可以将函数赋值给变量</strong>，然后通过变量调用函数</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">my_greeting_func</span> <span class="o">=</span> <span class="n">greet</span>
<span class="nf">my_greeting_func</span><span class="p">(</span><span class="sh">"</span><span class="s">Charlie</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701200857839.png" alt="image-20250701200857839" style="zoom:50%;" /></p>

<p>【2】可以在函数内部定义和调用其他函数 (嵌套函数)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">outer_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner_fun</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">return</span> <span class="nf">inner_fun</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="nf">outer_fun</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701201105754.png" alt="image-20250701201105754" style="zoom:50%;" /></p>

<p>【3】函数可以作为参数传递给其他函数</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">add2Num</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    计算并且返回两个数的和
    </span><span class="sh">'''</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">apply_operation</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">func</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)</span>
<span class="n">res_add</span> <span class="o">=</span> <span class="nf">apply_operation</span><span class="p">(</span><span class="n">add2Num</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res_add</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701204600960.png" alt="image-20250701204600960" style="zoom:50%;" /></p>

<hr />

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702163937789.png" alt="image-20250702163937789" style="zoom:50%;" /></p>

<h1 id="2函数的参数传递">2、函数的参数传递</h1>

<p>Python的参数传递机制是“<strong>按对象引用传递</strong>”（Call by Object Reference），这意味着函数<strong>接收的是实参所指向的对象的引用</strong>。<strong>对于不可变对象，形参的重新赋值不会影响实参；对于可变对象，通过形参对对象内容的修改会影响到实参。</strong></p>

<p>理解Python的参数传递机制对于避免副作用和编写健壮的代码至关重要。Python既不是严格的“按值传递”（Call by Value），也不是严格的“按引用传递”（Call by Reference），而是“按对象引用传递”。</p>

<p>● <strong>不可变对象 (Immutable Objects)：</strong> 数字 (int, float, complex)、字符串 (str)、元组 (tuple)、frozenset。</p>

<ul>
  <li>
    <p>当不可变对象作为参数传递时，函数内部的形参会获得该对象的引用。</p>
  </li>
  <li>
    <p>如果在函数内部尝试修改形参的值（例如 <code class="language-plaintext highlighter-rouge">param = new_value</code>），这实际上是<strong>让形参指向了一个新的对象，而原始的实参对象不受影响。</strong></p>
  </li>
  <li>
    <p><strong>原理：</strong> 由于不可变对象的值不能改变，任何看似“修改”的操作都会创建一个新的对象。形参被重新绑定到这个新对象，而实参仍然指向原来的对象。</p>
  </li>
</ul>

<p>● <strong>可变对象 (Mutable Objects)：</strong> 列表 (list)、字典 (dict)、集合 (set)、自定义类的实例。</p>

<ul>
  <li>
    <p>当可变对象作为参数传递时，函数内部的形参同样获得该对象的引用。</p>
  </li>
  <li>
    <p>如果在函数内部通过形参修改了对象的<strong>内容</strong>（例如 <code class="language-plaintext highlighter-rouge">list_param.append(item) </code>或 <code class="language-plaintext highlighter-rouge">dict_param['key'] = value</code>），这些修改会直接作用于原始实参所指向的对象，因此在函数外部也能看到这些变化。</p>
  </li>
  <li>
    <p><strong>如果在函数内部将形参重新赋值为一个新的对象（例如 <code class="language-plaintext highlighter-rouge">list_param = [1, 2, 3]</code>），则与不可变对象类似，形参会指向新对象，而原始实参不受影响。</strong></p>
  </li>
</ul>

<p><strong>原理：</strong> 可变对象在内存中有一个固定的地址，但其内部的数据结构可以被修改。形参和实参都指向这个相同的内存地址，因此通过任何一个引用进行的修改都会反映在同一个对象上。</p>

<h2 id="1不可变对象作为参数">（1）不可变对象作为参数</h2>

<p>函数外部变量的值没有改变，因为形参的重新赋值只是改变了形参的指向，而没有改变实参所指向的对象。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">modify_immutable</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">my_tuple</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数内部 - 初始值: num=</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s">, text=</span><span class="sh">'</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">'</span><span class="s">, my_tuple=</span><span class="si">{</span><span class="n">my_tuple</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">num</span> <span class="o">+=</span> <span class="mi">100</span>  <span class="c1"># 重新绑定num到新的整数对象
</span>    <span class="n">text</span> <span class="o">+=</span> <span class="sh">"</span><span class="s"> World</span><span class="sh">"</span>  <span class="c1"># 重新绑定text到新的字符串对象
</span>    <span class="n">my_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># 重新绑定my_tuple到新的元组对象
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数内部 - 修改后: num=</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s">, text=</span><span class="sh">'</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="sh">'</span><span class="s">, my_tuple=</span><span class="si">{</span><span class="n">my_tuple</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>


<span class="n">my_num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">my_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Hello</span><span class="sh">"</span>
<span class="n">my_tuple_orig</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数外部 - 调用前: my_num=</span><span class="si">{</span><span class="n">my_num</span><span class="si">}</span><span class="s">, my_text=</span><span class="sh">'</span><span class="si">{</span><span class="n">my_text</span><span class="si">}</span><span class="sh">'</span><span class="s">, my_tuple_orig=</span><span class="si">{</span><span class="n">my_tuple_orig</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">modify_immutable</span><span class="p">(</span><span class="n">my_num</span><span class="p">,</span> <span class="n">my_text</span><span class="p">,</span> <span class="n">my_tuple_orig</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数外部 - 调用后: my_num=</span><span class="si">{</span><span class="n">my_num</span><span class="si">}</span><span class="s">, my_text=</span><span class="sh">'</span><span class="si">{</span><span class="n">my_text</span><span class="si">}</span><span class="sh">'</span><span class="s">, my_tuple_orig=</span><span class="si">{</span><span class="n">my_tuple_orig</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701220233167.png" alt="image-20250701220233167" style="zoom:50%;" /></p>

<h2 id="2可变对象作为参数">（2）可变对象作为参数</h2>

<p>若参数是列表和字典，内容会被修改。函数内部对形参的重新赋值没有影响外部。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">modify_mutable</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="n">my_dict</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数内部 - 初始值: my_list=</span><span class="si">{</span><span class="n">my_list</span><span class="si">}</span><span class="s">, my_dict=</span><span class="si">{</span><span class="n">my_dict</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">my_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># 修改列表内容
</span>    <span class="n">my_dict</span><span class="p">[</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># 修改字典内容
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数内部 - 内容修改后: my_list=</span><span class="si">{</span><span class="n">my_list</span><span class="si">}</span><span class="s">, my_dict=</span><span class="si">{</span><span class="n">my_dict</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
    <span class="n">my_dict</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数内部 - 形参重新赋值后: my_list=</span><span class="si">{</span><span class="n">my_list</span><span class="si">}</span><span class="s">, my_dict=</span><span class="si">{</span><span class="n">my_dict</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>


<span class="n">my_list_orig</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">my_dict_orig</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数外部 - 调用前: my_list_orig=</span><span class="si">{</span><span class="n">my_list_orig</span><span class="si">}</span><span class="s">, my_dict_orig=</span><span class="si">{</span><span class="n">my_dict_orig</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">modify_mutable</span><span class="p">(</span><span class="n">my_list_orig</span><span class="p">,</span> <span class="n">my_dict_orig</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">函数外部 - 调用后: my_list_orig=</span><span class="si">{</span><span class="n">my_list_orig</span><span class="si">}</span><span class="s">, my_dict_orig=</span><span class="si">{</span><span class="n">my_dict_orig</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701220443308.png" alt="image-20250701220443308" style="zoom:50%;" /></p>

<h2 id="3默认参数的可变对象陷阱">（3）默认参数的可变对象陷阱</h2>

<p><strong>默认参数在函数定义时被评估一次</strong>（这个空列表 <code class="language-plaintext highlighter-rouge">[]</code> <strong>只在函数定义时创建一次</strong>。它不是在每次调用 <code class="language-plaintext highlighter-rouge">my_function</code> 时都重新创建一个）。由于默认参数是同一个可变对象，每次调用如果没有显式提供新参数，就会修改这个共享的对象。这导致了函数调用的“副作用”，即函数的行为不再独立，而是受之前调用留下的状态影响。对于不可变对象（如数字、字符串、元组、<code class="language-plaintext highlighter-rouge">None</code>），这没有问题。但对于可变对象（如列表、字典、集合），这意味着所有后续调用（在没有显式提供该参数的情况下）都将引用并修改同一个对象，导致意想不到的行为。</p>

<p>解决办法是使用 <code class="language-plaintext highlighter-rouge">None</code> 作为默认值，并在函数体内部检查 <code class="language-plaintext highlighter-rouge">None</code>，然后惰性地创建可变对象。通过这种方式，我们确保了在没有显式提供参数的情况下，每次函数调用都会操作一个独立的、新创建的可变对象，从而避免了共享默认可变对象带来的意外行为。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">add_to_list</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">my_list</span><span class="o">=</span><span class="p">[]):</span> <span class="c1"># 默认参数是一个可变对象
</span>    <span class="n">my_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">my_list</span>

<span class="n">list1</span> <span class="o">=</span> <span class="nf">add_to_list</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第一次调用: </span><span class="si">{</span><span class="n">list1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># [1]
</span>
<span class="n">list2</span> <span class="o">=</span> <span class="nf">add_to_list</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 预期 [2] 但实际是 [1, 2]
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第二次调用: </span><span class="si">{</span><span class="n">list2</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># [1, 2] - 陷阱！
</span>
<span class="n">list3</span> <span class="o">=</span> <span class="nf">add_to_list</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[])</span> <span class="c1"># 显式提供列表，避免陷阱
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第三次调用 (显式提供列表): </span><span class="si">{</span><span class="n">list3</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># [3]
</span>
<span class="c1"># 避免陷阱的正确做法
</span><span class="k">def</span> <span class="nf">add_to_list_safe</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">my_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">my_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">my_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">my_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">my_list</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- 避免默认参数可变对象陷阱 ---</span><span class="sh">"</span><span class="p">)</span>
<span class="n">list_safe1</span> <span class="o">=</span> <span class="nf">add_to_list_safe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">安全方式第一次调用: </span><span class="si">{</span><span class="n">list_safe1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># [1]
</span>
<span class="n">list_safe2</span> <span class="o">=</span> <span class="nf">add_to_list_safe</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">安全方式第二次调用: </span><span class="si">{</span><span class="n">list_safe2</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># [2]
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701220708720.png" alt="image-20250701220708720" style="zoom:50%;" /></p>

<h1 id="3函数的返回值">3、函数的返回值</h1>

<p>函数可以通过 return 语句将值传递回调用方。一个函数可以返回任何类型的对象，包括多个值（作为元组返回）或不返回任何值（隐式返回 None）。</p>

<p>return 语句用于退出函数并将一个值（或多个值）传回给调用它的代码。</p>

<p>● <strong>单个返回值：</strong> 最常见的情况，return expression 将 expression 的结果作为返回值。</p>

<p>● <strong>多个返回值：</strong> Python允许函数返回多个值，实际上是将这些值打包成一个<strong>元组</strong>返回。调用方可以通过元组解包来获取这些值。</p>

<p>● <strong>无返回值：</strong> 如果函数没有 return 语句，或者只有 return 而没有指定值，函数将隐式返回特殊值 None。None 是Python中的一个单例对象，表示“无”或“空”。</p>

<p>● <strong>提前退出：</strong> return 语句会立即终止函数的执行，即使后面还有代码。</p>

<blockquote>
  <p>当解释器执行到 return 语句时：</p>

  <ul>
    <li>
      <p><strong>计算返回值：</strong> return 后面的表达式会被计算。</p>
    </li>
    <li>
      <p><strong>栈帧销毁与值传递：</strong> 当前函数的栈帧被销毁。计算出的返回值被放置在一个特殊的位置（通常是CPU寄存器或栈上的特定位置），以便调用函数能够访问到它。</p>
    </li>
    <li>
      <p><strong>控制权返回：</strong> 程序执行的控制权从被调用的函数跳转回调用它的代码行。调用函数可以捕获这个返回值，并将其赋值给一个变量。</p>
    </li>
  </ul>

  <p>对于多个返回值，Python的实现机制是：在 return 语句中，多个值被自动打包成一个元组，然后这个元组作为单个对象返回。调用方在接收时，如果使用多个变量来接收，Python会自动进行元组解包。</p>
</blockquote>

<h2 id="1返回单个值">（1）返回单个值</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_square</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">num</span> <span class="o">*</span> <span class="n">num</span>
<span class="n">res_square</span> <span class="o">=</span> <span class="nf">get_square</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">5的平方是:</span><span class="si">{</span><span class="n">res_square</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="2返回多个值-作为元组返回可解包">（2）返回多个值 (作为元组返回，可解包)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_user_info</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">user_id</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">Alice</span><span class="sh">"</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sh">"</span><span class="s">Engineer</span><span class="sh">"</span>
    <span class="k">elif</span> <span class="n">user_id</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">Bob</span><span class="sh">"</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="sh">"</span><span class="s">Designer</span><span class="sh">"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

<span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">occupation</span> <span class="o">=</span> <span class="nf">get_user_info</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">姓名:</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">, 年龄:</span><span class="si">{</span><span class="n">age</span><span class="si">}</span><span class="s">, 职业:</span><span class="si">{</span><span class="n">occupation</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 也可以不解包，直接接收元组
</span><span class="n">user_info_tuple</span> <span class="o">=</span> <span class="nf">get_user_info</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">用户信息：</span><span class="si">{</span><span class="n">user_info_tuple</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 处理不存在的用户
</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">occupation</span> <span class="o">=</span> <span class="nf">get_user_info</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">用户99的信息: 姓名=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">, 年龄=</span><span class="si">{</span><span class="n">age</span><span class="si">}</span><span class="s">, 职业=</span><span class="si">{</span><span class="n">occupation</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701224947013.png" alt="image-20250701224947013" style="zoom:50%;" /></p>

<p>再看一个例子：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
    <span class="n">odd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">even</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">odd</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">even</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">odd</span><span class="p">,</span><span class="n">even</span>
<span class="n">res</span> <span class="o">=</span> <span class="nf">fun</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702164210957.png" alt="image-20250702164210957" style="zoom:50%;" /></p>

<h2 id="3无返回值-隐式返回-none">（3）无返回值 (隐式返回 None)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">print_message</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">消息：</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">return_value</span> <span class="o">=</span> <span class="nf">print_message</span><span class="p">(</span><span class="sh">"</span><span class="s">Hello there!</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">print_message 函数的返回值: </span><span class="si">{</span><span class="n">return_value</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># 输出 None
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701225108838.png" alt="image-20250701225108838" style="zoom:50%;" /></p>

<h2 id="4提前退出函数">（4）提前退出函数</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">find_first_even</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
        <span class="c1"># 找到第一个偶数后立即返回
</span>        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">num</span>
    <span class="k">return</span> <span class="sh">"</span><span class="s">没有偶数</span><span class="sh">"</span>


<span class="n">res1</span> <span class="o">=</span> <span class="nf">find_first_even</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[1, 3, 5, 7]中：</span><span class="si">{</span><span class="n">res1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="nf">find_first_even</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[1, 3, 5, 6]中：</span><span class="si">{</span><span class="n">res2</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701225357906.png" alt="image-20250701225357906" style="zoom:50%;" /></p>

<h1 id="4函数的参数定义">4、函数的参数定义</h1>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702164239248.png" alt="image-20250702164239248" /></p>

<p>Python提供了灵活的参数定义方式，包括位置参数、关键字参数、默认参数、可变位置参数 (<code class="language-plaintext highlighter-rouge">*args</code>)、可变关键字参数 (<code class="language-plaintext highlighter-rouge">**kwargs</code>)，以及Python 3引入的仅位置参数 (<code class="language-plaintext highlighter-rouge">/</code>) 和仅关键字参数 (<code class="language-plaintext highlighter-rouge">*</code>)。</p>

<ul>
  <li><strong>位置参数 (Positional Arguments)：</strong></li>
</ul>

<p>○ 按照参数定义的顺序进行匹配。</p>

<p>○ 调用时必须提供，且顺序必须与定义时一致。</p>

<p>○ <strong>示例：</strong> <code class="language-plaintext highlighter-rouge">def func(a, b):</code></p>

<ul>
  <li><strong>关键字参数 (Keyword Arguments)：</strong></li>
</ul>

<p>○ 在调用时通过 <code class="language-plaintext highlighter-rouge">param_name=value </code>的形式指定，与定义时的顺序无关。</p>

<p>○ 提高了代码的可读性，尤其是在函数有多个参数时。</p>

<p>○ <strong>示例：</strong><code class="language-plaintext highlighter-rouge"> func(b=20, a=10)</code></p>

<ul>
  <li><strong>默认参数 (Default Arguments)：</strong></li>
</ul>

<p>○ 在定义时为参数指定一个默认值。如果调用时没有为该参数提供实参，则使用默认值。</p>

<p>○ 默认参数必须放在非默认参数之后。</p>

<p>○ <strong>重要陷阱：</strong> 默认值在函数定义时只计算一次。如果默认值是可变对象（如列表、字典），那么所有不提供该参数的函数调用将共享同一个可变对象，可能导致意外的副作用。</p>

<p>○ <strong>示例：</strong> <code class="language-plaintext highlighter-rouge">def func(a, b=10):</code></p>

<ul>
  <li><strong>可变位置参数 (<code class="language-plaintext highlighter-rouge">*args</code>)：</strong></li>
</ul>

<p>○ 允许函数接受任意数量的位置参数。</p>

<p>○ 在函数内部，<code class="language-plaintext highlighter-rouge">*args</code> 会被收集为一个<strong>元组</strong> (tuple)。</p>

<p>○ <code class="language-plaintext highlighter-rouge">*args</code> 必须放在所有普通参数和默认参数之后，但在 <code class="language-plaintext highlighter-rouge">**kwargs</code> 之前。</p>

<p>○ <strong>示例：</strong><code class="language-plaintext highlighter-rouge"> def func(a, *args):</code></p>

<ul>
  <li><strong>可变关键字参数 (**kwargs)：</strong></li>
</ul>

<p>○ 允许函数接受任意数量的关键字参数。</p>

<p>○ 在函数内部，<code class="language-plaintext highlighter-rouge">**kwargs</code> 会被收集为一个<strong>字典</strong> (dict)，其中键是参数名，值是参数值。</p>

<p>○ <code class="language-plaintext highlighter-rouge">**kwargs </code>必须是函数定义中的最后一个参数。</p>

<p>○ <strong>示例：</strong> <code class="language-plaintext highlighter-rouge">def func(a, **kwargs):</code></p>

<ul>
  <li><strong>仅位置参数 (<code class="language-plaintext highlighter-rouge">/</code>) (Python 3.8+)：</strong></li>
</ul>

<p>○ <code class="language-plaintext highlighter-rouge">def func(a, b, /, c, d):</code></p>

<p>○ 在 <code class="language-plaintext highlighter-rouge">/</code> 之前的参数 (a, b) 只能通过位置传递，不能通过关键字传递。</p>

<p>○ 提高了API的清晰度，防止用户依赖参数名。</p>

<ul>
  <li><strong>仅关键字参数 (<code class="language-plaintext highlighter-rouge">*</code>)：</strong></li>
</ul>

<p>○ <code class="language-plaintext highlighter-rouge">def func(a, *, b, c):</code></p>

<p>○ 在 <code class="language-plaintext highlighter-rouge">*</code> 之后的参数 (b, c) 只能通过关键字传递，不能通过位置传递。</p>

<p>○ <code class="language-plaintext highlighter-rouge">*</code> 可以单独使用，也可以与 <code class="language-plaintext highlighter-rouge">*args </code>结合使用（此时 <code class="language-plaintext highlighter-rouge">*args </code>在 <code class="language-plaintext highlighter-rouge">*</code> 之后）。</p>

<p>○ <strong>示例：</strong> <code class="language-plaintext highlighter-rouge">def func(*, b, c):</code> 或<code class="language-plaintext highlighter-rouge"> def func(a, *args, b, c):</code></p>

<hr />

<p>一个函数定义中，参数的顺序必须是：</p>

<p><code class="language-plaintext highlighter-rouge">def func(位置参数, 仅位置参数/, 默认参数, *args, 仅关键字参数*, **kwargs):</code></p>

<blockquote>
  <p>Python解释器在解析函数定义时，会根据这些特殊语法（如 <code class="language-plaintext highlighter-rouge">*</code>,<code class="language-plaintext highlighter-rouge"> **</code>,<code class="language-plaintext highlighter-rouge"> /</code>）来构建函数的签名（signature）。这个签名定义了函数接受参数的规则。</p>

  <p>当函数被调用时，解释器会根据调用时提供的实参（位置或关键字）与函数签名进行匹配：</p>

  <p>● <strong>位置匹配：</strong> 按照从左到右的顺序，将实参绑定到形参。</p>

  <p>● <strong>关键字匹配：</strong> 将实参的关键字名与形参名进行匹配。</p>

  <p>● <strong><code class="language-plaintext highlighter-rouge">*args</code> 和 <code class="language-plaintext highlighter-rouge">**kwargs</code> 的收集：</strong> 如果有未被普通形参接收的位置实参，它们会被收集到 <code class="language-plaintext highlighter-rouge">*args </code>元组中。如果有多余的关键字实参，它们会被收集到 <code class="language-plaintext highlighter-rouge">**kwargs </code>字典中。</p>

  <p>● <strong>仅位置/仅关键字参数的强制：</strong> <code class="language-plaintext highlighter-rouge">/</code> 和<code class="language-plaintext highlighter-rouge"> * </code>符号在解析阶段就强制了参数的传递方式，如果违反规则，会在调用时立即抛出 <code class="language-plaintext highlighter-rouge">TypeError</code>。</p>

  <p>这种灵活的参数机制使得Python函数能够适应各种复杂的调用场景，并提供清晰的API设计。</p>
</blockquote>

<hr />

<h2 id="1位置参数和关键字参数">（1）位置参数和关键字参数</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">describe_person</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">city</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">name</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">age</span><span class="o">=</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">city</span><span class="o">=</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 位置参数
</span><span class="nf">describe_person</span><span class="p">(</span><span class="sh">"</span><span class="s">黎明</span><span class="sh">"</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="sh">"</span><span class="s">北京</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 关键字参数，顺序无关
</span><span class="nf">describe_person</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">Adele</span><span class="sh">"</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="sh">"</span><span class="s">London</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 位置参数不能在关键字参数之后, 报错
# describe_person("Halsey", city="布鲁克林区", 30)
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701232045316.png" alt="image-20250701232045316" style="zoom:50%;" /></p>

<h2 id="2默认参数">（2）默认参数</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">Guest</span><span class="sh">"</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="sh">"</span><span class="s">Hello</span><span class="sh">"</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 使用【所有的】默认参数
</span><span class="nf">greet</span><span class="p">()</span>
<span class="c1"># 覆盖 name
</span><span class="nf">greet</span><span class="p">(</span><span class="sh">"</span><span class="s">Adele</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 覆盖 message
</span><span class="nf">greet</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="sh">"</span><span class="s">Hi</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 覆盖所有
</span><span class="nf">greet</span><span class="p">(</span><span class="sh">"</span><span class="s">Halsey</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Welcome!</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701232321615.png" alt="image-20250701232321615" style="zoom:50%;" /></p>

<h2 id="3可变位置参数">（3）可变位置参数</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">sum_all_numbers</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">*</span><span class="n">numbers</span><span class="p">):</span>
    <span class="n">sum_all</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">numbers</span><span class="si">}</span><span class="s"> 的总和是:</span><span class="si">{</span><span class="n">sum_all</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">sum_all_numbers</span><span class="p">(</span><span class="sh">"</span><span class="s">计算和</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nf">sum_all_numbers</span><span class="p">(</span><span class="sh">"</span><span class="s">另一个和</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="nf">sum_all_numbers</span><span class="p">(</span><span class="sh">"</span><span class="s">空和</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># numbers 会是一个空元组 ()
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250701232610784.png" alt="image-20250701232610784" style="zoom:50%;" /></p>

<h2 id="4可变关键字参数">（4）可变关键字参数</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">print_user_details</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">details</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">用户:</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">,</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">details</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">key</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">).</span><span class="nf">title</span><span class="p">()</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>


<span class="nf">print_user_details</span><span class="p">(</span><span class="sh">"</span><span class="s">Alice</span><span class="sh">"</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="sh">"</span><span class="s">New York</span><span class="sh">"</span><span class="p">,</span> <span class="n">occupation</span><span class="o">=</span><span class="sh">"</span><span class="s">engineer</span><span class="sh">"</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="sh">"</span><span class="s">备注无</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print_user_details</span><span class="p">(</span><span class="sh">"</span><span class="s">Bob</span><span class="sh">"</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="sh">"</span><span class="s">Bob@Example.com</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702113124378.png" alt="image-20250702113124378" style="zoom:50%;" /></p>

<h2 id="5仅位置参数--和-仅关键字参数----python-38">（5）仅位置参数 (/) 和 仅关键字参数 (*) - Python 3.8+</h2>

<p>目前我的python 版本是：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">run</span><span class="p">([</span><span class="sh">"</span><span class="s">python</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">--version</span><span class="sh">"</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702113858056.png" alt="image-20250702113858056" style="zoom:50%;" /></p>

<p>版本是<code class="language-plaintext highlighter-rouge">3.11.7</code>，满足<code class="language-plaintext highlighter-rouge">3.8+</code>的要求。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">combined_params</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">default_args</span><span class="o">=</span><span class="sh">"</span><span class="s">default</span><span class="sh">"</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">kw_only1</span><span class="p">,</span> <span class="n">kw_only2</span><span class="o">=</span><span class="sh">"</span><span class="s">kw_default</span><span class="sh">"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">位置参数:</span><span class="si">{</span><span class="n">pos1</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">pos2</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">默认参数:</span><span class="si">{</span><span class="n">default_args</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">args:</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">keyword only:</span><span class="si">{</span><span class="n">kw_only1</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">kw_only2</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">**kwargs:</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 正确调用
</span><span class="nf">combined_params</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">"</span><span class="s">默认值---</span><span class="sh">"</span><span class="p">,</span> <span class="n">kw_only1</span> <span class="o">=</span> <span class="sh">"</span><span class="s">apple</span><span class="sh">"</span><span class="p">,</span> <span class="n">kw_only2</span> <span class="o">=</span> <span class="sh">"</span><span class="s">banana</span><span class="sh">"</span><span class="p">,</span> <span class="n">extra_kw</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">python</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Java</span><span class="sh">"</span><span class="p">])</span>
<span class="nf">combined_params</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">"</span><span class="s">默认值---</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">alpha1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">alpha2</span><span class="sh">"</span><span class="p">,</span> <span class="n">kw_only1</span> <span class="o">=</span> <span class="sh">"</span><span class="s">apple</span><span class="sh">"</span><span class="p">,</span> <span class="n">kw_only2</span> <span class="o">=</span> <span class="sh">"</span><span class="s">banana</span><span class="sh">"</span><span class="p">,</span> <span class="n">extra_kw</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">python</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Java</span><span class="sh">"</span><span class="p">])</span>
<span class="nf">combined_params</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">"</span><span class="s">默认值---</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">alpha1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">alpha2</span><span class="sh">"</span><span class="p">,</span> <span class="n">kw_only1</span> <span class="o">=</span> <span class="sh">"</span><span class="s">apple</span><span class="sh">"</span><span class="p">,</span> <span class="n">kw_only2</span> <span class="o">=</span> <span class="sh">"</span><span class="s">banana</span><span class="sh">"</span><span class="p">,</span> <span class="n">kw1</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">test1</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">python</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">test2</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">java</span><span class="sh">"</span> <span class="p">},</span> <span class="n">kw2</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">test3</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">golang</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">test4</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">css</span><span class="sh">"</span> <span class="p">})</span>

<span class="c1"># 错误调用：
</span><span class="k">try</span><span class="p">:</span>
    <span class="nf">combined_params</span><span class="p">(</span><span class="n">pos_only1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos_only2</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kw_only1</span><span class="o">=</span><span class="sh">"</span><span class="s">req_kw</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">报错:</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># combined_params() missing 2 required positional arguments: 'pos1' and 'pos2'
</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nf">combined_params</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">"</span><span class="s">my_default</span><span class="sh">"</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="sh">"</span><span class="s">req_kw</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">报错:</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># combined_params() missing 1 required keyword-only argument: 'kw_only1'
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702115024471.png" alt="image-20250702115024471" /></p>

<h2 id="6函数调用时">（6）函数调用时</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">list1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
<span class="c1"># 报错的写法：fun(list1)
</span><span class="nf">fun</span><span class="p">(</span><span class="o">*</span><span class="n">list1</span><span class="p">)</span>
<span class="n">dict1</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="sh">"</span><span class="s">b</span><span class="sh">"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="sh">"</span><span class="s">c</span><span class="sh">"</span><span class="p">:</span><span class="mi">300</span><span class="p">}</span>
<span class="c1"># 报错的写法: fun(dict1)
</span><span class="nf">fun</span><span class="p">(</span><span class="o">**</span><span class="n">dict1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702171012499.png" alt="image-20250702171012499" style="zoom:50%;" /></p>

<h1 id="5变量的作用域">5、变量的作用域</h1>

<p>变量的作用域决定了程序中变量的可见性和生命周期。Python遵循LEGB规则（Local, Enclosing function locals, Global, Built-in），用于查找变量的顺序。</p>

<p>Python的作用域规则是基于函数定义的，而不是基于代码块（如 if 语句或 for 循环）。</p>

<p><strong>LEGB 规则：</strong> 当Python查找一个变量时，它会按照以下顺序进行搜索：</p>

<ul>
  <li><strong>L (Local - 局部作用域)：</strong></li>
</ul>

<p>○ 当前函数内部定义的变量。</p>

<p>○ 函数参数也是局部变量。</p>

<p>○ 生命周期：从函数被调用开始，到函数执行结束。</p>

<p>○ <strong>原理：</strong> 局部变量存储在函数的栈帧中。每次函数调用都会创建一个新的栈帧，因此局部变量是独立的。</p>

<ul>
  <li><strong>E (Enclosing function locals - 闭包函数外的函数作用域 / 嵌套作用域)：</strong></li>
</ul>

<p>○ 如果一个函数定义在另一个函数内部（即嵌套函数），外部函数的局部变量对于内部函数来说就是其“闭包”作用域。</p>

<p>○ 内部函数可以访问外部函数的变量，即使外部函数已经执行完毕，只要内部函数（闭包）还存在引用。</p>

<p>○ <strong>原理：</strong> 当内部函数被创建时，它会“记住”其定义时的外部作用域（环境）。即使外部函数执行完毕，这个环境（包括外部函数的局部变量）也会被保留下来，供内部函数访问。这正是<strong>闭包的实现机制</strong>。</p>

<ul>
  <li><strong>G (Global - 全局作用域)：</strong></li>
</ul>

<p>○ 在模块（文件）的顶层定义的变量。</p>

<p>○ 在整个模块中都可见。</p>

<p>○ <strong>原理：</strong> 全局变量存储在模块的命名空间字典中。</p>

<ul>
  <li><strong>B (Built-in - 内建作用域)：</strong></li>
</ul>

<p>○ Python解释器预定义的名称，如 <code class="language-plaintext highlighter-rouge">print()</code>, <code class="language-plaintext highlighter-rouge">len()</code>, <code class="language-plaintext highlighter-rouge">True</code>, <code class="language-plaintext highlighter-rouge">None</code> 等。</p>

<p>○ 这些名称在任何地方都可见。</p>

<p>○ <strong>原理：</strong> 内建名称存储在一个特殊的字典中，解释器在找不到其他作用域中的变量时会查找这里。</p>

<hr />

<p><strong>变量赋值与作用域：</strong></p>

<p>● 默认情况下，在函数内部对变量进行赋值操作（例如 x = 10），如果 x 之前未在当前函数作用域内定义，Python会将其视为创建了一个新的<strong>局部变量</strong> x。</p>

<p>● 要在一个函数内部修改<strong>全局变量</strong>，必须使用 global 关键字声明该变量。</p>

<p>● 要在一个嵌套函数内部修改<strong>外部（非局部）函数的变量</strong>，必须使用 nonlocal 关键字声明该变量（Python 3.0+）。</p>

<p><strong>生命周期：</strong></p>

<p>● 局部变量：随函数调用而生，随函数结束而灭。</p>

<p>● 全局变量：随模块导入而生，随程序结束而灭。</p>

<p>● 闭包中的外部变量：只要闭包函数还存在引用，这些变量就会被保留。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="n">global_var</span> <span class="o">=</span> <span class="sh">"</span><span class="s">我是全局变量</span><span class="sh">"</span>
<span class="k">def</span> <span class="nf">outer_function</span><span class="p">():</span>
    <span class="c1"># 外部函数的局部作用域，对于内部函数来说是闭包作用域
</span>    <span class="n">enclosing_var</span> <span class="o">=</span> <span class="sh">"</span><span class="s">我是闭包变量</span><span class="sh">"</span>
    <span class="k">def</span> <span class="nf">inner_function</span><span class="p">():</span>
        <span class="c1"># 内部函数的局部作用域
</span>        <span class="n">local_var</span> <span class="o">=</span> <span class="sh">"</span><span class="s">我是局部变量</span><span class="sh">"</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">内部函数变量:</span><span class="si">{</span><span class="n">local_var</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">闭包作用域的变量:</span><span class="si">{</span><span class="n">enclosing_var</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">全局变量:</span><span class="si">{</span><span class="n">global_var</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">内置变量:</span><span class="si">{</span><span class="k">print</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="c1"># 调用内部函数
</span>    <span class="nf">inner_function</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">scope_for_test</span><span class="p">():</span>
    <span class="n">local_to_test</span> <span class="o">=</span> <span class="sh">"</span><span class="s">我是test_scope函数的局部变量</span><span class="sh">"</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">test_scope函数的局部变量:</span><span class="si">{</span><span class="n">local_to_test</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">全局变量</span><span class="sh">"</span><span class="p">)</span>
    <span class="c1"># print(f"闭包的变量:{enenclosing_var}") # 报错
</span>
<span class="c1"># 测试
</span><span class="nf">outer_function</span><span class="p">()</span>
<span class="nf">scope_for_test</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702145425812.png" alt="image-20250702145425812" style="zoom:50%;" /></p>

<h2 id="1global关键字">（1）global关键字</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="n">g_count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">def</span> <span class="nf">increment_global</span><span class="p">():</span>
    <span class="c1"># 声明 g_count 是全局变量
</span>    <span class="k">global</span> <span class="n">g_count</span>
    <span class="n">g_count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">在increment_global函数内部:</span><span class="si">{</span><span class="n">g_count</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">create_local_g_count</span><span class="p">():</span>
    <span class="c1"># 创建一个局部变量 g_count，不影响全局的 g_count
</span>    <span class="n">g_count</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">在create_local_g_count函数内部，局部g_count的值是:</span><span class="si">{</span><span class="n">g_count</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">在调用increment_global之前，全局g_count的值:</span><span class="si">{</span><span class="n">g_count</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">increment_global</span><span class="p">()</span>
<span class="nf">increment_global</span><span class="p">()</span>
<span class="nf">create_local_g_count</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">在调用increment_global之后，全局g_count的值:</span><span class="si">{</span><span class="n">g_count</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702145838183.png" alt="image-20250702145838183" style="zoom:50%;" /></p>

<h2 id="2nonlocal-关键字-用于嵌套函数修改外部非全局变量">（2）nonlocal 关键字 (用于嵌套函数修改外部非全局变量)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">counter</span><span class="p">():</span>
    <span class="c1"># 外部函数的局部变量
</span>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">increment</span><span class="p">():</span>
        <span class="c1"># 声明 count 是外部函数的变量，而不是局部变量
</span>        <span class="k">nonlocal</span> <span class="n">count</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">在increment中，count=</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">count</span>
    <span class="k">return</span> <span class="n">increment</span>   <span class="c1"># 返回内部函数 (闭包)
</span>
<span class="c1"># my_counter 现在是一个闭包
</span><span class="n">my_counter</span> <span class="o">=</span> <span class="nf">counter</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第一次调用:</span><span class="si">{</span><span class="nf">my_counter</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第二次调用:</span><span class="si">{</span><span class="nf">my_counter</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第三次调用:</span><span class="si">{</span><span class="nf">my_counter</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 另一个闭包实例，拥有独立的 count
</span><span class="n">another_counter</span> <span class="o">=</span> <span class="nf">counter</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">另一个闭包，第一次调用: </span><span class="si">{</span><span class="nf">another_counter</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702150250692.png" alt="image-20250702150250692" style="zoom:50%;" /></p>

<blockquote>
  <p>解释：当 <code class="language-plaintext highlighter-rouge">counter</code> 函数执行完毕并返回 <code class="language-plaintext highlighter-rouge">increment</code> 函数时，即使 <code class="language-plaintext highlighter-rouge">counter</code> 自身的执行环境已经消失，<code class="language-plaintext highlighter-rouge">increment</code> 函数仍然“携带”着它所需要的 <code class="language-plaintext highlighter-rouge">count</code> 变量的引用。这就是<strong>闭包</strong>的形成。</p>
</blockquote>

<h1 id="6递归函数">6、递归函数</h1>

<p>递归函数是一种在函数定义中调用自身的函数。它通过将问题分解为更小的、相同类型的问题来解决，直到达到一个可以直接解决的“基本情况”（Base Case）。</p>

<p>递归是编程中一种强大的解决问题的方法，尤其适用于那些可以被分解为与原问题结构相同但规模更小的子问题。一个有效的递归函数必须包含两个关键部分：</p>

<ul>
  <li><strong>基本情况 (Base Case)：</strong></li>
</ul>

<p>○ 递归的终止条件。当问题规模达到基本情况时，函数不再调用自身，而是直接返回一个结果。</p>

<p>○ 这是防止无限递归（栈溢出）的关键。</p>

<ul>
  <li><strong>递归步骤 (Recursive Step)：</strong></li>
</ul>

<p>○ 函数调用自身来解决一个或多个规模更小的子问题。</p>

<p>○ 每次递归调用都必须使问题更接近基本情况。</p>

<p><strong>递归的优缺点：</strong></p>

<p>● <strong>优点：</strong> 代码通常更简洁、优雅，更符合某些问题的自然逻辑（如树遍历、分治算法）。</p>

<p>● <strong>缺点：</strong></p>

<p>○ <strong>性能开销：</strong> 每次函数调用都会产生新的<strong>栈帧</strong>，带来额外的内存和时间开销。</p>

<p>○ <strong>栈溢出：</strong> 如果递归深度过大（没有基本情况或基本情况无法达到），会导致“RecursionError: maximum recursion depth exceeded”错误，因为调用栈的空间是有限的。<strong>Python默认的递归深度限制通常是1000</strong>。</p>

<p>○ <strong>可读性：</strong> 对于不熟悉递归的人来说，理解递归逻辑可能更困难。</p>

<blockquote>
  <p>递归的执行依赖于<strong>函数调用栈</strong>（Call Stack）。</p>

  <ul>
    <li>
      <p>当一个函数被调用时，其参数、局部变量以及返回地址等信息会被压入栈中。</p>
    </li>
    <li>
      <p>当递归函数调用自身时，<strong>一个新的栈帧会被创建并压入栈顶</strong>。</p>
    </li>
    <li>
      <p>这个过程重复进行，直到达到基本情况。</p>
    </li>
    <li>
      <p>当基本情况被满足时，函数开始返回，其对应的栈帧从栈顶弹出，返回值传递给上一层调用。</p>
    </li>
    <li>
      <p>这个“弹栈”和返回值传递的过程持续进行，直到最初的函数调用完成，最终结果被返回。</p>
    </li>
  </ul>

  <p><strong>尾递归优化 (Tail Recursion Optimization - TRO)：</strong></p>

  <p>某些编程语言（如Scheme、Scala）支持尾递归优化。如果一个递归调用是函数中最后一个操作（即函数在递归调用后不再进行任何其他计算），编译器/解释器可以优化掉新的栈帧创建，直接重用当前栈帧，从而避免栈溢出。</p>

  <p>Python不原生支持尾递归优化。 即使你的递归函数是尾递归形式，Python解释器仍然会为每次递归调用创建新的栈帧。因此，在Python中，深度很大的递归仍然可能导致栈溢出。对于需要处理大量数据的递归问题，通常建议转换为迭代（循环）实现，或者使用<code class="language-plaintext highlighter-rouge"> sys.setrecursionlimit() </code>临时增加递归深度（但要小心内存消耗）。</p>
</blockquote>

<h2 id="1阶乘函数-经典递归示例">（1）阶乘函数 (经典递归示例)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="c1"># 0! = 1, 1!= 1
</span>    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">阶乘不支持负数</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">res0</span> <span class="o">=</span> <span class="nf">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">res1</span> <span class="o">=</span> <span class="nf">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">res5</span> <span class="o">=</span> <span class="nf">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">res99</span> <span class="o">=</span> <span class="nf">factorial</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">0！是:</span><span class="si">{</span><span class="n">res0</span><span class="si">}</span><span class="s">, 1!是:</span><span class="si">{</span><span class="n">res1</span><span class="si">}</span><span class="s">, 5!是:</span><span class="si">{</span><span class="n">res5</span><span class="si">}</span><span class="s">, 99!是:</span><span class="si">{</span><span class="n">res99</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702153550264.png" alt="image-20250702153550264" style="zoom:50%;" /></p>

<h2 id="2斐波那契数列-低效但直观的递归示例">（2）斐波那契数列 (低效但直观的递归示例)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="c1"># F(n) = F(n-1) + F(n-2)
# 基本情况: F(0) = 0, F(1) = 1
# 基本情况: F(2) = F(0) + F(1)
</span><span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">斐波那契不支持负数</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">res2</span> <span class="o">=</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">factorial(2):</span><span class="si">{</span><span class="n">res2</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">factorial(3):</span><span class="si">{</span><span class="nf">fibonacci</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">factorial(4):</span><span class="si">{</span><span class="nf">fibonacci</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">factorial(5):</span><span class="si">{</span><span class="nf">fibonacci</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">factorial(6):</span><span class="si">{</span><span class="nf">fibonacci</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702162301764.png" alt="image-20250702162301764" style="zoom:50%;" /></p>

<p>实际上，上述斐波那契函数存在大量重复计算，效率很低。通常会使用动态规划（记忆化）或迭代方式优化。</p>

<p>下面是优化后的斐波那契 (使用字典进行记忆化)：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">fibonacci_memo</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="p">{}):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">斐波那契不支持负数</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">fibonacci_memo</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="o">+</span> <span class="nf">fibonacci_memo</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span>
    <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>一个效率对比的测试：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="c1"># --- 效率对比 ---
</span><span class="n">test_n</span> <span class="o">=</span> <span class="mi">35</span> <span class="c1"># 选择一个较大的 N 值来体现效率差异
</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">对比 N = </span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s"> 时的斐波那契计算效率：</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 测量原始递归函数
# setup：定义要测试的函数
# stmt：要执行的代码语句
# number：执行的次数
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">--- 原始递归斐波那契 ---</span><span class="sh">"</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">time_original</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">.</span><span class="nf">timeit</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">fibonacci(</span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s">)</span><span class="sh">'</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nf">globals</span><span class="p">(),</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">fibonacci(</span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s">) 耗时: </span><span class="si">{</span><span class="n">time_original</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> 秒</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">RecursionError</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">fibonacci(</span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s">) 发生递归深度错误，无法计算或耗时过长。</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">fibonacci(</span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s">) 发生错误: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- 记忆化递归斐波那契 ---</span><span class="sh">"</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">time_memo</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">.</span><span class="nf">timeit</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">fibonacci_memo(</span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s">)</span><span class="sh">'</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nf">globals</span><span class="p">(),</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">fibonacci_memo(</span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s">) 耗时: </span><span class="si">{</span><span class="n">time_memo</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> 秒</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">fibonacci_memo(</span><span class="si">{</span><span class="n">test_n</span><span class="si">}</span><span class="s">) 发生错误: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250702163410739.png" alt="image-20250702163410739" style="zoom:50%;" /></p>

<h2 id="3递归设置最大深度-慎用可能导致内存问题">（3）递归设置最大深度 (慎用，可能导致内存问题)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">sys</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">默认递归深度限制: </span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="nf">getrecursionlimit</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">sys</span><span class="p">.</span><span class="nf">setrecursionlimit</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="c1"># 可以尝试增加，但要小心
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">新的递归深度限制: </span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="nf">getrecursionlimit</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="4递归遍历目录-示例">（4）递归遍历目录 (示例)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>

<span class="k">def</span> <span class="nf">list_files_recursive</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  </span><span class="sh">"</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Listing: </span><span class="si">{</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="si">}</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">item_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">isdir</span><span class="p">(</span><span class="n">item_path</span><span class="p">):</span>
                <span class="nf">list_files_recursive</span><span class="p">(</span><span class="n">item_path</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># 递归调用
</span>            <span class="k">else</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  </span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">item</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">PermissionError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  </span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="sh">"</span><span class="s">[Permission Denied]</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  </span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="sh">"</span><span class="s">[Path Not Found]</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 创建一个简单的测试目录结构
# import shutil
# if os.path.exists("test_dir"):
#     shutil.rmtree("test_dir")
# os.makedirs("test_dir/subdir1/subsubdir", exist_ok=True)
# os.makedirs("test_dir/subdir2", exist_ok=True)
# with open("test_dir/file1.txt", "w") as f: f.write("hello")
# with open("test_dir/subdir1/file2.txt", "w") as f: f.write("world")
</span>
<span class="c1"># print("\n--- 递归遍历目录示例 ---")
# list_files_recursive("test_dir")
# shutil.rmtree("test_dir") # 清理测试目录
</span></pre></td></tr></tbody></table></code></pre></div></div>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2025/07/01/python%E5%9F%BA%E7%A1%8009%E5%AD%97%E7%AC%A6%E4%B8%B2/" data-toggle="tooltip" data-placement="top" title="python基础-不可变序列-字符串">
                        Previous<br>
                        <span>python基础-不可变序列-字符串</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2025/07/02/python%E5%9F%BA%E7%A1%8011Bug%E4%B8%8E%E5%BC%82%E5%B8%B8/" data-toggle="tooltip" data-placement="top" title="python基础-Bug与异常机制">
                        Next<br>
                        <span>python基础-Bug与异常机制</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0102" 
                    href="/archive/?tag=%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB"
                    title="书籍阅读"
                    rel="3">书籍阅读</a>
        
                <a data-sort="0081" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95"
                    title="算法"
                    rel="24">算法</a>
        
                <a data-sort="0087" 
                    href="/archive/?tag=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI%E5%9F%BA%E7%A1%80"
                    title="人工智能AI基础"
                    rel="18">人工智能AI基础</a>
        
                <a data-sort="0088" 
                    href="/archive/?tag=python%E5%9F%BA%E7%A1%80"
                    title="python基础"
                    rel="17">python基础</a>
        
                <a data-sort="0093" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%90%B4%E6%81%A9%E8%BE%BE"
                    title="机器学习-吴恩达"
                    rel="12">机器学习-吴恩达</a>
        
                <a data-sort="0095" 
                    href="/archive/?tag=%E5%8A%9B%E6%89%A3"
                    title="力扣"
                    rel="10">力扣</a>
        
                <a data-sort="0102" 
                    href="/archive/?tag=spring6"
                    title="spring6"
                    rel="3">spring6</a>
        
                <a data-sort="0103" 
                    href="/archive/?tag=Java%E5%9F%BA%E7%A1%80"
                    title="Java基础"
                    rel="2">Java基础</a>
        
                <a data-sort="0103" 
                    href="/archive/?tag=numpy"
                    title="numpy"
                    rel="2">numpy</a>
        
                <a data-sort="0103" 
                    href="/archive/?tag=ollama%E5%B7%A5%E5%85%B7"
                    title="ollama工具"
                    rel="2">ollama工具</a>
        
                <a data-sort="0103" 
                    href="/archive/?tag=pandas"
                    title="pandas"
                    rel="2">pandas</a>
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://m.freebuf.com/">freebuf</a></li>
  
  <li><a href="https://xz.aliyun.com/">先知</a></li>
  
  <li><a href="https://www.sec-in.com/All">sec-in</a></li>
  
  <li><a href="https://paper.seebug.org/">see-bug</a></li>
  
  <li><a href="https://twitter.com/Concurr21486093">我的推特</a></li>
  
  <li><a href="https://pdai.tech/">pdai</a></li>
  
  <li><a href="https://nodejs.org/dist/">nodejs index of dist</a></li>
  
  <li><a href="#">公众号：小东方不败</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/Concurr21486093">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/Hilda">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">知</i>
      </span>
    </a>
  </li>
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/kirsten-1">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Hilda 2025
                    <br>
                    Powered by <a href="https://kirsten-1.github.io/">hilda Blog</a>
<!--                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"-->
<!--                        height="20px"-->
<!--                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">-->
<!--                    </iframe>-->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
