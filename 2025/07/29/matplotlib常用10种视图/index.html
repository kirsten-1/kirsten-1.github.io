<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="这里是 Hilda 的个人博客，与你一起发现更大的世界 | 要做一个有 swag 的程序员">
    <meta name="keywords" content="Hilda">
    <meta name="theme-color" content="#000000">

    <!-- Open Graph -->
    <meta property="og:title"
        content="matplotlib-常见10种视图 - Hilda的博客 | Your genius girlfriend's blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="

">
    
    <meta property="article:published_time" content=" 2025-07-29T00:00:00Z">
    
    
    <meta property="article:author" content="Hilda">
    
    
    <meta property="article:tag" content="matplotlib">
    
    
    <meta property="og:image" content="https://kirsten-1.github.io">
    <meta property="og:url" content="https://kirsten-1.github.io/2025/07/29/matplotlib%E5%B8%B8%E7%94%A810%E7%A7%8D%E8%A7%86%E5%9B%BE/">
    <meta property="og:site_name" content="Hilda的博客 | Your genius girlfriend's blog">

    <title>matplotlib-常见10种视图 - Hilda的博客 | Your genius girlfriend's blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://kirsten-1.github.io/2025/07/29/matplotlib%E5%B8%B8%E7%94%A810%E7%A7%8D%E8%A7%86%E5%9B%BE/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href=" /css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"
        type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-6487568398225121" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Hilda</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-2015.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-bg-2015.jpg');
        background: ;
    }

    
</style>




<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=matplotlib" title="matplotlib">matplotlib</a>
                        
                    </div>
                    <h1>matplotlib-常见10种视图</h1>
                    
                    <h2 class="subheading"></h2>
                    <span class="meta">Posted by Hilda on July 29, 2025</span>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>

<h1 id="1折线图-line-plot">1.折线图 (Line Plot)</h1>

<p>折线图是显示数据随时间或有序类别变化的趋势的常用图表。它通过连接一系列数据点来展示数值型变量的连续变化。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.plot(*args, scalex=True, scaley=True, data=None, **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.plot(*args, **kwargs)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">*args</code>: 可以接受多种形式的输入，最常见的是 <code class="language-plaintext highlighter-rouge">(x, y)</code> 坐标对。
    <ul>
      <li><code class="language-plaintext highlighter-rouge">plot(y)</code>: 如果只提供一个序列 <code class="language-plaintext highlighter-rouge">y</code>，它会被绘制为 Y 轴值，而 X 轴值将自动生成为 <code class="language-plaintext highlighter-rouge">0, 1, ..., len(y)-1</code>。</li>
      <li><code class="language-plaintext highlighter-rouge">plot(x, y)</code>: 绘制 <code class="language-plaintext highlighter-rouge">y</code> 相对于 <code class="language-plaintext highlighter-rouge">x</code> 的折线。</li>
      <li><code class="language-plaintext highlighter-rouge">plot(x, y, fmt, ...)</code>: <code class="language-plaintext highlighter-rouge">fmt</code> 是一个格式字符串，用于快速指定线条颜色、标记和线条样式，例如 <code class="language-plaintext highlighter-rouge">'r--o'</code> 表示红色虚线带圆圈标记。</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">scalex</code>, <code class="language-plaintext highlighter-rouge">scaley</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code> (默认)，则自动缩放 X/Y 轴以适应数据。</li>
  <li><code class="language-plaintext highlighter-rouge">data</code>: 可以是一个字典或 Pandas DataFrame，允许通过字符串名称引用列。</li>
  <li><code class="language-plaintext highlighter-rouge">**kwargs</code>: 其他可选参数，用于精细控制线条的样式：
    <ul>
      <li><code class="language-plaintext highlighter-rouge">color</code> / <code class="language-plaintext highlighter-rouge">c</code>: 线条颜色 (例如 <code class="language-plaintext highlighter-rouge">'red'</code>, <code class="language-plaintext highlighter-rouge">'#FF0000'</code>, <code class="language-plaintext highlighter-rouge">(1, 0, 0)</code>)。</li>
      <li><code class="language-plaintext highlighter-rouge">linestyle</code> / <code class="language-plaintext highlighter-rouge">ls</code>: 线条样式 (例如 <code class="language-plaintext highlighter-rouge">'-'</code>, <code class="language-plaintext highlighter-rouge">'--'</code>, <code class="language-plaintext highlighter-rouge">'-.'</code>, <code class="language-plaintext highlighter-rouge">':'</code>, <code class="language-plaintext highlighter-rouge">'None'</code>)。</li>
      <li><code class="language-plaintext highlighter-rouge">linewidth</code> / <code class="language-plaintext highlighter-rouge">lw</code>: 线条宽度 (浮点数)。</li>
      <li><code class="language-plaintext highlighter-rouge">marker</code>: 数据点标记样式 (例如 <code class="language-plaintext highlighter-rouge">'o'</code>, <code class="language-plaintext highlighter-rouge">'*'</code>, <code class="language-plaintext highlighter-rouge">'.'</code>, <code class="language-plaintext highlighter-rouge">'+'</code>, <code class="language-plaintext highlighter-rouge">'x'</code>, <code class="language-plaintext highlighter-rouge">'s'</code> (正方形), <code class="language-plaintext highlighter-rouge">'D'</code> (菱形))。</li>
      <li><code class="language-plaintext highlighter-rouge">markersize</code> / <code class="language-plaintext highlighter-rouge">ms</code>: 标记大小。</li>
      <li><code class="language-plaintext highlighter-rouge">markerfacecolor</code> / <code class="language-plaintext highlighter-rouge">mfc</code>: 标记填充颜色。</li>
      <li><code class="language-plaintext highlighter-rouge">markeredgecolor</code> / <code class="language-plaintext highlighter-rouge">mec</code>: 标记边缘颜色。</li>
      <li><code class="language-plaintext highlighter-rouge">markeredgewidth</code> / <code class="language-plaintext highlighter-rouge">mew</code>: 标记边缘宽度。</li>
      <li><code class="language-plaintext highlighter-rouge">label</code>: 用于图例的标签字符串。</li>
    </ul>
  </li>
</ul>

<p><strong>一图多线</strong>： 在同一个 <code class="language-plaintext highlighter-rouge">Axes</code> 对象上多次调用 <code class="language-plaintext highlighter-rouge">plot()</code> 函数，可以在同一张图上绘制多条折线，它们会共享相同的坐标轴。</p>

<p><strong>多图布局</strong>： 通过 <code class="language-plaintext highlighter-rouge">plt.subplots()</code> 或 <code class="language-plaintext highlighter-rouge">plt.subplot()</code> 可以创建多个子图，在不同的子图上绘制不同的折线图，用于对比或展示不同维度的数据。</p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.plot(y)</code> 中，如果只提供一个序列 <code class="language-plaintext highlighter-rouge">y</code>，X 轴的默认值是什么？</p>

    <p>A. 0 到 <code class="language-plaintext highlighter-rouge">len(y)</code> B. 1 到 <code class="language-plaintext highlighter-rouge">len(y)</code> C. 0 到 <code class="language-plaintext highlighter-rouge">len(y)-1</code> D. 1 到 <code class="language-plaintext highlighter-rouge">len(y)-1</code></p>

    <blockquote>
      <p>答案：C</p>
    </blockquote>
  </li>
  <li>
    <p>以下哪个参数用于在折线图上指定数据点的标记样式？ A. <code class="language-plaintext highlighter-rouge">linestyle</code> B. <code class="language-plaintext highlighter-rouge">linewidth</code> C. <code class="language-plaintext highlighter-rouge">marker</code> D. <code class="language-plaintext highlighter-rouge">color</code></p>

    <blockquote>
      <p>答案：C，<code class="language-plaintext highlighter-rouge">marker</code> 用于设置数据点的形状，<code class="language-plaintext highlighter-rouge">linestyle</code> 设置线条的连接方式，<code class="language-plaintext highlighter-rouge">linewidth</code> 设置线条粗细，<code class="language-plaintext highlighter-rouge">color</code> 设置线条颜色。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>创建一个折线图，绘制函数\(y=e^{−0.5x}sin(2x)\) 在 \(x \in[0,10]\) 范围内的曲线。
    <ul>
      <li>曲线颜色为橙色，线条样式为点划线 (<code class="language-plaintext highlighter-rouge">-.</code>)，线条宽度为 2。</li>
      <li>每隔 5 个数据点添加一个菱形 (<code class="language-plaintext highlighter-rouge">'D'</code>) 标记，标记大小为 8，标记边缘颜色为黑色，填充颜色为黄色。</li>
      <li>添加标题 “Damped Sine Wave”。</li>
      <li>添加 X 轴标签 “Time (s)” 和 Y 轴标签 “Amplitude”。</li>
      <li>显示图例和网格。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">orange</span><span class="sh">"</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">-.</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">"</span><span class="s">D</span><span class="sh">"</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">yellow</span><span class="sh">"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">"</span><span class="s">$e^{-x/2}*sin(2x)$</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Damped Sine Wave</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Time(s)</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Amplitude</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728165943268.png" alt="image-20250728165943268" style="zoom:50%;" /></p>

<h1 id="2柱状图-bar-chart">2.柱状图 (Bar Chart)</h1>

<p>柱状图用于比较不同类别之间的数据大小，或者显示单个类别中不同子类别的数据分布。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.bar(x, height, width=0.8, bottom=None, *, align='center', data=None, **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.bar(...)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">x</code>: X 轴上的类别位置。通常是整数序列或类别名称。</li>
  <li><code class="language-plaintext highlighter-rouge">height</code>: 每个柱子的高度（Y 轴值）。</li>
  <li><code class="language-plaintext highlighter-rouge">width</code>: 柱子的宽度（默认为 0.8）。</li>
  <li><code class="language-plaintext highlighter-rouge">bottom</code>: 每个柱子的基线 Y 坐标。这对于创建堆叠柱状图非常重要。</li>
  <li><code class="language-plaintext highlighter-rouge">align</code>: 柱子与 X 轴刻度标签的对齐方式 (<code class="language-plaintext highlighter-rouge">'center'</code> (默认) 或 <code class="language-plaintext highlighter-rouge">'edge'</code>)。</li>
  <li><code class="language-plaintext highlighter-rouge">**kwargs</code>: 其他可选参数，如 <code class="language-plaintext highlighter-rouge">color</code>, <code class="language-plaintext highlighter-rouge">edgecolor</code>, <code class="language-plaintext highlighter-rouge">linewidth</code>, <code class="language-plaintext highlighter-rouge">label</code>, <code class="language-plaintext highlighter-rouge">yerr</code> (Y 轴误差条) 等。</li>
</ul>

<p><strong>堆叠柱状图 (Stacked Bar Chart)</strong>： 通过多次调用 <code class="language-plaintext highlighter-rouge">plt.bar()</code>，并利用 <code class="language-plaintext highlighter-rouge">bottom</code> 参数，可以将不同类别的数据堆叠在同一个 X 轴位置上。每次调用时，<code class="language-plaintext highlighter-rouge">bottom</code> 参数设置为前一个柱子的高度之和。</p>

<p><strong>分组带标签柱状图 (Grouped Bar Chart with Labels)</strong>： 为了在同一 X 轴位置上并排显示多个柱子（代表不同的组），需要手动调整每个柱子的 X 坐标。通常会使用 <code class="language-plaintext highlighter-rouge">np.arange(len(labels))</code> 作为基础 X 坐标，然后通过加减 <code class="language-plaintext highlighter-rouge">width/2</code> 等方式来偏移柱子的位置。</p>

<p><strong>添加标签/注释</strong>： <code class="language-plaintext highlighter-rouge">matplotlib.patches.Rectangle</code> 对象代表了每个柱子。可以通过 <code class="language-plaintext highlighter-rouge">bar()</code> 函数的返回值来获取这些 <code class="language-plaintext highlighter-rouge">Rectangle</code> 对象，然后使用 <code class="language-plaintext highlighter-rouge">rect.get_height()</code> 获取柱子高度，<code class="language-plaintext highlighter-rouge">rect.get_x()</code> 和 <code class="language-plaintext highlighter-rouge">rect.get_width()</code> 获取柱子的位置和宽度，进而使用 <code class="language-plaintext highlighter-rouge">plt.text()</code> 在柱子上方添加数值标签。</p>

<blockquote>
  <p>柱状图的核心是 <code class="language-plaintext highlighter-rouge">matplotlib.patches.Rectangle</code> 对象。每次调用 <code class="language-plaintext highlighter-rouge">plt.bar()</code>，Matplotlib 都会为每个数据点创建一个 <code class="language-plaintext highlighter-rouge">Rectangle</code> 对象，并将其添加到 <code class="language-plaintext highlighter-rouge">Axes</code> 中。</p>

  <ul>
    <li><strong>堆叠原理</strong>: 当绘制堆叠柱状图时，<code class="language-plaintext highlighter-rouge">bottom</code> 参数告诉 Matplotlib 从哪个 Y 坐标开始绘制当前的 <code class="language-plaintext highlighter-rouge">Rectangle</code>。这样，后续的柱子就会在前一个柱子的顶部开始绘制，从而形成堆叠效果。</li>
    <li><strong>分组原理</strong>: 分组柱状图通过调整每个柱子的 X 坐标来实现。例如，对于两个组，第一个组的柱子可以绘制在 <code class="language-plaintext highlighter-rouge">x - width/2</code>，第二个组的柱子绘制在 <code class="language-plaintext highlighter-rouge">x + width/2</code>，这样它们就会以 <code class="language-plaintext highlighter-rouge">x</code> 为中心并排显示。</li>
    <li><strong>文本注释</strong>: <code class="language-plaintext highlighter-rouge">plt.text()</code> 函数用于在图表的数据坐标系中添加文本。通过获取柱子的几何属性（如 <code class="language-plaintext highlighter-rouge">rect.get_x()</code>, <code class="language-plaintext highlighter-rouge">rect.get_width()</code>, <code class="language-plaintext highlighter-rouge">rect.get_height()</code>），可以精确计算文本的放置位置，使其位于柱子的上方并居中。</li>
  </ul>
</blockquote>

<p><strong>水平柱状图 (<code class="language-plaintext highlighter-rouge">plt.barh()</code>)</strong>: 与 <code class="language-plaintext highlighter-rouge">plt.bar()</code> 类似，但用于绘制水平柱状图，X 轴表示值，Y 轴表示类别。</p>

<p><strong>误差条（误差棒）</strong>: 可以使用 <code class="language-plaintext highlighter-rouge">yerr</code> 或 <code class="language-plaintext highlighter-rouge">xerr</code> 参数为柱子添加误差条，表示数据的变异性。</p>

<blockquote>
  <p>如果误差棒明显过长，甚至超过柱状图的长度，那么这个实验数据就存在明显的变异性，可重复性较差；反之，误差棒长短都比较均一，则误差较小，实验数据较为稳定，离散性小，可信度高。</p>
</blockquote>

<p><strong>颜色映射</strong>: 对于数值型数据，可以使用颜色映射 (Colormap) 来为柱子着色，以表示第三个维度的数据。</p>

<p><strong>自定义柱子样式</strong>: 可以通过 <code class="language-plaintext highlighter-rouge">edgecolor</code>, <code class="language-plaintext highlighter-rouge">linewidth</code>, <code class="language-plaintext highlighter-rouge">hatch</code> (填充图案) 等参数来进一步自定义柱子的外观。</p>

<p><strong>应用场景</strong>:</p>

<ul>
  <li><strong>类别数据比较</strong>: 比较不同产品销量、不同地区人口、不同班级成绩等。</li>
  <li><strong>调查问卷结果</strong>: 展示不同选项的投票比例。</li>
  <li><strong>资源分配</strong>: 显示不同项目或部门的资源消耗。</li>
  <li><strong>机器学习模型评估</strong>:
    <ul>
      <li><strong>分类报告</strong>: 绘制每个类别的精确率、召回率、F1 分数柱状图。</li>
      <li><strong>特征重要性</strong>: 绘制特征重要性得分的柱状图，直观展示哪些特征对模型贡献最大。</li>
      <li><strong>模型性能对比</strong>: 比较不同模型在同一指标上的表现（例如，不同算法的准确率）。</li>
      <li><strong>文本分类词频</strong>: 统计不同类别文本中关键词的词频，并用柱状图展示。</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="21-堆叠柱状图">2.1 堆叠柱状图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Group A</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Group B</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Group C</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Group D</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Group E</span><span class="sh">"</span><span class="p">]</span>
<span class="n">man_scores</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">woman_scores</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">men_std</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">women_std</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">width</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># 柱子的宽度
</span>
<span class="c1"># 使用 `yerr` 或 `xerr` 参数为柱子添加误差条
</span><span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">man_scores</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">man_std</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">Men</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">skyblue</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># 如果是堆叠柱状图：bottom=man_scores
</span><span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">woman_scores</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">women_std</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">Women</span><span class="sh">"</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">man_scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">lightcoral</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">red</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">分数</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">分数（男生/女生）</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728175803512.png" alt="image-20250728175803512" style="zoom:50%;" /></p>

<h2 id="22-分组带标签柱状图">2.2 分组带标签柱状图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="n">rects1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">x_pos</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">man_scores</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">Men</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">lightgreen</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rects2</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">x_pos</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">woman_scores</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">Women</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">lightsalmon</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">brown</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">分数</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">分组带标签柱状图</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="sh">"</span><span class="s">right</span><span class="sh">"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># 添加数值标签的辅助函数
</span><span class="k">def</span> <span class="nf">autolabel</span><span class="p">(</span><span class="n">rects</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="nf">get_height</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="nf">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="nf">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="sh">"</span><span class="s">bottom</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">)</span>
        
        
        
<span class="nf">autolabel</span><span class="p">(</span><span class="n">rects1</span><span class="p">)</span>
<span class="nf">autolabel</span><span class="p">(</span><span class="n">rects2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728180631133.png" alt="image-20250728180631133" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.bar()</code> 函数中，哪个参数用于创建堆叠柱状图？ A. <code class="language-plaintext highlighter-rouge">width</code> B. <code class="language-plaintext highlighter-rouge">align</code> C. <code class="language-plaintext highlighter-rouge">bottom</code> D. <code class="language-plaintext highlighter-rouge">yerr</code></p>

    <blockquote>
      <p>答案：C，<code class="language-plaintext highlighter-rouge">bottom</code> 参数指定了柱子的起始 Y 坐标，通过累加前一个柱子的高度可以实现堆叠。</p>
    </blockquote>
  </li>
  <li>
    <p>要获取 <code class="language-plaintext highlighter-rouge">plt.bar()</code> 绘制的单个柱子的高度，可以使用其返回的 <code class="language-plaintext highlighter-rouge">Rectangle</code> 对象上的哪个方法？</p>

    <p>A. <code class="language-plaintext highlighter-rouge">get_x()</code> B. <code class="language-plaintext highlighter-rouge">get_width()</code> C. <code class="language-plaintext highlighter-rouge">get_height()</code> D. <code class="language-plaintext highlighter-rouge">get_label()</code></p>

    <blockquote>
      <p>答案：C，<code class="language-plaintext highlighter-rouge">get_height()</code> 返回柱子的垂直高度。<code class="language-plaintext highlighter-rouge">get_x()</code> 返回柱子的左边缘 X 坐标，<code class="language-plaintext highlighter-rouge">get_width()</code> 返回柱子的宽度。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>创建一个分组柱状图，比较两家公司（”Company A”, “Company B”）在三个季度（”Q1”, “Q2”, “Q3”）的销售额。
    <ul>
      <li>Company A 的销售额：Q1=120, Q2=150, Q3=130</li>
      <li>Company B 的销售额：Q1=100, Q2=180, Q3=110</li>
      <li>使用不同的颜色表示两家公司。</li>
      <li>为每个柱子添加销售额数值标签。</li>
      <li>添加标题 “Quarterly Sales Comparison”。</li>
      <li>添加 X 轴标签 “Quarter” 和 Y 轴标签 “Sales (Millions)”。</li>
      <li>添加图例。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Q1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Q2</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Q3</span><span class="sh">"</span><span class="p">]</span>
<span class="n">dataA</span> <span class="o">=</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">130</span><span class="p">]</span>
<span class="n">dataB</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">110</span><span class="p">]</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="n">rects1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">x_pos</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dataA</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">companyA</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">lightgreen</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rects2</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">x_pos</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dataB</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">companyB</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">lightsalmon</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">brown</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Sales (Millions)</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Quarter</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Quarterly Sales Comparison</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="sh">"</span><span class="s">right</span><span class="sh">"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># 添加数值标签的辅助函数
</span><span class="k">def</span> <span class="nf">autolabel</span><span class="p">(</span><span class="n">rects</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="nf">get_height</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="nf">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="nf">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="sh">"</span><span class="s">bottom</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">)</span>
        
        
        
<span class="nf">autolabel</span><span class="p">(</span><span class="n">rects1</span><span class="p">)</span>
<span class="nf">autolabel</span><span class="p">(</span><span class="n">rects2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728190510916.png" alt="image-20250728190510916" style="zoom:50%;" /></p>

<h1 id="3极坐标图-polar-plot">3.极坐标图 (Polar Plot)</h1>

<p>极坐标图用于显示数据在圆形坐标系中的分布，通常用于表示周期性数据或方向性数据。</p>

<p>创建极坐标图的关键在于在创建 <code class="language-plaintext highlighter-rouge">Axes</code> 对象时指定 <code class="language-plaintext highlighter-rouge">projection='polar'</code>。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.subplot(..., projection='polar', **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">fig.add_subplot(..., projection='polar', **kwargs)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">projection='polar'</code>: 这是将 <code class="language-plaintext highlighter-rouge">Axes</code> 转换为极坐标系的关键参数。</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c1"># 准备数据
</span><span class="n">r_line</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># 角度
</span><span class="n">y_line</span> <span class="o">=</span> <span class="n">r_line</span>  <span class="c1"># 半径随角度线性增长，形成螺旋线
</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># 定义极坐标系axes 
</span><span class="n">ax_polor_line</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="sh">"</span><span class="s">polar</span><span class="sh">"</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">lightyellow</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728191041677.png" alt="image-20250728191041677" style="zoom:50%;" /></p>

<p>在极坐标系中，数据点由半径 <code class="language-plaintext highlighter-rouge">r</code> 和角度 <code class="language-plaintext highlighter-rouge">theta</code> 定义：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">r</code>: 距离圆心的距离（相当于笛卡尔坐标系的 Y 轴）。</li>
  <li><code class="language-plaintext highlighter-rouge">theta</code>: 角度（相当于笛卡尔坐标系的 X 轴），通常以弧度表示。</li>
</ul>

<p><strong>极坐标线形图 (Polar Line Plot)</strong>： 使用 <code class="language-plaintext highlighter-rouge">ax.plot(theta, r, **kwargs)</code> 在极坐标系中绘制折线图。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ax.set_rmax(value)</code>: 设置半径轴的最大值。</li>
  <li><code class="language-plaintext highlighter-rouge">ax.set_rticks(ticks)</code>: 设置半径轴的刻度位置。</li>
  <li><code class="language-plaintext highlighter-rouge">ax.set_rlabel_position(angle)</code>: 设置半径刻度标签相对于径向网格线的角度位置。</li>
  <li><code class="language-plaintext highlighter-rouge">ax.grid(True)</code>: 显示极坐标网格线。</li>
  <li><code class="language-plaintext highlighter-rouge">ax.set_thetagrids(angles, labels)</code>: 设置角度网格线和标签。</li>
</ul>

<p><strong>极坐标柱状图 (Polar Bar Chart)</strong>： 使用 <code class="language-plaintext highlighter-rouge">ax.bar(theta, r, width=..., bottom=0.0, **kwargs)</code> 在极坐标系中绘制柱状图。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">theta</code>: 每个柱子的起始角度。</li>
  <li><code class="language-plaintext highlighter-rouge">r</code>: 每个柱子的半径（高度）。</li>
  <li><code class="language-plaintext highlighter-rouge">width</code>: 每个柱子在角度方向上的宽度（弧度）。</li>
  <li><code class="language-plaintext highlighter-rouge">bottom</code>: 柱子的起始半径（默认为 0.0，即从圆心开始）。</li>
</ul>

<h2 id="31-极坐标线性图">3.1 极坐标线性图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="c1"># 准备数据
</span><span class="n">r_line</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># 角度
</span><span class="n">y_line</span> <span class="o">=</span> <span class="n">r_line</span>  <span class="c1"># 半径随角度线性增长，形成螺旋线
</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># 定义极坐标系axes 
</span><span class="n">ax_polor_line</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="sh">"</span><span class="s">polar</span><span class="sh">"</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">lightyellow</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 绘制极坐标系线性图
</span><span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">r_line</span><span class="p">,</span> <span class="n">y_line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">darkblue</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">螺旋线</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 设置半径轴属性
</span><span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_rmax</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_rticks</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">])</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_rlabel_position</span><span class="p">(</span><span class="o">-</span><span class="mf">22.5</span><span class="p">)</span>  <span class="c1"># 设置半径刻度标签的位置
</span>
<span class="c1"># 设置角度轴属性
</span><span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_thetagrids</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>  <span class="c1"># 角度网格线，每30度一个
</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">--螺旋线--</span><span class="sh">"</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="sh">"</span><span class="s">bottom</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">upper right</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728191853592.png" alt="image-20250728191853592" style="zoom:50%;" /></p>

<h2 id="32-极坐标柱状图">3.2 极坐标柱状图</h2>

<p>例子：风向频率</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="c1"># 准备数据
</span><span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>  <span class="c1"># 12个方向
</span><span class="n">theta_bar</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1"># 角度
</span><span class="n">radii_bar</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>  <span class="c1"># 随机半径
</span><span class="n">width_bar</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="mf">0.9</span> <span class="c1"># 每个柱子的角度宽度，留出一点间隙
</span>
<span class="c1"># 随机生成的颜色
# Colormap将数据集中每个点的数值映射为颜色，从而用颜色来直观地展示数据分布和变化
</span><span class="n">colors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="nf">viridis</span><span class="p">(</span><span class="n">radii_bar</span> <span class="o">/</span> <span class="n">radii_bar</span><span class="p">.</span><span class="nf">max</span><span class="p">())</span>  <span class="c1"># 使用Colormap生成颜色
</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># 定义极坐标
</span><span class="n">ax_polor_bar</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="sh">"</span><span class="s">polar</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 极坐标柱状图绘制
</span><span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">theta_bar</span><span class="p">,</span> <span class="n">radii_bar</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width_bar</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># 设置标题和半径轴
</span><span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">风向频率图（极坐标系柱状图）</span><span class="sh">"</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="sh">"</span><span class="s">bottom</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">set_rmax</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># 最大半径
</span><span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">set_rticks</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span> <span class="c1"># 半径的刻度
</span><span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">set_rlabel_position</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># 设置角度轴标签
</span><span class="n">direction_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">N</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">NNE</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">NE</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ENE</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">E</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ESE</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">SE</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">SSE</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">S</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">SSW</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">SW</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">WSW</span><span class="sh">"</span><span class="p">]</span>
<span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">set_xticks</span><span class="p">(</span><span class="n">theta_bar</span><span class="p">)</span>
<span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">set_xticklabels</span><span class="p">(</span><span class="n">direction_labels</span><span class="p">)</span>
<span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">"</span><span class="s">x</span><span class="sh">"</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>   <span class="c1"># 角度标签字体大小
</span>
<span class="c1"># 网格
</span><span class="n">ax_polor_bar</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>



</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728214418052.png" alt="image-20250728214418052" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>要在 Matplotlib 中创建极坐标图，在创建 <code class="language-plaintext highlighter-rouge">Axes</code> 对象时必须设置哪个参数？</p>

    <p>A. <code class="language-plaintext highlighter-rouge">polar=True</code> B. <code class="language-plaintext highlighter-rouge">projection='polar'</code> C. <code class="language-plaintext highlighter-rouge">coords='polar'</code> D. <code class="language-plaintext highlighter-rouge">type='polar'</code></p>

    <blockquote>
      <p>答案：B</p>
    </blockquote>
  </li>
  <li>
    <p>在极坐标柱状图中，<code class="language-plaintext highlighter-rouge">width</code> 参数控制的是什么？</p>

    <p>A. 柱子的半径。 B. 柱子的高度。 C. 柱子在角度方向上的宽度。 D. 柱子在径向方向上的宽度。</p>

    <blockquote>
      <p>答案：C，在极坐标柱状图中，<code class="language-plaintext highlighter-rouge">width</code> 定义了每个柱子在角度维度上占据的弧度大小。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>创建一个极坐标线形图，绘制一个心形线 (Cardioid)。
    <ul>
      <li>心形线的参数方程通常为 r=a(1+cos(theta))。</li>
      <li>设置 a=1，theta 从 0 到 2pi。</li>
      <li>曲线颜色为红色，线条宽度为 2。</li>
      <li>设置半径轴的最大值为 2。</li>
      <li>添加标题 “Cardioid on Polar Axis”。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1"># 准备数据
</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># 角度
</span><span class="n">y_line</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>  <span class="c1"># 半径随角度线性增长，形成螺旋线
</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># 定义极坐标系axes 
</span><span class="n">ax_polor_line</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="sh">"</span><span class="s">polar</span><span class="sh">"</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">lightyellow</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 绘制极坐标系线性图
</span><span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">r_line</span><span class="p">,</span> <span class="n">y_line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">red</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">螺旋线</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 设置半径轴属性
</span><span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_rmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_rticks</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">])</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_rlabel_position</span><span class="p">(</span><span class="o">-</span><span class="mf">22.5</span><span class="p">)</span>  <span class="c1"># 设置半径刻度标签的位置
</span>
<span class="c1"># 设置角度轴属性
</span><span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_thetagrids</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>  <span class="c1"># 角度网格线，每30度一个
</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">Cardioid on Polar Axis</span><span class="sh">"</span><span class="p">,</span> <span class="n">va</span> <span class="o">=</span> <span class="sh">"</span><span class="s">bottom</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax_polor_line</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">upper right</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728214849350.png" alt="image-20250728214849350" style="zoom:50%;" /></p>

<h1 id="4直方图-histogram">4.直方图 (Histogram)</h1>

<p>直方图用于显示数值型数据的分布情况，它将数据范围划分为一系列区间（bin），然后统计每个区间内数据点的数量或频率。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.hist(x, bins=10, range=None, density=False, weights=None, cumulative=False, histtype='bar', align='mid', orientation='vertical', rwidth=None, log=False, color=None, label=None, stacked=False, **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.hist(...)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">x</code>: 要绘制直方图的数值型数据（一维数组或序列）。</li>
  <li><code class="language-plaintext highlighter-rouge">bins</code>: 区间的数量或定义区间边界的序列。
    <ul>
      <li>整数: 定义等宽区间的数量。</li>
      <li>序列: 定义每个区间的边界，例如 <code class="language-plaintext highlighter-rouge">[0, 10, 20, 30]</code>。</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">range</code>: 区间的上下限 <code class="language-plaintext highlighter-rouge">(min, max)</code>。如果未指定，则从数据的最小值到最大值。</li>
  <li><code class="language-plaintext highlighter-rouge">density</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code>，则直方图的高度表示概率密度，使得所有柱子的面积之和为 1。如果为 <code class="language-plaintext highlighter-rouge">False</code> (默认)，则高度表示频数（计数）。</li>
  <li><code class="language-plaintext highlighter-rouge">weights</code>: 与 <code class="language-plaintext highlighter-rouge">x</code> 长度相同的数组，为 <code class="language-plaintext highlighter-rouge">x</code> 中的每个数据点指定权重。</li>
  <li><code class="language-plaintext highlighter-rouge">cumulative</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code>，则绘制累积直方图。</li>
  <li><code class="language-plaintext highlighter-rouge">histtype</code>: 直方图的类型 (<code class="language-plaintext highlighter-rouge">'bar'</code> (默认), <code class="language-plaintext highlighter-rouge">'barstacked'</code>, <code class="language-plaintext highlighter-rouge">'step'</code>, <code class="language-plaintext highlighter-rouge">'stepfilled'</code>)。</li>
  <li><code class="language-plaintext highlighter-rouge">align</code>: 柱子与 bin 边界的对齐方式 (<code class="language-plaintext highlighter-rouge">'left'</code>, <code class="language-plaintext highlighter-rouge">'mid'</code> (默认), <code class="language-plaintext highlighter-rouge">'right'</code>)。</li>
  <li><code class="language-plaintext highlighter-rouge">color</code>: 柱子的颜色。</li>
  <li><code class="language-plaintext highlighter-rouge">label</code>: 用于图例的标签。</li>
  <li><code class="language-plaintext highlighter-rouge">stacked</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code> 且 <code class="language-plaintext highlighter-rouge">x</code> 是多维数组，则绘制堆叠直方图。</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">plt.hist()</code> 函数会返回三个值：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">n</code>: 每个 bin 中的计数或密度值。</li>
  <li><code class="language-plaintext highlighter-rouge">bins</code>: bin 的边界数组。</li>
  <li><code class="language-plaintext highlighter-rouge">patches</code>: 绘制的 <code class="language-plaintext highlighter-rouge">Rectangle</code> 对象列表（每个柱子）。</li>
</ul>

<p>这些返回值对于后续处理（例如绘制概率密度函数）非常有用。</p>

<blockquote>
  <p>直方图的绘制涉及以下步骤：</p>

  <ol>
    <li><strong>分箱 (Binning)</strong>: 将连续的数值数据划分为离散的区间（bins）。这些区间可以是等宽的，也可以是自定义的。</li>
    <li><strong>计数</strong>: 统计每个区间内数据点的数量。</li>
    <li><strong>绘制</strong>: 将每个区间的计数（或频率/密度）表示为柱子的高度，并在 X 轴上显示区间。</li>
  </ol>

  <p><code class="language-plaintext highlighter-rouge">plt.hist()</code> 在内部执行这些操作。当 <code class="language-plaintext highlighter-rouge">density=True</code> 时，它会将每个 bin 的计数除以总数据点数和 bin 的宽度，从而将直方图归一化为概率密度函数的形式，使得总面积为 1。这使得直方图可以与理论概率密度函数进行比较。</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="c1"># 绘制正态分布的概率密度函数
</span><span class="kn">from</span> <span class="n">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># 准备数据
</span><span class="n">mu</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 均值
</span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1"># 标准差
</span><span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>  <span class="c1"># 生成正态分布
</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># 绘制直方图
# density=True   归一化为概率密度
</span><span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">skyblue</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">数据直方图</span><span class="sh">"</span><span class="p">)</span>


<span class="c1"># 绘制理论的概率密度函数（PDF）
</span><span class="n">y_pdf</span> <span class="o">=</span> <span class="n">norm</span><span class="p">.</span><span class="nf">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">red</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">理论概率密度</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 添加标题和标签
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">值：</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">概率密度：</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">--直方图--</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">upper right</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">fig</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728215826044.png" alt="image-20250728215826044" style="zoom:50%;" /></p>

<h2 id="拓展多数据集直方图">拓展:多数据集直方图</h2>

<p>非堆叠直方图:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="n">data_group1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">data_group2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># 非堆叠直方图（默认）
</span><span class="n">plt</span><span class="p">.</span><span class="nf">hist</span><span class="p">([</span><span class="n">data_group1</span><span class="p">,</span> <span class="n">data_group2</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">组1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">组2</span><span class="sh">"</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">非堆叠直方图</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">取值</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">概率密度</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728220309042.png" alt="image-20250728220309042" style="zoom:50%;" /></p>

<p>堆叠直方图：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="n">data_group1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">data_group2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># 堆叠直方图
</span><span class="n">plt</span><span class="p">.</span><span class="nf">hist</span><span class="p">([</span><span class="n">data_group1</span><span class="p">,</span> <span class="n">data_group2</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">组1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">组2</span><span class="sh">"</span><span class="p">],</span> <span class="n">stacked</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">堆叠直方图</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">取值</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">概率密度</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728220411679.png" alt="image-20250728220411679" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.hist()</code> 函数中，如果 <code class="language-plaintext highlighter-rouge">density</code> 参数设置为 <code class="language-plaintext highlighter-rouge">True</code>，直方图的 Y 轴表示什么？</p>

    <p>A. 频数（计数） B. 频率 C. 概率密度 D. 累积频率</p>

    <blockquote>
      <p>答案：C， 当 <code class="language-plaintext highlighter-rouge">density=True</code> 时，直方图被归一化，使得所有柱子的面积之和为 1，Y 轴表示概率密度。</p>
    </blockquote>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">plt.hist()</code> 函数的 <code class="language-plaintext highlighter-rouge">bins</code> 参数可以接受什么类型的值？</p>

    <p>A. 整数，表示区间的数量。 B. 序列，表示区间边界。 C. 字符串，表示预设的区间类型。 D. A 和 B 都正确。</p>

    <blockquote>
      <p>答案：D，<code class="language-plaintext highlighter-rouge">bins</code> 可以是整数（指定区间数量）或序列（指定区间边界）</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>生成 10000 个服从标准正态分布（均值 0，标准差 1）的随机数。</li>
  <li>绘制这些数据的直方图，设置 50 个区间，并将其归一化为概率密度。</li>
  <li>在同一个图上，叠加绘制标准正态分布的理论概率密度函数曲线。
    <ul>
      <li>直方图柱子颜色为浅蓝色，边缘为深蓝色。</li>
      <li>理论曲线颜色为红色，线条样式为虚线。</li>
      <li>添加标题 “Standard Normal Distribution Histogram and PDF”。</li>
      <li>添加 X 轴标签 “Value” 和 Y 轴标签 “Probability Density”。</li>
      <li>显示图例和网格。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="c1"># 绘制正态分布的概率密度函数
</span><span class="kn">from</span> <span class="n">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># 准备数据
</span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 均值
</span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># 标准差
</span><span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>  <span class="c1"># 生成正态分布
</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># 绘制直方图
# density=True   归一化为概率密度
</span><span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">skyblue</span><span class="sh">"</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">darkblue</span><span class="sh">"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">数据直方图</span><span class="sh">"</span><span class="p">)</span>


<span class="c1"># 绘制理论的概率密度函数（PDF）
</span><span class="n">y_pdf</span> <span class="o">=</span> <span class="n">norm</span><span class="p">.</span><span class="nf">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">red</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">"</span><span class="s">理论概率密度</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 添加标题和标签
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Value</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Probability Density</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">tandard Normal Distribution Histogram and PDF</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">upper right</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">fig</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>


</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728221423031.png" alt="image-20250728221423031" style="zoom:50%;" /></p>

<h1 id="5箱形图-box-plot">5.箱形图 (Box Plot)</h1>

<p>箱形图（又称盒须图）是一种用于显示数值数据分布的标准化方法，它能直观地展示数据的中位数、四分位数、离群点等信息。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.boxplot(x, notch=False, sym='o', vert=True, whis=1.5, positions=None, widths=None, patch_artist=False, meanline=False, showmeans=False, showcaps=True, showbox=True, showfliers=True, boxprops=None, flierprops=None, medianprops=None, meanprops=None, capprops=None, whiskerprops=None, **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.boxplot(...)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">x</code>: 要绘制箱形图的数据。可以是一个一维数组（绘制一个箱形图），也可以是多个数组的序列（绘制多个箱形图）。</li>
  <li><code class="language-plaintext highlighter-rouge">notch</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code>，则箱体中间会有一个凹口，用于表示中位数的置信区间。</li>
  <li><code class="language-plaintext highlighter-rouge">sym</code>: 离群点的标记样式（默认为 <code class="language-plaintext highlighter-rouge">'o'</code>）。如果设置为 <code class="language-plaintext highlighter-rouge">''</code>，则不显示离群点。</li>
  <li><code class="language-plaintext highlighter-rouge">vert</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code> (默认)，则绘制垂直箱形图；如果为 <code class="language-plaintext highlighter-rouge">False</code>，则绘制水平箱形图。</li>
  <li><code class="language-plaintext highlighter-rouge">whis</code>: 须的长度。通常是 IQR (四分位距) 的倍数。默认 <code class="language-plaintext highlighter-rouge">1.5</code> 意味着须延伸到 <code class="language-plaintext highlighter-rouge">Q1 - 1.5 * IQR</code> 和 <code class="language-plaintext highlighter-rouge">Q3 + 1.5 * IQR</code> 范围内的最远数据点。超出此范围的点被认为是离群点。</li>
  <li><code class="language-plaintext highlighter-rouge">labels</code>: 每个箱形图的标签列表。<strong>注意这个参数现在已经变成了<code class="language-plaintext highlighter-rouge">tick_labels</code></strong>!!!</li>
  <li><code class="language-plaintext highlighter-rouge">patch_artist</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code>，则箱体将是 <code class="language-plaintext highlighter-rouge">Patch</code> 对象，可以设置填充颜色等。否则，箱体是 <code class="language-plaintext highlighter-rouge">Line2D</code> 对象。</li>
  <li><code class="language-plaintext highlighter-rouge">showmeans</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code>，则显示均值。</li>
  <li><code class="language-plaintext highlighter-rouge">meanline</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code>，则均值显示为一条线。</li>
  <li><code class="language-plaintext highlighter-rouge">flierprops</code>: 离群点属性的字典。</li>
  <li><code class="language-plaintext highlighter-rouge">boxprops</code>: 箱体属性的字典。</li>
  <li><code class="language-plaintext highlighter-rouge">medianprops</code>: 中位数线属性的字典。</li>
  <li><code class="language-plaintext highlighter-rouge">meanprops</code>: 均值标记属性的字典。</li>
  <li><code class="language-plaintext highlighter-rouge">capprops</code>: 须帽（箱须末端横线）属性的字典。</li>
  <li><code class="language-plaintext highlighter-rouge">whiskerprops</code>: 须线属性的字典。</li>
</ul>

<p>箱形图的组成部分：</p>

<ul>
  <li><strong>箱体 (Box)</strong>: 包含数据的 IQR (Interquartile Range)，即从第一四分位数 (Q1) 到第三四分位数 (Q3) 的范围。箱体的长度表示数据的集中程度。</li>
  <li><strong>中位数 (Median)</strong>: 箱体内的横线，表示数据的中位数 (Q2)。</li>
  <li><strong>须 (Whiskers)</strong>: 从箱体延伸出的线，通常延伸到 <code class="language-plaintext highlighter-rouge">Q1 - 1.5 * IQR</code> 和 <code class="language-plaintext highlighter-rouge">Q3 + 1.5 * IQR</code> 范围内的最远数据点。</li>
  <li><strong>离群点 (Outliers/Fliers)</strong>: 超出须范围的数据点，通常用点表示。</li>
</ul>

<hr />

<p><strong>小提琴图 (<code class="language-plaintext highlighter-rouge">seaborn.violinplot()</code>)</strong>: 小提琴图是箱形图的增强版，它在箱形图的基础上叠加了核密度估计，可以更详细地展示数据的分布形状。</p>

<p><strong>缺口箱形图 (<code class="language-plaintext highlighter-rouge">notch=True</code>)</strong>: 凹口箱形图的凹口表示中位数的 95% 置信区间。如果两个箱形图的凹口不重叠，则它们的中位数可能存在显著差异。</p>

<p><strong>自定义样式</strong>: 通过 <code class="language-plaintext highlighter-rouge">boxprops</code>, <code class="language-plaintext highlighter-rouge">flierprops</code> 等参数字典，可以高度自定义箱体、离群点、中位数线等各个部分的颜色、线条样式等。</p>

<p><strong>应用场景</strong>:</p>

<ul>
  <li><strong>比较多组数据的分布</strong>: 在不同组别（如不同实验组、不同产品类别）之间比较数据的中心趋势、离散程度和偏态。</li>
  <li><strong>异常值分析</strong>: 快速识别数据集中的离群点。</li>
  <li><strong>A/B 测试结果分析</strong>: 比较 A/B 测试中不同变体对某个指标（如转化率、停留时间）的影响分布。</li>
  <li><strong>模型性能指标分布</strong>: 对于交叉验证结果，可以绘制不同折叠（folds）上模型性能指标（如准确率、F1 分数）的箱形图，以评估模型的稳定性。</li>
  <li><strong>特征工程</strong>: 检查不同特征的分布，特别是当特征值范围差异很大时，箱形图可以帮助理解其尺度和异常值。</li>
</ul>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="c1"># 准备数据，4组不同分布的数据
</span>
<span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>   <span class="c1"># 标准正态
</span><span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>   <span class="c1"># 均值偏移，方差减小
</span><span class="n">data3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>   <span class="c1"># 均值偏移，方差变大
</span><span class="n">data4</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)))</span>

<span class="n">all_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">,</span> <span class="n">data4</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Group_A</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Group_B</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Group_C</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Group_D</span><span class="sh">"</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># 绘制箱线图
</span><span class="n">bplot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span>
    <span class="n">all_data</span><span class="p">,</span>
    <span class="n">notch</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="c1"># 箱体中间会有一个凹口，用于表示中位数的置信区间
</span>    <span class="n">vert</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1">#绘制垂直箱形图
</span>    <span class="n">patch_artist</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1"># 箱体将是 `Patch` 对象，可以设置填充颜色等
</span>    <span class="n">tick_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">showmeans</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1"># 展示均值
</span>    <span class="n">flierprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="sh">"</span><span class="s">o</span><span class="sh">"</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">red</span><span class="sh">"</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">),</span> <span class="c1"># 离群点的样式
</span>    <span class="n">medianprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="c1"># 中位数线样式
</span>    <span class="n">boxprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>   <span class="c1"># 箱体边缘样式
</span>    <span class="n">whiskerprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># 须线样式
</span>    <span class="n">capprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>  <span class="c1"># 须帽样式
</span><span class="p">)</span>

<span class="c1"># 为每个箱体设置不同的颜色
</span><span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">lightblue</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">lightgreen</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">lightcoral</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">lightgoldenrodyellow</span><span class="sh">"</span><span class="p">]</span>
<span class="k">for</span> <span class="n">patch</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">bplot</span><span class="p">[</span><span class="sh">"</span><span class="s">boxes</span><span class="sh">"</span><span class="p">],</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">patch</span><span class="p">.</span><span class="nf">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">数据分布的箱线图</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">数据组</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">值</span><span class="sh">"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>箱形图的箱体部分表示数据分布的哪个范围？</p>

    <p>A. 最小值到最大值。 B. 均值加减标准差。 C. 第一四分位数 (Q1) 到第三四分位数 (Q3)。 D. 中位数到最大值。</p>

    <blockquote>
      <p>答案：C，箱体代表数据的 IQR，即中间 50% 的数据。</p>
    </blockquote>
  </li>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.boxplot()</code> 中，哪个参数用于控制须的长度？ A. <code class="language-plaintext highlighter-rouge">sym</code> B. <code class="language-plaintext highlighter-rouge">vert</code> C. <code class="language-plaintext highlighter-rouge">whis</code> D. <code class="language-plaintext highlighter-rouge">notch</code></p>

    <blockquote>
      <p>答案：C，<code class="language-plaintext highlighter-rouge">whis</code> 参数控制须的长度，通常是 IQR 的倍数。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>生成三组数据，模拟三个不同班级学生的考试分数：
    <ul>
      <li>班级 A: 均值 75，标准差 8，200 个学生。</li>
      <li>班级 B: 均值 80，标准差 5，200 个学生。</li>
      <li>班级 C: 均值 70，标准差 10，200 个学生。</li>
    </ul>
  </li>
  <li>绘制这三组分数的箱形图。
    <ul>
      <li>箱体颜色分别为蓝色、绿色、红色。</li>
      <li>显示均值，并用星号 (<code class="language-plaintext highlighter-rouge">'*'</code>) 标记。</li>
      <li>显示离群点，并用绿色菱形 (<code class="language-plaintext highlighter-rouge">'D'</code>) 标记。</li>
      <li>添加标题 “Class Exam Scores Distribution”。</li>
      <li>添加 X 轴标签 “Class” 和 Y 轴标签 “Score”。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="c1"># 准备数据，4组不同分布的数据
</span>
<span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>   <span class="c1"># 标准正态
</span><span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>   <span class="c1"># 均值偏移，方差减小
</span><span class="n">data3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>   <span class="c1"># 均值偏移，方差变大
</span>
<span class="n">all_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">班级A</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">班级B</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">班级C</span><span class="sh">"</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># 绘制箱线图
</span><span class="n">bplot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span>
    <span class="n">all_data</span><span class="p">,</span>
    <span class="n">notch</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="c1"># 箱体中间会有一个凹口，用于表示中位数的置信区间
</span>    <span class="n">vert</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1">#绘制垂直箱形图
</span>    <span class="n">patch_artist</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1"># 箱体将是 `Patch` 对象，可以设置填充颜色等
</span>    <span class="n">tick_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">showmeans</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1"># 展示均值
</span>    <span class="n">flierprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="sh">"</span><span class="s">D</span><span class="sh">"</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">),</span> <span class="c1"># 离群点的样式
</span>    <span class="n">meanprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="sh">"</span><span class="s">*</span><span class="sh">"</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">purple</span><span class="sh">"</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">yellow</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">medianprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="c1"># 中位数线样式
</span>    <span class="n">boxprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>   <span class="c1"># 箱体边缘样式
</span>    <span class="n">whiskerprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># 须线样式
</span>    <span class="n">capprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>  <span class="c1"># 须帽样式
</span><span class="p">)</span>

<span class="c1"># 为每个箱体设置不同的颜色
</span><span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">lightblue</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">lightgreen</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">red</span><span class="sh">"</span><span class="p">]</span>
<span class="k">for</span> <span class="n">patch</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">bplot</span><span class="p">[</span><span class="sh">"</span><span class="s">boxes</span><span class="sh">"</span><span class="p">],</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">patch</span><span class="p">.</span><span class="nf">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Class Exam Scores Distribution</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Class</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Score</span><span class="sh">"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728231734331.png" alt="image-20250728231734331" style="zoom:50%;" /></p>

<h1 id="6散点图-scatter-plot">6.散点图 (Scatter Plot)</h1>

<p>散点图用于显示两个数值变量之间的关系。每个数据点在二维坐标系中由一个点表示。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.scatter(x, y, s=None, c=None, marker=None, cmap=None, norm=None, vmin=None, vmax=None, alpha=None, linewidths=None, edgecolors=None, plotnonfinite=False, data=None, **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.scatter(...)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code>: 数据点的 X 和 Y 坐标。</li>
  <li><code class="language-plaintext highlighter-rouge">s</code>: 标记的大小。可以是一个标量（所有点大小相同）或与 <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code> 长度相同的数组（每个点大小不同）。</li>
  <li><code class="language-plaintext highlighter-rouge">c</code>: 标记的颜色。可以是一个颜色字符串、RGB 元组、颜色名称列表，或者与 <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code> 长度相同的数值数组。如果是数值数组，则颜色会根据颜色映射 (Colormap) 进行映射。</li>
  <li><code class="language-plaintext highlighter-rouge">marker</code>: 标记样式 (例如 <code class="language-plaintext highlighter-rouge">'o'</code>, <code class="language-plaintext highlighter-rouge">'s'</code>, <code class="language-plaintext highlighter-rouge">'^'</code>, <code class="language-plaintext highlighter-rouge">'+'</code>)。</li>
  <li><code class="language-plaintext highlighter-rouge">cmap</code>: 颜色映射 (Colormap) 对象或名称（当 <code class="language-plaintext highlighter-rouge">c</code> 是数值数组时）。</li>
  <li><code class="language-plaintext highlighter-rouge">alpha</code>: 标记的透明度（0到1之间）。</li>
  <li><code class="language-plaintext highlighter-rouge">linewidths</code>: 标记边缘的线宽。</li>
  <li><code class="language-plaintext highlighter-rouge">edgecolors</code>: 标记边缘的颜色。</li>
  <li><code class="language-plaintext highlighter-rouge">label</code>: 用于图例的标签。</li>
</ul>

<p>散点图非常适合揭示变量之间的相关性、聚类模式或异常值。</p>

<hr />

<p><strong>气泡图 (Bubble Chart)</strong>: 当 <code class="language-plaintext highlighter-rouge">s</code> 参数被用来表示第三个数值维度时，散点图就变成了气泡图。</p>

<p><strong>颜色条 (Colorbar)</strong>: 当使用 <code class="language-plaintext highlighter-rouge">c</code> 参数进行颜色映射时，通常需要添加一个颜色条 (<code class="language-plaintext highlighter-rouge">plt.colorbar()</code>) 来解释颜色与数值的对应关系。</p>

<p><strong>高密度散点图</strong>: 对于包含大量数据点的散点图，简单的点可能会重叠严重。可以考虑使用 <code class="language-plaintext highlighter-rouge">hexbin()</code> (六边形分箱图) 或 <code class="language-plaintext highlighter-rouge">hist2d()</code> (二维直方图) 来显示密度，或者使用 <code class="language-plaintext highlighter-rouge">alpha</code> 参数调整透明度。</p>

<p><strong>交互式散点图</strong>: 结合 <code class="language-plaintext highlighter-rouge">mpl_toolkits.mplot3d</code> 可以绘制三维散点图，结合 <code class="language-plaintext highlighter-rouge">plotly</code> 或 <code class="language-plaintext highlighter-rouge">bokeh</code> 可以创建交互式散点图。</p>

<p>关于聚类算法的例子：</p>

<p>首先安装库：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>代码：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="n">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># 生成模拟聚类数据
</span><span class="n">X</span><span class="p">,</span> <span class="n">y_true</span> <span class="o">=</span> <span class="nf">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">0.60</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 运行 KMeans 聚类
</span><span class="n">kmeans</span> <span class="o">=</span> <span class="nc">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">kmeans</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y_kmeans</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y_kmeans</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">viridis</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">kmeans</span><span class="p">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kmeans</span><span class="p">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Cluster Centers</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">K-Means Clustering Results</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Feature 1</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Feature 2</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">:</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728232020081.png" alt="image-20250728232020081" style="zoom:50%;" /></p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="c1"># 数据准备
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># 为了结果可以复现
</span><span class="n">num_points</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">data_x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span>
<span class="n">data_y</span> <span class="o">=</span> <span class="n">data_x</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># 带了一些噪声
</span><span class="n">sizes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_points</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># 绘制散点图
</span><span class="n">scatter_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span>
    <span class="n">data_x</span><span class="p">,</span>
    <span class="n">data_y</span><span class="p">,</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">,</span>  <span class="c1"># 尺寸（气泡大小）
</span>    <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="sh">"</span><span class="s">viridis</span><span class="sh">"</span><span class="p">,</span> <span class="c1"># 颜色映射
</span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="sh">"</span><span class="s">o</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="c1"># 添加标题和标签
</span><span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">散点图绘制</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">X 轴值</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Y 轴值</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 添加颜色条（当使用c参数进行颜色映射时非常重要）
</span><span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">scatter_plot</span><span class="p">)</span>
<span class="n">cbar</span><span class="p">.</span><span class="nf">set_label</span><span class="p">(</span><span class="sh">"</span><span class="s">颜色值</span><span class="sh">"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728232817320.png" alt="image-20250728232817320" style="zoom:50%;" /></p>

<h2 id="拓展不同标记和边缘颜色的散点图">拓展:不同标记和边缘颜色的散点图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># 为了结果可以复现
</span><span class="n">num_points</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">data_x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span>
<span class="n">data_y</span> <span class="o">=</span> <span class="n">data_x</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># 带了一些噪声
</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">data_x</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">data_y</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Group 1</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="n">data_y</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">s</span><span class="sh">'</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="sh">'</span><span class="s">purple</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Group 2</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="mi">100</span><span class="p">:],</span> <span class="n">data_y</span><span class="p">[</span><span class="mi">100</span><span class="p">:],</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">^</span><span class="sh">'</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="sh">'</span><span class="s">orange</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Group 3</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Scatter Plot with Different Markers and Edge Colors</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">X-axis</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Y-axis</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">:</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250728233425479.png" alt="image-20250728233425479" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.scatter()</code> 函数中，哪个参数可以用来根据数据点的第三个数值维度来改变其大小？ A. <code class="language-plaintext highlighter-rouge">c</code> B. <code class="language-plaintext highlighter-rouge">s</code> C. <code class="language-plaintext highlighter-rouge">marker</code> D. <code class="language-plaintext highlighter-rouge">alpha</code></p>

    <blockquote>
      <p>答案：B，</p>

      <ul>
        <li><code class="language-plaintext highlighter-rouge">s</code>: 标记的大小。可以是一个标量（所有点大小相同）或与 <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code> 长度相同的数组（每个点大小不同）。</li>
        <li><code class="language-plaintext highlighter-rouge">c</code>: 标记的颜色。可以是一个颜色字符串、RGB 元组、颜色名称列表，或者与 <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code> 长度相同的数值数组。如果是数值数组，则颜色会根据颜色映射 (Colormap) 进行映射。</li>
      </ul>
    </blockquote>
  </li>
  <li>
    <p>如果 <code class="language-plaintext highlighter-rouge">plt.scatter()</code> 的 <code class="language-plaintext highlighter-rouge">c</code> 参数是一个数值数组，并且你希望颜色能够反映这些数值的大小，你还需要结合使用哪个参数？</p>

    <p>A. <code class="language-plaintext highlighter-rouge">marker</code> B. <code class="language-plaintext highlighter-rouge">alpha</code> C. <code class="language-plaintext highlighter-rouge">cmap</code> D. <code class="language-plaintext highlighter-rouge">edgecolors</code></p>

    <blockquote>
      <p>答案：C，<code class="language-plaintext highlighter-rouge">cmap</code>: 颜色映射 (Colormap) 对象或名称（当 <code class="language-plaintext highlighter-rouge">c</code> 是数值数组时）。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>生成 100 个随机数据点，X 坐标在 [0, 10] 之间，Y 坐标在 [0, 10] 之间。</li>
  <li>为每个点生成一个随机的大小（在 50 到 500 之间）和一个随机的颜色值（在 0 到 1 之间）。</li>
  <li>绘制这些点的散点图。
    <ul>
      <li>使用 <code class="language-plaintext highlighter-rouge">viridis</code> 颜色映射。</li>
      <li>点的透明度为 0.7。</li>
      <li>点的边缘颜色为黑色，线宽为 1。</li>
      <li>添加标题 “Random Scatter Plot with Size and Color Variation”。</li>
      <li>添加 X 轴标签 “X-coordinate” 和 Y 轴标签 “Y-coordinate”。</li>
      <li>添加一个颜色条，标签为 “Random Color Value”。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">points_size</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_points</span><span class="p">)</span>
<span class="n">color_values</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># 绘制散点图
</span><span class="n">scatter_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">points_size</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color_values</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="sh">"</span><span class="s">viridis</span><span class="sh">"</span><span class="p">,</span>
           <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Random Scatter Plot with Size and Color Variation</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">X-coordinate</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Y-coordinate</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 添加颜色条（当使用c参数进行颜色映射时非常重要）
</span><span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">scatter_plot</span><span class="p">)</span>
<span class="n">cbar</span><span class="p">.</span><span class="nf">set_label</span><span class="p">(</span><span class="sh">"</span><span class="s">Random Color Value</span><span class="sh">"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729130214423.png" alt="image-20250729130214423" style="zoom:50%;" /></p>

<h1 id="7饼图-pie-chart">7.饼图 (Pie Chart)</h1>

<p>饼图用于显示各部分在整体中所占的比例。它将一个圆形分成若干个扇形，每个扇形的大小与它所代表的数据的比例成正比。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.pie(x, explode=None, labels=None, colors=None, autopct=None, pctdistance=0.6, shadow=False, startangle=None, radius=None, counterclock=True, wedgeprops=None, textprops=None, center=(0, 0), frame=False, rotatelabels=False, normalize=True, **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.pie(...)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">x</code>: 扇形的大小数据（数值序列）。</li>
  <li><code class="language-plaintext highlighter-rouge">explode</code>: 一个与 <code class="language-plaintext highlighter-rouge">x</code> 长度相同的序列，用于指定每个扇形偏离圆心的距离，从而突出显示某些部分。</li>
  <li><code class="language-plaintext highlighter-rouge">labels</code>: 每个扇形的标签列表。</li>
  <li><code class="language-plaintext highlighter-rouge">colors</code>: 每个扇形的颜色列表。</li>
  <li><code class="language-plaintext highlighter-rouge">autopct</code>: 用于格式化显示百分比的字符串或函数。例如 <code class="language-plaintext highlighter-rouge">'%1.1f%%'</code> 表示保留一位小数的百分比。</li>
  <li><code class="language-plaintext highlighter-rouge">pctdistance</code>: 百分比文本标签相对于圆心的距离比例（0到1之间）。</li>
  <li><code class="language-plaintext highlighter-rouge">shadow</code>: 布尔值，如果为 <code class="language-plaintext highlighter-rouge">True</code>，则显示阴影效果。</li>
  <li><code class="language-plaintext highlighter-rouge">startangle</code>: 第一个扇形的起始角度（逆时针，默认为 0 度，即从 X 轴正方向开始）。</li>
  <li><code class="language-plaintext highlighter-rouge">radius</code>: 饼图的半径。</li>
  <li><code class="language-plaintext highlighter-rouge">wedgeprops</code>: 扇形楔形部分的属性字典，例如 <code class="language-plaintext highlighter-rouge">wedgeprops=dict(width=0.4, edgecolor='w')</code> 可以创建甜甜圈图。</li>
  <li><code class="language-plaintext highlighter-rouge">textprops</code>: 标签文本的属性字典。</li>
</ul>

<p><strong>一般饼图</strong>： 直接使用 <code class="language-plaintext highlighter-rouge">plt.pie()</code> 绘制，通过 <code class="language-plaintext highlighter-rouge">explode</code>, <code class="language-plaintext highlighter-rouge">labels</code>, <code class="language-plaintext highlighter-rouge">autopct</code> 等参数进行定制。</p>

<p><strong>嵌套饼图 (Nested Pie Chart)</strong>： 通过绘制两个或多个饼图，并调整它们的 <code class="language-plaintext highlighter-rouge">radius</code> 和 <code class="language-plaintext highlighter-rouge">wedgeprops</code> 参数，可以创建同心圆的嵌套饼图，用于展示层次结构数据。通常内圈表示大类别，外圈表示子类别。</p>

<p><strong>甜甜圈图 (Donut Chart)</strong>： 甜甜圈图是饼图的一种变体，中间有一个空心。这可以通过 <code class="language-plaintext highlighter-rouge">wedgeprops</code> 中的 <code class="language-plaintext highlighter-rouge">width</code> 参数来实现，例如 <code class="language-plaintext highlighter-rouge">wedgeprops=dict(width=0.4)</code> 表示扇形的宽度为半径的 0.4 倍，中间留下 0.6 倍半径的空心。</p>

<h2 id="71-一般饼图">7.1 一般饼图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="n">labels_pie</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">五星</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">四星</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">三星</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">二星</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">一星</span><span class="sh">"</span><span class="p">]</span>
<span class="n">percent_pie</span> <span class="o">=</span> <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mi">261</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="c1"># 某市星级酒店数量
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 偏移中心量，突出一部分
</span><span class="n">explode_pie</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># 为了突出四星级酒店
</span>
<span class="c1"># 绘制饼图
</span><span class="n">plt</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">percent_pie</span><span class="p">,</span> 
    <span class="n">explode</span><span class="o">=</span><span class="n">explode_pie</span><span class="p">,</span> 
    <span class="n">labels</span><span class="o">=</span><span class="n">labels_pie</span><span class="p">,</span> 
    <span class="n">colors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Paired</span><span class="p">.</span><span class="n">colors</span><span class="p">,</span> <span class="c1"># 颜色映射
</span>    <span class="n">autopct</span><span class="o">=</span><span class="sh">"</span><span class="s">%1.1f%%</span><span class="sh">"</span><span class="p">,</span> <span class="c1"># 保留一位小数的百分比
</span>    <span class="n">pctdistance</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>  <span class="c1"># 百分比文本距离圆心的比例
</span>    <span class="n">shadow</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span> <span class="c1"># 从90度开始绘制第一个扇形
</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">某市星级酒店数量分布</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">"</span><span class="s">equal</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># 确保饼图是圆形
</span><span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729131226108.png" alt="image-20250729131226108" style="zoom:50%;" /></p>

<h2 id="72-嵌套饼图">7.2 嵌套饼图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># 模拟数据
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">水果</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">水果</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">蔬菜</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">蔬菜</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">肉类</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">肉类</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">谷物</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">食材</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">苹果</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">香蕉</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">白菜</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">胡萝卜</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">猪肉</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">牛肉</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">大米</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">花费</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">food</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># --- 关键的修复步骤 ---
# 1. 明确定义内部饼图的顺序
#    这里我们仍然需要一个逻辑顺序来对齐内外层，即使颜色是自动的。
#    例如，我们可以根据类型名称的字母顺序，或者数据框中第一次出现的顺序。
#    为了确保内外层对应，最可靠的方法是先对数据进行排序。
#    这里我们沿用之前的逻辑，先按类型排序，这样同一类型的食材会聚集在一起。
</span><span class="n">food_sorted</span> <span class="o">=</span> <span class="n">food</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">花费</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>

<span class="c1"># 分组聚合，内圈数据（按照类型）
</span><span class="n">inner_data</span> <span class="o">=</span> <span class="n">food_sorted</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">)[</span><span class="sh">"</span><span class="s">花费</span><span class="sh">"</span><span class="p">].</span><span class="nf">sum</span><span class="p">()</span>
<span class="c1"># 确保 inner_data 的索引顺序与 food_sorted 中 type 出现的顺序一致
# (groupby 默认会排序，所以这里可以省略 reindex，但显式写出更清晰)
</span><span class="n">inner_data</span> <span class="o">=</span> <span class="n">inner_data</span><span class="p">.</span><span class="nf">reindex</span><span class="p">(</span><span class="n">food_sorted</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">())</span>


<span class="c1"># 外圈数据（按照食材）
</span><span class="n">outer_data</span> <span class="o">=</span> <span class="n">food_sorted</span><span class="p">[</span><span class="sh">"</span><span class="s">花费</span><span class="sh">"</span><span class="p">]</span>
<span class="n">outer_labels</span> <span class="o">=</span> <span class="n">food_sorted</span><span class="p">[</span><span class="sh">"</span><span class="s">食材</span><span class="sh">"</span><span class="p">]</span>


<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="sh">"</span><span class="s">font.size</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="c1"># 调整图表大小以获得更好的显示效果
</span>
<span class="c1"># 绘制内部饼图
# 使用 plt.cm.Set3.colors 作为内部饼图的颜色循环
</span><span class="n">wedges_inner</span><span class="p">,</span> <span class="n">texts_inner</span><span class="p">,</span> <span class="n">autotexts_inner</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inner_data</span><span class="p">,</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="n">wedgeprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">inner_data</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">labeldistance</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Set3</span><span class="p">.</span><span class="n">colors</span><span class="p">,</span> <span class="c1"># 让Matplotlib自动选择颜色
</span>    <span class="n">autopct</span><span class="o">=</span><span class="sh">"</span><span class="s">%1.1f%%</span><span class="sh">"</span>
<span class="p">)</span>

<span class="c1"># 调整内部百分比文本颜色
</span><span class="k">for</span> <span class="n">autotext</span> <span class="ow">in</span> <span class="n">autotexts_inner</span><span class="p">:</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_color</span><span class="p">(</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># 绘制外部饼图
# 使用 plt.cm.tab20.colors 作为外部饼图的颜色循环
</span><span class="n">wedges_outer</span><span class="p">,</span> <span class="n">texts_outer</span><span class="p">,</span> <span class="n">autotexts_outer</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">outer_data</span><span class="p">,</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">wedgeprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">outer_labels</span><span class="p">,</span> <span class="c1"># 使用排序后的食材标签
</span>    <span class="n">labeldistance</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span>
    <span class="n">autopct</span><span class="o">=</span><span class="sh">"</span><span class="s">%1.1f%%</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">pctdistance</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">tab20</span><span class="p">.</span><span class="n">colors</span> <span class="c1"># 让Matplotlib自动选择颜色，通常tab20颜色更多，适合外层
</span><span class="p">)</span>

<span class="c1"># 调整外部百分比文本颜色
</span><span class="k">for</span> <span class="n">autotext</span> <span class="ow">in</span> <span class="n">autotexts_outer</span><span class="p">:</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_color</span><span class="p">(</span><span class="sh">"</span><span class="s">darkred</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">食物花费嵌套饼图</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">"</span><span class="s">equal</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># 确保饼图是圆形
</span>
<span class="c1"># 图例标题
# 此时图例颜色将根据 Matplotlib 自动分配的颜色来显示
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">inner_data</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">食物类型</span><span class="sh">"</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">center left</span><span class="sh">"</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729133920300.png" alt="image-20250729133920300" style="zoom:50%;" /></p>

<h2 id="73-甜甜圈图">7.3 甜甜圈图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre></td><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

<span class="c1"># 数据
</span><span class="n">recipe</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">225g 面粉</span><span class="sh">"</span><span class="p">,</span>
          <span class="sh">"</span><span class="s">90g 糖</span><span class="sh">"</span><span class="p">,</span>
          <span class="sh">"</span><span class="s">1个鸡蛋</span><span class="sh">"</span><span class="p">,</span>
          <span class="sh">"</span><span class="s">60g 黄油</span><span class="sh">"</span><span class="p">,</span>
          <span class="sh">"</span><span class="s">100ml 牛奶</span><span class="sh">"</span><span class="p">,</span>
          <span class="sh">"</span><span class="s">1/2包酵母</span><span class="sh">"</span><span class="p">]</span>
<span class="n">data_donut</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">225</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="c1"># 归一化
</span><span class="n">data_donut_norm</span> <span class="o">=</span> <span class="n">data_donut</span> <span class="o">/</span> <span class="n">data_donut</span><span class="p">.</span><span class="nf">sum</span><span class="p">()</span>

<span class="c1"># 绘制甜甜圈图， 通过wedgeprops的width参数&lt;radius参数创造空心
</span><span class="n">wedges</span><span class="p">,</span> <span class="n">texts</span><span class="p">,</span> <span class="n">autotexts</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">data_donut_norm</span><span class="p">,</span>
    <span class="n">autopct</span><span class="o">=</span><span class="sh">"</span><span class="s">%1.1f%%</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">pctdistance</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> 
    <span class="n">radius</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
    <span class="n">wedgeprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># 甜甜圈的关键：width&lt;radius 
</span>    <span class="n">colors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">tab10</span><span class="p">.</span><span class="n">colors</span>
<span class="p">)</span>

<span class="c1"># 调整百分比文本颜色和大小
</span><span class="k">for</span> <span class="n">autotext</span> <span class="ow">in</span> <span class="n">autotexts</span><span class="p">:</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_color</span><span class="p">(</span><span class="sh">"</span><span class="s">white</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    
<span class="c1"># 添加注释和箭头指向每个扇形
</span><span class="n">bbox_props</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="sh">"</span><span class="s">round, pad=0.3</span><span class="sh">"</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.72</span><span class="p">)</span>
<span class="n">kw</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">(</span><span class="n">arrowprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">),</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">wedges</span><span class="p">):</span>
    <span class="n">ang</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">theta2</span> <span class="o">-</span> <span class="n">p</span><span class="p">.</span><span class="n">theta1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="n">p</span><span class="p">.</span><span class="n">theta1</span>  <span class="c1"># 计算扇形中心角度
</span>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">deg2rad</span><span class="p">(</span><span class="n">ang</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">deg2rad</span><span class="p">(</span><span class="n">ang</span><span class="p">))</span>
    <span class="c1"># 根据x坐标判断文本水平对齐方式，使其位于扇形外侧
</span>    <span class="n">ha</span><span class="o">=</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="sh">"</span><span class="s">right</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="sh">"</span><span class="s">left</span><span class="sh">"</span><span class="p">}[</span><span class="nf">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
    <span class="c1"># 箭头连接样式， 从扇形中心指向文本
</span>    <span class="n">connectionstyle</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">angle, angleA=0, angleB=</span><span class="si">{</span><span class="n">ang</span><span class="si">}</span><span class="sh">"</span>
    <span class="n">kw</span><span class="p">[</span><span class="sh">"</span><span class="s">arrowprops</span><span class="sh">"</span><span class="p">].</span><span class="nf">update</span><span class="p">({</span><span class="sh">"</span><span class="s">connectionstyle</span><span class="sh">"</span><span class="p">:</span><span class="n">connectionstyle</span><span class="p">})</span>
    
    <span class="c1"># xytext的位置需要根据x, y符号调整，确保文本在甜甜圈外侧
</span>    <span class="c1"># 1.4 * np.sign(x), 1.4*y确保文本在外部
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">annotate</span><span class="p">(</span>
        <span class="n">recipe</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">y</span><span class="p">),</span>
        <span class="n">ha</span><span class="o">=</span><span class="n">ha</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
        <span class="n">weight</span><span class="o">=</span><span class="sh">"</span><span class="s">bold</span><span class="sh">"</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kw</span>
    <span class="p">)</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">甜甜圈图----&gt;</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">"</span><span class="s">equal</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>如果希望图片更加清晰，可以调整<code class="language-plaintext highlighter-rouge">dpi</code>参数.</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729135617213.png" alt="image-20250729135617213" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.pie()</code> 函数中，哪个参数用于设置饼图中间的空心，从而创建甜甜圈图？</p>

    <p>A. <code class="language-plaintext highlighter-rouge">radius</code> B. <code class="language-plaintext highlighter-rouge">width</code> (在 <code class="language-plaintext highlighter-rouge">wedgeprops</code> 中) C. <code class="language-plaintext highlighter-rouge">explode</code> D. <code class="language-plaintext highlighter-rouge">pctdistance</code></p>

    <blockquote>
      <p>答案：B，<code class="language-plaintext highlighter-rouge">wedgeprops=dict(width=...)</code> 可以控制扇形的宽度，当宽度小于半径时，中间就会形成空心。</p>
    </blockquote>
  </li>
  <li>
    <p>如果饼图中有多个类别，并且希望突出显示其中一个类别，应该调整哪个参数？ A. <code class="language-plaintext highlighter-rouge">labels</code> B. <code class="language-plaintext highlighter-rouge">colors</code> C. <code class="language-plaintext highlighter-rouge">explode</code> D. <code class="language-plaintext highlighter-rouge">autopct</code></p>

    <blockquote>
      <p>答案：C，<code class="language-plaintext highlighter-rouge">explode</code> 参数是一个与数据长度相同的序列，通过指定非零值，可以将对应的扇形从圆心拉出，达到突出显示的效果。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>绘制一个嵌套饼图，展示一个公司的部门结构和员工分布。
    <ul>
      <li><strong>内圈</strong>: 部门类别和员工总数。
        <ul>
          <li>研发部: 150 人</li>
          <li>销售部: 100 人</li>
          <li>行政部: 50 人</li>
        </ul>
      </li>
      <li><strong>外圈</strong>: 各部门内部的子类别和员工数量。
        <ul>
          <li>研发部: 前端 (70), 后端 (80)</li>
          <li>销售部: 国内 (60), 国际 (40)</li>
          <li>行政部: 人力资源 (30), 财务 (20)</li>
        </ul>
      </li>
      <li>内圈和外圈使用不同的颜色映射。</li>
      <li>显示百分比，保留一位小数。</li>
      <li>添加标题 “Company Employee Distribution”。</li>
      <li>为内圈添加图例，标题为 “Department”。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># 模拟数据
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">研发部</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">研发部</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">销售部</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">销售部</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">行政部</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">行政部</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">子类别</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">前端</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">后端</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">国内</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">国际</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">人力资源</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">财务</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">员工人数</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">food</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># --- 关键的修复步骤 ---
# 1. 明确定义内部饼图的顺序
#    这里我们仍然需要一个逻辑顺序来对齐内外层，即使颜色是自动的。
#    例如，我们可以根据类型名称的字母顺序，或者数据框中第一次出现的顺序。
#    为了确保内外层对应，最可靠的方法是先对数据进行排序。
#    这里我们沿用之前的逻辑，先按类型排序，这样同一类型的食材会聚集在一起。
</span><span class="n">food_sorted</span> <span class="o">=</span> <span class="n">food</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">员工人数</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>

<span class="c1"># 分组聚合，内圈数据（按照类型）
</span><span class="n">inner_data</span> <span class="o">=</span> <span class="n">food_sorted</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">)[</span><span class="sh">"</span><span class="s">员工人数</span><span class="sh">"</span><span class="p">].</span><span class="nf">sum</span><span class="p">()</span>
<span class="c1"># 确保 inner_data 的索引顺序与 food_sorted 中 type 出现的顺序一致
# (groupby 默认会排序，所以这里可以省略 reindex，但显式写出更清晰)
</span><span class="n">inner_data</span> <span class="o">=</span> <span class="n">inner_data</span><span class="p">.</span><span class="nf">reindex</span><span class="p">(</span><span class="n">food_sorted</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">())</span>


<span class="c1"># 外圈数据（按照食材）
</span><span class="n">outer_data</span> <span class="o">=</span> <span class="n">food_sorted</span><span class="p">[</span><span class="sh">"</span><span class="s">员工人数</span><span class="sh">"</span><span class="p">]</span>
<span class="n">outer_labels</span> <span class="o">=</span> <span class="n">food_sorted</span><span class="p">[</span><span class="sh">"</span><span class="s">子类别</span><span class="sh">"</span><span class="p">]</span>


<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="sh">"</span><span class="s">font.size</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="c1"># 调整图表大小以获得更好的显示效果
</span>
<span class="c1"># 绘制内部饼图
# 使用 plt.cm.Set3.colors 作为内部饼图的颜色循环
</span><span class="n">wedges_inner</span><span class="p">,</span> <span class="n">texts_inner</span><span class="p">,</span> <span class="n">autotexts_inner</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inner_data</span><span class="p">,</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="n">wedgeprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">inner_data</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">labeldistance</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Set3</span><span class="p">.</span><span class="n">colors</span><span class="p">,</span> <span class="c1"># 让Matplotlib自动选择颜色
</span>    <span class="n">autopct</span><span class="o">=</span><span class="sh">"</span><span class="s">%1.1f%%</span><span class="sh">"</span>
<span class="p">)</span>

<span class="c1"># 调整内部百分比文本颜色
</span><span class="k">for</span> <span class="n">autotext</span> <span class="ow">in</span> <span class="n">autotexts_inner</span><span class="p">:</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_color</span><span class="p">(</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># 绘制外部饼图
# 使用 plt.cm.tab20.colors 作为外部饼图的颜色循环
</span><span class="n">wedges_outer</span><span class="p">,</span> <span class="n">texts_outer</span><span class="p">,</span> <span class="n">autotexts_outer</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">outer_data</span><span class="p">,</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">wedgeprops</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">outer_labels</span><span class="p">,</span> <span class="c1"># 使用排序后的食材标签
</span>    <span class="n">labeldistance</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span>
    <span class="n">autopct</span><span class="o">=</span><span class="sh">"</span><span class="s">%1.1f%%</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">pctdistance</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
    <span class="n">colors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">tab20</span><span class="p">.</span><span class="n">colors</span> <span class="c1"># 让Matplotlib自动选择颜色，通常tab20颜色更多，适合外层
</span><span class="p">)</span>

<span class="c1"># 调整外部百分比文本颜色
</span><span class="k">for</span> <span class="n">autotext</span> <span class="ow">in</span> <span class="n">autotexts_outer</span><span class="p">:</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_color</span><span class="p">(</span><span class="sh">"</span><span class="s">darkred</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">autotext</span><span class="p">.</span><span class="nf">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Company Employee Distribution</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">"</span><span class="s">equal</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># 确保饼图是圆形
</span>
<span class="c1"># 图例标题
# 此时图例颜色将根据 Matplotlib 自动分配的颜色来显示
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">inner_data</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Department</span><span class="sh">"</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">center left</span><span class="sh">"</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>如果想要调整图片清晰度，可以调整dpi参数：</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729141249207.png" alt="image-20250729141249207" style="zoom:50%;" /></p>

<h1 id="8热力图-heatmap">8.热力图 (Heatmap)</h1>

<p>热力图是一种通过颜色深浅来表示数据矩阵中数值大小的图表。它常用于可视化相关性矩阵、混淆矩阵或任何二维网格数据。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.imshow(X, cmap=None, norm=None, aspect=None, interpolation=None, alpha=None, vmin=None, vmax=None, origin=None, extent=None, filternorm=1, filterrad=4.0, resample=None, **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.imshow(...)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">X</code>: 要可视化的二维数组（矩阵）。</li>
  <li><code class="language-plaintext highlighter-rouge">cmap</code>: 颜色映射 (Colormap) 对象或名称（例如 <code class="language-plaintext highlighter-rouge">'viridis'</code>, <code class="language-plaintext highlighter-rouge">'hot'</code>, <code class="language-plaintext highlighter-rouge">'cool'</code>, <code class="language-plaintext highlighter-rouge">'RdBu'</code>）。</li>
  <li><code class="language-plaintext highlighter-rouge">norm</code>: 用于将数据值归一化到颜色映射范围（通常是 0 到 1）的 <code class="language-plaintext highlighter-rouge">Normalize</code> 对象。</li>
  <li><code class="language-plaintext highlighter-rouge">aspect</code>: 图像的宽高比。<code class="language-plaintext highlighter-rouge">'auto'</code> (默认) 自动调整，<code class="language-plaintext highlighter-rouge">'equal'</code> 保持像素的方形。</li>
  <li><code class="language-plaintext highlighter-rouge">interpolation</code>: 图像插值方法（例如 <code class="language-plaintext highlighter-rouge">'nearest'</code>, <code class="language-plaintext highlighter-rouge">'bilinear'</code>, <code class="language-plaintext highlighter-rouge">'bicubic'</code>）。</li>
  <li><code class="language-plaintext highlighter-rouge">alpha</code>: 图像的透明度。</li>
  <li><code class="language-plaintext highlighter-rouge">vmin</code>, <code class="language-plaintext highlighter-rouge">vmax</code>: 颜色映射的数据范围。</li>
  <li><code class="language-plaintext highlighter-rouge">origin</code>: 图像的原点位置（<code class="language-plaintext highlighter-rouge">'upper'</code> (默认) 或 <code class="language-plaintext highlighter-rouge">'lower'</code>）。</li>
  <li><code class="language-plaintext highlighter-rouge">extent</code>: 图像的 X 和 Y 轴数据范围 <code class="language-plaintext highlighter-rouge">(left, right, bottom, top)</code>。</li>
</ul>

<p>热力图通常与 <code class="language-plaintext highlighter-rouge">plt.colorbar()</code> 结合使用，以解释颜色与数值的对应关系。</p>

<p><strong>在热力图上添加文本</strong>： 可以通过嵌套循环遍历数据矩阵的每个单元格，然后使用 <code class="language-plaintext highlighter-rouge">ax.text()</code> 在每个单元格的中心位置添加对应的数值文本。</p>

<p>下面这个例子就展示了混淆矩阵：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># 模拟真实标签和预测标签
</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># 计算混淆矩阵
</span><span class="n">cm</span> <span class="o">=</span> <span class="nf">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">Class 0</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Class 1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Class 2</span><span class="sh">'</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">Blues</span><span class="sh">'</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span>
            <span class="n">linewidths</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Predicted Label</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">True Label</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Confusion Matrix</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729141443863.png" alt="image-20250729141443863" style="zoom:50%;" /></p>

<hr />

<p>例子：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="c1"># 准备数据：
</span><span class="n">vegetables</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">黄瓜</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">番茄</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">生菜</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">芦笋</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">土豆</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">小麦</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">大麦</span><span class="sh">"</span><span class="p">]</span>
<span class="n">farmers</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">农民A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">农民B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">农民C</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">农民D</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">农民E</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">农民F</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">农民G</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># 模拟农民丰收的数据
</span><span class="n">harvest</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">vegetables</span><span class="p">),</span> <span class="nf">len</span><span class="p">(</span><span class="n">farmers</span><span class="p">))</span>  <span class="c1"># 7*7的矩阵（方阵）
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 绘制热力图
# cmap="YIGnBu"是一个从浅黄到深绿蓝的颜色映射
# `origin`: 图像的原点位置（`'upper'` (默认) 或 `'lower'`）。
# `aspect`: 图像的宽高比。`'auto'` (默认) 自动调整，`'equal'` 保持像素的方形。
</span><span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">harvest</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="sh">"</span><span class="s">YlGnBu</span><span class="sh">"</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="sh">"</span><span class="s">upper</span><span class="sh">"</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="sh">"</span><span class="s">auto</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 设置X轴和Y轴的刻度标签
</span><span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">farmers</span><span class="p">)),</span> <span class="n">farmers</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="sh">"</span><span class="s">right</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">yticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">vegetables</span><span class="p">)),</span> <span class="n">vegetables</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># 绘制每个单元格的数值文本
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">vegetables</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">farmers</span><span class="p">)):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span>
            <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span>
            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">harvest</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> 
            <span class="n">weight</span><span class="o">=</span><span class="sh">"</span><span class="s">bold</span><span class="sh">"</span>
        <span class="p">)</span>
        
<span class="c1"># 添加颜色条和标题
</span><span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">本地农民农作物收成（吨/年）</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">cbar</span><span class="p">.</span><span class="nf">set_label</span><span class="p">(</span><span class="sh">"</span><span class="s">收成（吨）</span><span class="sh">"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729142938116.png" alt="image-20250729142938116" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.imshow(X, ...)</code> 中，<code class="language-plaintext highlighter-rouge">X</code> 参数通常是什么类型的数据？ A. 一维数组 B. 二维数组（矩阵） C. 字符串 D. 列表</p>

    <blockquote>
      <p>答案：B，<code class="language-plaintext highlighter-rouge">imshow</code> 用于显示图像或二维数据，因此 <code class="language-plaintext highlighter-rouge">X</code> 必须是二维数组。</p>
    </blockquote>
  </li>
  <li>
    <p>要为热力图添加一个解释颜色与数值对应关系的图例，应该使用哪个函数？</p>

    <p>A. <code class="language-plaintext highlighter-rouge">plt.legend()</code> B. <code class="language-plaintext highlighter-rouge">plt.colorbar()</code> C. <code class="language-plaintext highlighter-rouge">plt.text()</code> D. <code class="language-plaintext highlighter-rouge">plt.title()</code></p>

    <blockquote>
      <p>答案：B，<code class="language-plaintext highlighter-rouge">plt.colorbar()</code> 用于创建颜色条，它与 <code class="language-plaintext highlighter-rouge">imshow</code> 或其他使用颜色映射的函数结合使用。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>创建一个 5x5 的随机整数矩阵，数值范围在 1 到 100 之间。</li>
  <li>绘制这个矩阵的热力图。
    <ul>
      <li>使用 <code class="language-plaintext highlighter-rouge">'hot'</code> 颜色映射。</li>
      <li>显示每个单元格的数值。</li>
      <li>添加标题 “Random 5x5 Matrix Heatmap”。</li>
      <li>添加 X 轴和 Y 轴标签，分别为 “Column Index” 和 “Row Index”。</li>
      <li>添加颜色条，标签为 “Value”。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="sh">"</span><span class="s">hot</span><span class="sh">"</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="sh">"</span><span class="s">upper</span><span class="sh">"</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="sh">"</span><span class="s">auto</span><span class="sh">"</span><span class="p">)</span>


<span class="c1"># 绘制每个单元格的数值文本
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span>
            <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span>
            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="sh">"</span><span class="s">center</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> 
            <span class="n">weight</span><span class="o">=</span><span class="sh">"</span><span class="s">bold</span><span class="sh">"</span>
        <span class="p">)</span>
        
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Random 5x5 Matrix Heatmap</span><span class="sh">"</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Column Index</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Row Index</span><span class="sh">"</span><span class="p">)</span>


<span class="c1"># 添加颜色条和标题
</span><span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">cbar</span><span class="p">.</span><span class="nf">set_label</span><span class="p">(</span><span class="sh">"</span><span class="s">Value</span><span class="sh">"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729143559913.png" alt="image-20250729143559913" style="zoom:50%;" /></p>

<h1 id="9面积图-area-plot">9.面积图 (Area Plot)</h1>

<p>面积图是一种特殊的折线图，它通过填充曲线下方的区域来表示数值。当有多条曲线时，面积图可以是堆叠的，用于显示各部分随时间或类别变化的构成。</p>

<p>主要函数是 <code class="language-plaintext highlighter-rouge">plt.stackplot(x, *args, labels=None, colors=None, baseline='zero', **kwargs)</code> 或 <code class="language-plaintext highlighter-rouge">ax.stackplot(...)</code>。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">x</code>: X 轴数据（通常是时间或有序类别）。</li>
  <li><code class="language-plaintext highlighter-rouge">*args</code>: 要堆叠的 Y 轴数据序列。每个序列代表一个层。</li>
  <li><code class="language-plaintext highlighter-rouge">labels</code>: 每个层的标签列表，用于图例。</li>
  <li><code class="language-plaintext highlighter-rouge">colors</code>: 每个层的颜色列表。</li>
  <li><code class="language-plaintext highlighter-rouge">baseline</code>: 堆叠的基线类型。
    <ul>
      <li><code class="language-plaintext highlighter-rouge">'zero'</code> (默认): 从 Y=0 开始堆叠。</li>
      <li><code class="language-plaintext highlighter-rouge">'sym'</code> (symmetric): 堆叠在 Y=0 的两侧对称。</li>
      <li><code class="language-plaintext highlighter-rouge">'wiggle'</code>: 最小化层之间的平方斜率。</li>
      <li><code class="language-plaintext highlighter-rouge">'weighted_wiggle'</code>: 最小化加权平方斜率。</li>
    </ul>
  </li>
</ul>

<p>面积图特别适合展示“部分到整体”的关系随时间的变化。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1"># 1. 准备数据
</span><span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="c1"># 5天
</span><span class="n">sleeping</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="c1"># 睡眠时间
</span><span class="n">eating</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="c1"># 吃饭时间
</span><span class="n">working</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="c1"># 工作时间
</span><span class="n">playing</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span> <span class="c1"># 娱乐时间
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># 绘制堆叠面积图
</span><span class="n">plt</span><span class="p">.</span><span class="nf">stackplot</span><span class="p">(</span>
    <span class="n">days</span><span class="p">,</span>
    <span class="n">sleeping</span><span class="p">,</span>
    <span class="n">eating</span><span class="p">,</span>
    <span class="n">working</span><span class="p">,</span>
    <span class="n">playing</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Sleeping</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Eating</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Working</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Playing</span><span class="sh">'</span><span class="p">],</span> <span class="c1"># 每个层的标签
</span>    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">#6d904f</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">#fc4f30</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">#008fd5</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">#e5ae38</span><span class="sh">'</span><span class="p">],</span> <span class="c1"># 自定义颜色
</span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span> <span class="c1"># 透明度
</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Day of the Week</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Hours Spent</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Daily Activities Stack Plot</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">upper left</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729143940332.png" alt="image-20250729143940332" style="zoom:50%;" /></p>

<h2 id="拓展不同基线的面积图">拓展:不同基线的面积图</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">x_base</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y1_base</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">x_base</span><span class="p">)</span>
<span class="n">y2_base</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">x_base</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="c1"># baseline="sym"   堆叠在 Y=0 的两侧对称
</span><span class="n">plt</span><span class="p">.</span><span class="nf">stackplot</span><span class="p">(</span><span class="n">x_base</span><span class="p">,</span> <span class="n">y1_base</span><span class="p">,</span> <span class="n">y2_base</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">Sin</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Cos</span><span class="sh">"</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="sh">"</span><span class="s">sym</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Symmetric Stack Plot</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">X-axis</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Y-axis</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">:</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729144224885.png" alt="image-20250729144224885" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>面积图主要用于展示什么？</p>

    <p>A. 两个变量之间的相关性。 B. 各部分在整体中的构成随时间的变化。 C. 数据点的分布情况。 D. 数据的中位数和四分位数。</p>

    <blockquote>
      <p>答案：B，面积图通过堆叠不同部分的面积来展示整体构成随时间或有序类别的变化。</p>
    </blockquote>
  </li>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">plt.stackplot()</code> 中，哪个参数用于指定堆叠的起始基线？ A. <code class="language-plaintext highlighter-rouge">labels</code> B. <code class="language-plaintext highlighter-rouge">colors</code> C. <code class="language-plaintext highlighter-rouge">baseline</code> D. <code class="language-plaintext highlighter-rouge">alpha</code></p>

    <blockquote>
      <p>答案：C，<code class="language-plaintext highlighter-rouge">baseline</code> 参数决定了堆叠的起始基线，例如 <code class="language-plaintext highlighter-rouge">'zero'</code> 从 Y=0 开始。</p>

      <p><code class="language-plaintext highlighter-rouge">baseline</code>: 堆叠的基线类型。</p>

      <ul>
        <li><code class="language-plaintext highlighter-rouge">'zero'</code> (默认): 从 Y=0 开始堆叠。</li>
        <li><code class="language-plaintext highlighter-rouge">'sym'</code> (symmetric): 堆叠在 Y=0 的两侧对称。</li>
        <li><code class="language-plaintext highlighter-rouge">'wiggle'</code>: 最小化层之间的平方斜率。</li>
        <li><code class="language-plaintext highlighter-rouge">'weighted_wiggle'</code>: 最小化加权平方斜率。</li>
      </ul>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>模拟一个网站在 7 天内的不同流量来源（”Direct”, “Search Engine”, “Social Media”）。
    <ul>
      <li>Direct 流量: <code class="language-plaintext highlighter-rouge">[50, 60, 55, 70, 80, 75, 90]</code></li>
      <li>Search Engine 流量: <code class="language-plaintext highlighter-rouge">[30, 40, 45, 50, 60, 65, 70]</code></li>
      <li>Social Media 流量: <code class="language-plaintext highlighter-rouge">[20, 25, 30, 35, 40, 45, 50]</code></li>
    </ul>
  </li>
  <li>绘制这些流量来源的堆叠面积图。
    <ul>
      <li>X 轴为天数 (1到7)。</li>
      <li>为每个流量来源指定不同的颜色。</li>
      <li>添加标题 “Website Traffic Sources Over 7 Days”。</li>
      <li>添加 X 轴标签 “Day” 和 Y 轴标签 “Traffic Count”。</li>
      <li>显示图例。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="c1"># 1. 准备数据
</span><span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="c1"># 7天
</span><span class="n">direct</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="n">search_engine</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">social_media</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># 绘制堆叠面积图
</span><span class="n">plt</span><span class="p">.</span><span class="nf">stackplot</span><span class="p">(</span>
    <span class="n">days</span><span class="p">,</span>
    <span class="n">direct</span><span class="p">,</span>
    <span class="n">search_engine</span><span class="p">,</span>
    <span class="n">social_media</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">direct</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Search Engine</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Social Media</span><span class="sh">'</span><span class="p">],</span> <span class="c1"># 每个层的标签
</span>    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">#6d904f</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">#fc4f30</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">#008fd5</span><span class="sh">'</span><span class="p">],</span> <span class="c1"># 自定义颜色
</span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span> <span class="c1"># 透明度
</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Day</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Traffic Count</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Website Traffic Sources Over 7 Days</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">upper left</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729144634462.png" alt="image-20250729144634462" style="zoom:50%;" /></p>

<h1 id="10蜘蛛图-radar-chart--spider-plot">10.蜘蛛图 (Radar Chart / Spider Plot)</h1>

<p>蜘蛛图（又称雷达图）是一种多变量图表，用于比较多个实体在多个定量变量上的表现。它将每个变量表示为从中心点向外辐射的轴，数据点沿着这些轴绘制并连接起来，形成一个多边形。</p>

<p>创建蜘蛛图的关键是使用极坐标投影 <code class="language-plaintext highlighter-rouge">projection='polar'</code>，然后设置角度刻度标签和径向刻度。</p>

<p>主要步骤：</p>

<ol>
  <li><strong>数据准备</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">labels</code>: 维度标签（例如，技能名称、属性）。</li>
      <li><code class="language-plaintext highlighter-rouge">stats</code>: 每个维度上的数值。</li>
      <li><code class="language-plaintext highlighter-rouge">angles</code>: 计算每个维度在极坐标系中的角度。通常将 2pi 平分为 <code class="language-plaintext highlighter-rouge">len(labels)</code> 份。为了闭合多边形，需要将第一个数据点和角度复制到末尾。</li>
    </ul>
  </li>
  <li><strong>创建极坐标 Axes</strong>: <code class="language-plaintext highlighter-rouge">fig.add_subplot(111, polar=True)</code>。</li>
  <li><strong>绘制多边形</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ax.plot(angles, stats, 'o-', linewidth=2)</code>: 绘制连接数据点的折线。</li>
      <li><code class="language-plaintext highlighter-rouge">ax.fill(angles, stats, alpha=0.25)</code>: 填充多边形区域。</li>
    </ul>
  </li>
  <li><strong>设置刻度</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ax.set_thetagrids(angles * 180 / np.pi, labels)</code>: 设置角度轴的刻度位置和标签。<code class="language-plaintext highlighter-rouge">angles * 180 / np.pi</code> 将弧度转换为度数。</li>
      <li><code class="language-plaintext highlighter-rouge">ax.set_rgrids(radii_ticks)</code>: 设置径向轴的刻度位置。</li>
      <li><code class="language-plaintext highlighter-rouge">ax.set_ylim(min_val, max_val)</code>: 设置径向轴的显示范围。</li>
    </ul>
  </li>
  <li><strong>标题</strong>: <code class="language-plaintext highlighter-rouge">ax.set_title(...)</code>。</li>
</ol>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="c1"># 1. 准备数据
</span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="sh">"</span><span class="s">个人能力</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">IQ</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">服务意识</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">团队精神</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">解决问题能力</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">持续学习</span><span class="sh">"</span><span class="p">])</span>
<span class="n">stats_person1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span> <span class="c1"># 某人的能力得分
</span><span class="n">stats_person2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span> <span class="c1"># 另一个人或团队的能力得分
</span>
<span class="c1"># 2. 画图数据准备：计算角度
</span><span class="n">num_vars</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">num_vars</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="nf">tolist</span><span class="p">()</span> <span class="c1"># 角度列表
# 为了闭合图形，需要将第一个数据点和角度复制到末尾
</span><span class="n">stats_person1</span> <span class="o">=</span> <span class="n">stats_person1</span> <span class="o">+</span> <span class="n">stats_person1</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">stats_person2</span> <span class="o">=</span> <span class="n">stats_person2</span> <span class="o">+</span> <span class="n">stats_person2</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span> <span class="o">+</span> <span class="n">angles</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># 3. 用Matplotlib画蜘蛛图
</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># 创建极坐标 Axes
</span>
<span class="c1"># 绘制第一个人的数据
</span><span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_person1</span><span class="p">,</span> <span class="sh">'</span><span class="s">o-</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Person A</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># 连线
</span><span class="n">ax</span><span class="p">.</span><span class="nf">fill</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_person1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span> <span class="c1"># 填充
</span>
<span class="c1"># 绘制第二个人的数据
</span><span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_person2</span><span class="p">,</span> <span class="sh">'</span><span class="s">o-</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Person B</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># 连线
</span><span class="n">ax</span><span class="p">.</span><span class="nf">fill</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_person2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span> <span class="c1"># 填充
</span>
<span class="c1"># 4. 设置角度轴标签
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_thetagrids</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">angles</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># 角度值和标签
</span>
<span class="c1"># 5. 设置径向轴刻度
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_rgrids</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># 半径刻度
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># 设置径向轴范围 (0-100分)
</span>
<span class="c1"># 6. 添加标题和图例
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">个人能力雷达图对比</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">upper right</span><span class="sh">'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># 调整图例位置
</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">:</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729144842415.png" alt="image-20250729144842415" style="zoom:50%;" /></p>

<p><strong>选择题</strong></p>

<ol>
  <li>
    <p>创建蜘蛛图时，需要将 <code class="language-plaintext highlighter-rouge">Axes</code> 对象的 <code class="language-plaintext highlighter-rouge">projection</code> 参数设置为： A. <code class="language-plaintext highlighter-rouge">'cartesian'</code> B. <code class="language-plaintext highlighter-rouge">'3d'</code> C. <code class="language-plaintext highlighter-rouge">'polar'</code> D. <code class="language-plaintext highlighter-rouge">'rectilinear'</code></p>

    <blockquote>
      <p>答案：C，蜘蛛图是基于极坐标系的。</p>
    </blockquote>
  </li>
  <li>
    <p>在绘制蜘蛛图时，为了使多边形闭合，通常需要对数据和角度进行什么操作？</p>

    <p>A. 将所有数据点乘以 2。</p>

    <p>B. 将第一个数据点和角度复制到序列的末尾。</p>

    <p>C. 将最后一个数据点和角度复制到序列的开头。</p>

    <p>D. 对数据进行排序。</p>

    <blockquote>
      <p>答案：B，这样做可以使绘制的折线从最后一个点连接回第一个点，从而形成闭合的多边形。</p>
    </blockquote>
  </li>
</ol>

<p><strong>编程题</strong></p>

<ol>
  <li>模拟两款手机在以下五个方面的评分（满分 10 分）：
    <ul>
      <li><strong>方面</strong>: “性能”, “拍照”, “续航”, “屏幕”, “价格”</li>
      <li><strong>手机 A 评分</strong>: <code class="language-plaintext highlighter-rouge">[8, 7, 9, 8, 6]</code></li>
      <li><strong>手机 B 评分</strong>: <code class="language-plaintext highlighter-rouge">[7, 9, 7, 9, 8]</code></li>
    </ul>
  </li>
  <li>绘制这两款手机的蜘蛛图。
    <ul>
      <li>手机 A 的线条颜色为蓝色，填充颜色为浅蓝色。</li>
      <li>手机 B 的线条颜色为绿色，填充颜色为浅绿色。</li>
      <li>设置径向轴范围为 0 到 10。</li>
      <li>添加标题 “Smartphone Comparison Radar Chart”。</li>
      <li>显示图例。</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="c1"># 1. 准备数据
</span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="sh">"</span><span class="s">性能</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">拍照</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">续航</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">屏幕</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">价格</span><span class="sh">"</span><span class="p">])</span>
<span class="n">stats_A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">stats_B</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>

<span class="c1"># 2. 画图数据准备：计算角度
</span><span class="n">num_vars</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">num_vars</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="nf">tolist</span><span class="p">()</span> <span class="c1"># 角度列表
# 为了闭合图形，需要将第一个数据点和角度复制到末尾
</span><span class="n">stats_A</span> <span class="o">=</span> <span class="n">stats_A</span> <span class="o">+</span> <span class="n">stats_A</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">stats_B</span> <span class="o">=</span> <span class="n">stats_B</span> <span class="o">+</span> <span class="n">stats_B</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span> <span class="o">+</span> <span class="n">angles</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># 3. 用Matplotlib画蜘蛛图
</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># 创建极坐标 Axes
</span>
<span class="c1"># 绘制第一个人的数据
</span><span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_A</span><span class="p">,</span> <span class="sh">'</span><span class="s">o-</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">手机A</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># 连线
</span><span class="n">ax</span><span class="p">.</span><span class="nf">fill</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_A</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">lightblue</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span> <span class="c1"># 填充
</span>
<span class="c1"># 绘制第二个人的数据
</span><span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_B</span><span class="p">,</span> <span class="sh">'</span><span class="s">o-</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">手机B</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># 连线
</span><span class="n">ax</span><span class="p">.</span><span class="nf">fill</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">stats_B</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">lightgreen</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span> <span class="c1"># 填充
</span>
<span class="c1"># 4. 设置角度轴标签
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_thetagrids</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">angles</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># 角度值和标签
</span>
<span class="c1"># 5. 设置径向轴刻度
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_rgrids</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># 半径刻度
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># 设置径向轴范围 (0-100分)
</span>
<span class="c1"># 6. 添加标题和图例
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">Smartphone Comparison Radar Chart</span><span class="sh">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">upper right</span><span class="sh">'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># 调整图例位置
</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">:</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250729145421735.png" alt="image-20250729145421735" style="zoom:50%;" /></p>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2025/07/28/matplotlib%E6%96%87%E6%9C%AC%E6%B3%A8%E9%87%8A%E7%AE%AD%E5%A4%B4/" data-toggle="tooltip" data-placement="top" title="matplotlib-文本注释箭头">
                        Previous<br>
                        <span>matplotlib-文本注释箭头</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2025/08/01/matplotlib3D%E5%9B%BE%E5%BD%A2/" data-toggle="tooltip" data-placement="top" title="matplotlib-3D图形">
                        Next<br>
                        <span>matplotlib-3D图形</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0176" 
                    href="/archive/?tag=%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB"
                    title="书籍阅读"
                    rel="3">书籍阅读</a>
        
                <a data-sort="0138" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95"
                    title="算法"
                    rel="41">算法</a>
        
                <a data-sort="0161" 
                    href="/archive/?tag=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI%E5%9F%BA%E7%A1%80"
                    title="人工智能AI基础"
                    rel="18">人工智能AI基础</a>
        
                <a data-sort="0162" 
                    href="/archive/?tag=python%E5%9F%BA%E7%A1%80"
                    title="python基础"
                    rel="17">python基础</a>
        
                <a data-sort="0164" 
                    href="/archive/?tag=%E5%8A%9B%E6%89%A3"
                    title="力扣"
                    rel="15">力扣</a>
        
                <a data-sort="0166" 
                    href="/archive/?tag=numpy"
                    title="numpy"
                    rel="13">numpy</a>
        
                <a data-sort="0166" 
                    href="/archive/?tag=pandas"
                    title="pandas"
                    rel="13">pandas</a>
        
                <a data-sort="0167" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%90%B4%E6%81%A9%E8%BE%BE"
                    title="机器学习-吴恩达"
                    rel="12">机器学习-吴恩达</a>
        
                <a data-sort="0168" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95"
                    title="机器学习算法"
                    rel="11">机器学习算法</a>
        
                <a data-sort="0173" 
                    href="/archive/?tag=matplotlib"
                    title="matplotlib"
                    rel="6">matplotlib</a>
        
                <a data-sort="0176" 
                    href="/archive/?tag=AI%E6%80%9D%E6%83%B3%E5%90%AF%E8%92%99"
                    title="AI思想启蒙"
                    rel="3">AI思想启蒙</a>
        
                <a data-sort="0176" 
                    href="/archive/?tag=spring6"
                    title="spring6"
                    rel="3">spring6</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95%E9%A2%98%E5%BA%93"
                    title="算法题库"
                    rel="2">算法题库</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=Java%E5%9F%BA%E7%A1%80"
                    title="Java基础"
                    rel="2">Java基础</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=java%E9%9B%86%E5%90%88"
                    title="java集合"
                    rel="2">java集合</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=ollama%E5%B7%A5%E5%85%B7"
                    title="ollama工具"
                    rel="2">ollama工具</a>
        
                <a data-sort="0177" 
                    href="/archive/?tag=python%E7%88%AC%E8%99%AB"
                    title="python爬虫"
                    rel="2">python爬虫</a>
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://m.freebuf.com/">freebuf</a></li>
  
  <li><a href="https://xz.aliyun.com/">先知</a></li>
  
  <li><a href="https://www.sec-in.com/All">sec-in</a></li>
  
  <li><a href="https://paper.seebug.org/">see-bug</a></li>
  
  <li><a href="https://twitter.com/Concurr21486093">我的推特</a></li>
  
  <li><a href="https://pdai.tech/">pdai</a></li>
  
  <li><a href="https://nodejs.org/dist/">nodejs index of dist</a></li>
  
  <li><a href="#">公众号：小东方不败</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/Concurr21486093">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/Hilda">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">知</i>
      </span>
    </a>
  </li>
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/kirsten-1">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Hilda 2025
                    <br>
                    Powered by <a href="https://kirsten-1.github.io/">hilda Blog</a>
<!--                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"-->
<!--                        height="20px"-->
<!--                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">-->
<!--                    </iframe>-->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
