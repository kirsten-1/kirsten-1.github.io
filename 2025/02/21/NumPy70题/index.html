<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="这里是 Hilda 的个人博客，与你一起发现更大的世界 | 要做一个有 swag 的程序员">
    <meta name="keywords" content="Hilda">
    <meta name="theme-color" content="#000000">

    <!-- Open Graph -->
    <meta property="og:title"
        content="NumPy 70题 - Hilda的博客 | Your genius girlfriend's blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="

">
    
    <meta property="article:published_time" content=" 2025-02-21T00:00:00Z">
    
    
    <meta property="article:author" content="Hilda">
    
    
    <meta property="article:tag" content="面试习题">
    
    
    <meta property="og:image" content="https://kirsten-1.github.io">
    <meta property="og:url" content="https://kirsten-1.github.io/2025/02/21/NumPy70%E9%A2%98/">
    <meta property="og:site_name" content="Hilda的博客 | Your genius girlfriend's blog">

    <title>NumPy 70题 - Hilda的博客 | Your genius girlfriend's blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://kirsten-1.github.io/2025/02/21/NumPy70%E9%A2%98/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href=" /css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"
        type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-6487568398225121" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Hilda</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script>
    <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-2015.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/post-bg-2015.jpg');
        background: ;
    }

    
</style>




<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=%E9%9D%A2%E8%AF%95%E4%B9%A0%E9%A2%98" title="面试习题">面试习题</a>
                        
                    </div>
                    <h1>NumPy 70题</h1>
                    
                    <h2 class="subheading">NumPy 70道习题（题目+答案）</h2>
                    <span class="meta">Posted by Hilda on February 21, 2025</span>
                </div>
            </div>
        </div>
    </div>
</header>







<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG">
</script>

<p><a href="https://kirsten-1.github.io/2025/02/14/NumPy%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97(%E7%AC%AC2%E7%89%88)%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93/">《Python数据分析基础教程：NumPy学习指南（第2版）》所有章节阅读笔记+代码</a></p>

<hr />

<h1 id="70-道-numpy-面试题">70 道 NumPy 面试题</h1>

<h2 id="1-将-numpy-导入为-np并查看版本">1. 将 NumPy 导入为 np，并查看版本</h2>

<p>问题：将 NumPy 导入为 np，并输出版本号。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">np</span><span class="p">.</span><span class="n">__version__</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214184453067.png" alt="image-20250214184453067" style="zoom:50%;" /></p>

<h2 id="2如何创建-1-维数组">2.如何创建 1 维数组？</h2>

<p>问题：创建数字从 0 到 9 的 1 维数组。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214184612480.png" alt="image-20250214184612480" style="zoom:50%;" /></p>

<h2 id="3如何创建-boolean-数组">3.如何创建 boolean 数组？</h2>

<p>问题：创建所有 True 的 \(3×3\) NumPy 数组。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">full</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">n</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214184751712.png" alt="image-20250214184751712" style="zoom:50%;" /></p>

<h2 id="4-如何从-1-维数组中提取满足给定条件的项">4. 如何从 1 维数组中提取满足给定条件的项？</h2>

<p>问题：从 arr 中提取所有奇数。</p>

<p>输入：</p>

<blockquote>
  <p>arr = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])`</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([1, 3, 5, 7, 9])</p>
</blockquote>

<p>方法1:<code class="language-plaintext highlighter-rouge">np.where</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214184920764.png" alt="image-20250214184920764" style="zoom:50%;" /></p>

<p>方法2:使用布尔索引</p>

<blockquote>
  <p>注：<strong>布尔索引</strong> 是最常用且效率最高的方法。它利用 NumPy 数组的广播特性，直接通过条件选择满足条件的元素</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n</span><span class="p">[</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214185109401.png" alt="image-20250214185109401" style="zoom:50%;" /></p>

<p>当然也可以用<code class="language-plaintext highlighter-rouge">np.mod()</code> 方法:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">oddNum</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">mod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">oddNum</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214185601819.png" alt="image-20250214185601819" style="zoom:50%;" /></p>

<p>方法3:条件语句和循环（不推荐）</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">odd_num</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 列表是可变的数据类型
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">n</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">odd_num</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">odd_num</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214185252397.png" alt="image-20250214185252397" style="zoom:50%;" /></p>

<p>方法4：<code class="language-plaintext highlighter-rouge">filter()</code> 函数与 lambda 表达式</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">odd</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="n">odd</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214185436309.png" alt="image-20250214185436309" style="zoom:50%;" /></p>

<h2 id="5-如何将-numpy-数组中满足给定条件的项替换成另一个数值">5. 如何将 NumPy 数组中满足给定条件的项替换成另一个数值？</h2>

<p>问题：将 arr 中的所有奇数替换成 -1。</p>

<p>输入：</p>

<blockquote>
  <p>arr = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([ 0, -1, 2, -1, 4, -1, 6, -1, 8, -1])</p>
</blockquote>

<p>和第四题思想类似，只是多了一步赋值。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n</span><span class="p">[</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">n</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250214185816158.png" alt="image-20250214185816158" style="zoom:50%;" /></p>

<h2 id="6如何在不影响原始数组的前提下替换满足给定条件的项">6.如何在不影响原始数组的前提下替换满足给定条件的项？</h2>

<p>问题：将 arr 中所有奇数替换成 -1，且不改变 arr。</p>

<p>输入：</p>

<blockquote>
  <p>arr = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>out
#&gt; array([ 0, -1, 2, -1, 4, -1, 6, -1, 8, -1])
arr
#&gt; array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</p>
</blockquote>

<p>方法1:使用<code class="language-plaintext highlighter-rouge">copy()</code>函数</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
<span class="n">n1</span><span class="p">[</span><span class="n">n1</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215140129820.png" alt="image-20250215140129820" style="zoom:50%;" /></p>

<p>方法2:<code class="language-plaintext highlighter-rouge">np.where()</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215140347723.png" alt="image-20250215140347723" style="zoom:50%;" /></p>

<p>方法3:<code class="language-plaintext highlighter-rouge">np.vectorize</code> 是一种高效的方式来对数组元素进行逐个操作，实际上它是对每个元素应用一个函数。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">replace_minus_1_if_odd</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span>

<span class="n">vectorized_replace_minus_1_if_odd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">vectorize</span><span class="p">(</span><span class="n">replace_minus_1_if_odd</span><span class="p">)</span>

<span class="n">out_arr</span> <span class="o">=</span> <span class="nf">vectorized_replace_minus_1_if_odd</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">out_arr</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215140638008.png" alt="image-20250215140638008" style="zoom:50%;" /></p>

<h2 id="7-如何重塑reshape数组"><strong>7. 如何重塑（reshape）数组？</strong></h2>

<p>问题：将 1 维数组转换成 2 维数组（两行）。</p>

<p>输入：</p>

<blockquote>
  <p>np.arange(10)
#&gt; array([ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</p>
</blockquote>

<p>期望输出</p>

<blockquote>
  <p>#&gt; array([[0, 1, 2, 3, 4],
#&gt; [5, 6, 7, 8, 9]])</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215140818729.png" alt="image-20250215140818729" style="zoom:50%;" /></p>

<h2 id="8-如何垂直堆叠两个数组"><strong>8. 如何垂直堆叠两个数组？</strong></h2>

<p>问题：垂直堆叠数组 a 和 b。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.arange(10).reshape(2,-1)
b = np.repeat(1, 10).reshape(2,-1)</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([[0, 1, 2, 3, 4],
#&gt; [5, 6, 7, 8, 9],
#&gt; [1, 1, 1, 1, 1],
#&gt; [1, 1, 1, 1, 1]])</p>
</blockquote>

<blockquote>
  <p>注：本题不适合用<code class="language-plaintext highlighter-rouge">np.stack</code>，<code class="language-plaintext highlighter-rouge">np.stack</code> 主要是用于堆叠数组在新的轴上（【增加维度】），但也可以通过指定 <code class="language-plaintext highlighter-rouge">axis=0</code> 来实现垂直堆叠。这个方法与 <code class="language-plaintext highlighter-rouge">np.concatenate</code> 类似，但会返回一个新的维度。（会导致返回的是3维）</p>
</blockquote>

<p>方法一：使用<code class="language-plaintext highlighter-rouge">np.concatenate</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span> <span class="c1"># 默认axis就是0
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141052743.png" alt="image-20250215141052743" style="zoom:50%;" /></p>

<p>方法2:<code class="language-plaintext highlighter-rouge">np.vstack</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="nf">vstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141218412.png" alt="image-20250215141218412" style="zoom:50%;" /></p>

<p>方法3:<code class="language-plaintext highlighter-rouge">np.row_stack</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">row_stack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141313663.png" alt="image-20250215141313663" style="zoom:50%;" /></p>

<p>方法4:<code class="language-plaintext highlighter-rouge">np.append</code> 也可以用于堆叠数组，不过它通常用于将一个数组的元素添加到另一个数组的末尾。要垂直堆叠，必须设置 <code class="language-plaintext highlighter-rouge">axis=0</code>。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141403566.png" alt="image-20250215141403566" style="zoom:50%;" /></p>

<p>方法5:<code class="language-plaintext highlighter-rouge">np.insert</code> 允许你将一个数组插入到另一个数组的指定位置。我们可以利用它将 <code class="language-plaintext highlighter-rouge">b</code> 插入到 <code class="language-plaintext highlighter-rouge">a</code> 的末尾，达到垂直堆叠的效果。</p>

<blockquote>
  <p>注：<code class="language-plaintext highlighter-rouge">a.shape[0]</code> 是 <code class="language-plaintext highlighter-rouge">a</code> 的行数，表示插入到 <code class="language-plaintext highlighter-rouge">a</code> 的最后。</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141515671.png" alt="image-20250215141515671" style="zoom:50%;" /></p>

<h2 id="9-如何水平堆叠两个数组"><strong>9. 如何水平堆叠两个数组？</strong></h2>

<p>问题：水平堆叠数组 a 和 b。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.arange(10).reshape(2,-1)
b = np.repeat(1, 10).reshape(2,-1)</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([[0, 1, 2, 3, 4, 1, 1, 1, 1, 1],
#&gt; [5, 6, 7, 8, 9, 1, 1, 1, 1, 1]])</p>
</blockquote>

<p>本题和上一题类似：</p>

<p>方法1:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141804415.png" alt="image-20250215141804415" style="zoom:50%;" /></p>

<p>方法2:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">hstack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141812344.png" alt="image-20250215141812344" style="zoom:50%;" /></p>

<p>方法3:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">column_stack</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141909832.png" alt="image-20250215141909832" style="zoom:50%;" /></p>

<p>方法4:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215141919235.png" alt="image-20250215141919235" style="zoom:50%;" /></p>

<blockquote>
  <p>本题insert无法完成需求。</p>
</blockquote>

<h2 id="10-在不使用硬编码的前提下如何在-numpy-中生成自定义序列"><strong>10. 在不使用硬编码的前提下，如何在 NumPy 中生成自定义序列？</strong></h2>

<p>问题：在不使用硬编码的前提下创建以下模式。仅使用 NumPy 函数和以下输入数组 a。</p>

<p>输入</p>

<blockquote>
  <p>a = np.array([1,2,3])`</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3])</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">tile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># 重复三行
</span><span class="nf">display</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="nf">flatten</span><span class="p">(),</span><span class="n">b</span><span class="p">.</span><span class="nf">flatten</span><span class="p">())</span>
<span class="n">out</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215150901060.png" alt="image-20250215150901060" style="zoom:50%;" /></p>

<h2 id="11-如何获得两个-python-numpy-数组中共同的项"><strong>11. 如何获得两个 Python NumPy 数组中共同的项？</strong></h2>

<p>问题：获取数组 a 和 b 中的共同项。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.array([1,2,3,2,3,4,3,4,5,6])
b = np.array([7,2,10,2,7,4,9,4,9,8])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>array([2, 4])</p>
</blockquote>

<p>方法1:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">np</span><span class="p">.</span><span class="nf">intersect1d</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215151320675.png" alt="image-20250215151320675" style="zoom:50%;" /></p>

<p>方法2:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="nf">set</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nf">set</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215151443003.png" alt="image-20250215151443003" style="zoom:50%;" /></p>

<p>方法3:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">isin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)])</span>   <span class="c1"># np.unique去重
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250215151600610.png" alt="image-20250215151600610" style="zoom:50%;" /></p>

<blockquote>
  <p>注：<code class="language-plaintext highlighter-rouge">a[np.isin(a, b)]</code>返回的是<code class="language-plaintext highlighter-rouge">array([2, 2, 4, 4])</code></p>
</blockquote>

<h2 id="12-如何从一个数组中移除与另一个数组重复的项"><strong>12. 如何从一个数组中移除与另一个数组重复的项？</strong></h2>

<p>问题：从数组 a 中移除出现在数组 b 中的所有项。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.array([1,2,3,4,5])
b = np.array([5,6,7,8,9])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>array([1,2,3,4])</p>
</blockquote>

<p>方法1:使用 <code class="language-plaintext highlighter-rouge">np.isin()</code> 函数和布尔索引</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="p">.</span><span class="nf">isin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span>
<span class="n">out</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250216172202992.png" alt="image-20250216172202992" style="zoom:50%;" /></p>

<p>方法2:<code class="language-plaintext highlighter-rouge">numpy.setdiff1d()</code> 返回 <code class="language-plaintext highlighter-rouge">a</code> 中存在但不在 <code class="language-plaintext highlighter-rouge">b</code> 中的元素，这个方法也是专门为这种差集操作设计的。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">setdiff1d</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250216172223281.png" alt="image-20250216172223281" style="zoom:50%;" /></p>

<p>方法3:使用纯 Python，也可以通过列表推导式来实现：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">out_res</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">b</span><span class="p">])</span>
<span class="n">out_res</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250216172338756.png" alt="image-20250216172338756" style="zoom:50%;" /></p>

<h2 id="13-如何获取两个数组匹配元素的位置"><strong>13. 如何获取两个数组匹配元素的位置？</strong></h2>

<p>问题：获取数组 a 和 b 中匹配元素的位置。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.array([1,2,3,2,3,4,3,4,5,6])
b = np.array([7,2,10,2,7,4,9,4,9,8])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; (array([1, 3, 5, 7]),)</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">isin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217140429658.png" alt="image-20250217140429658" style="zoom:50%;" /></p>

<h2 id="14如何从-numpy-数组中提取给定范围内的所有数字"><strong>14.如何从 NumPy 数组中提取给定范围内的所有数字？</strong></h2>

<p>问题：从数组 a 中提取 5 和 10 之间的所有项。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.arange(15)</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>(array([ 5, 6, 7, 8, 9, 10]),)</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">((</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217140818753.png" alt="image-20250217140818753" style="zoom:50%;" /></p>

<h2 id="15如何创建一个-python-函数以对-numpy-数组执行元素级的操作"><strong>15.如何创建一个 Python 函数以对 NumPy 数组执行元素级的操作？</strong></h2>

<p>问题：转换函数 maxx，使其从只能对比标量而变为对比两个数组。</p>

<p>输入：</p>

<blockquote>
  <p>def maxx(x, y):
“"”Get the maximum of two items”””
if x &gt;= y:
return x
else:
return y</p>

  <p>maxx(1, 5)
#&gt; 5</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>a = np.array([5, 7, 9, 8, 6, 4, 5])
b = np.array([6, 3, 4, 8, 9, 7, 1])
pair_max(a, b)
#&gt; array([ 6., 7., 9., 8., 9., 7., 5.])</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">maxx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Get the maximum of two items</span><span class="sh">"""</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span>
    
<span class="n">pair_max</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">vectorize</span><span class="p">(</span><span class="n">maxx</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="nf">pair_max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217141034996.png" alt="image-20250217141034996" style="zoom:50%;" /></p>

<h2 id="16如何在-2d-numpy-数组中交换两个列"><strong>16.如何在 2d NumPy 数组中交换两个列？</strong></h2>

<p>问题：在数组 arr 中交换列 1 和列 2。</p>

<blockquote>
  <p>arr = np.arange(9).reshape(3,3)
arr</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">arr</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217141357596.png" alt="image-20250217141357596" style="zoom:50%;" /></p>

<blockquote>
  <p>注：<code class="language-plaintext highlighter-rouge">arr[:, [0, 1]]</code> 表示选择所有行的第一列和第二列。</p>

  <p><code class="language-plaintext highlighter-rouge">arr[:, [1, 0]]</code> 表示选择所有行的第二列和第一列。</p>
</blockquote>

<h2 id="17如何在-2d-numpy-数组中交换两个行"><strong>17.如何在 2d NumPy 数组中交换两个行？</strong></h2>

<p>问题：在数组 arr 中交换行 1 和行 2。</p>

<blockquote>
  <p>arr = np.arange(9).reshape(3,3)
arr</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="nf">display</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217141729865.png" alt="image-20250217141729865" style="zoom:50%;" /></p>

<h2 id="18如何反转-2d-数组的所有行"><strong>18.如何反转 2D 数组的所有行？</strong></h2>

<p>问题：反转 2D 数组 arr 中的所有行。</p>

<blockquote>
  <p># Input
arr = np.arange(9).reshape(3,3)</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217141958928.png" alt="image-20250217141958928" style="zoom:50%;" /></p>

<h2 id="19如何反转-2d-数组的所有列"><strong>19.如何反转 2D 数组的所有列？</strong></h2>

<p>问题：反转 2D 数组 arr 中的所有列。</p>

<blockquote>
  <p># Input
arr = np.arange(9).reshape(3,3)</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">arr</span><span class="p">[::,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217142054903.png" alt="image-20250217142054903" style="zoom:50%;" /></p>

<h2 id="20如何创建一个包含-5-和-10-之间随机浮点的-2-维数组"><strong>20.如何创建一个包含 5 和 10 之间随机浮点的 2 维数组？</strong></h2>

<p>问题：创建一个形态为 5×3 的 2 维数组，包含 5 和 10 之间的随机十进制小数。</p>

<p>方法1:<code class="language-plaintext highlighter-rouge">np.random.uniform(low, high, size)</code> 可以生成在 <code class="language-plaintext highlighter-rouge">low</code> 和 <code class="language-plaintext highlighter-rouge">high</code> 之间均匀分布的随机小数。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># 创建一个形态为 5×3 的 2 维数组，包含 5 和 10 之间的随机十进制小数。
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217142404128.png" alt="image-20250217142404128" style="zoom:50%;" /></p>

<p>方法2:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="mi">5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">或者</span>
<span class="mi">5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217142506326.png" alt="image-20250217142506326" style="zoom:50%;" /></p>

<h2 id="21如何在-python-numpy-数组中仅输出小数点后三位的数字"><strong>21.如何在 Python NumPy 数组中仅输出小数点后三位的数字？</strong></h2>

<p>问题：输出或显示 NumPy 数组 <code class="language-plaintext highlighter-rouge">rand_arr </code>中小数点后三位的数字。</p>

<p>输入：</p>

<blockquote>
  <p>rand_arr = np.random.random((5,3))</p>
</blockquote>

<p>注：<code class="language-plaintext highlighter-rouge">np.round</code>不合适，因为会四舍五入。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">rand_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nf">display</span><span class="p">(</span><span class="n">rand_arr</span><span class="p">)</span>

<span class="c1"># 使用列表推导和字符串格式化来控制小数点后三位
</span><span class="n">formatted_arr</span> <span class="o">=</span> <span class="p">[[</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="p">.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rand_arr</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">formatted_arr</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250217160900044.png" alt="image-20250217160900044" style="zoom:50%;" /></p>

<h2 id="22如何通过禁用科学计数法如-1e10打印-numpy-数组"><strong>22.如何通过禁用科学计数法（如 1e10）打印 NumPy 数组？</strong></h2>

<p>问题：通过禁用科学计数法（如 1e10）打印 NumPy 数组 <code class="language-plaintext highlighter-rouge">rand_arr</code>。</p>

<p>输入：</p>

<blockquote>
  <p># Create the random array
np.random.seed(100)
rand_arr = np.random.random([3,3])/1e3
rand_arr</p>

  <p>#&gt; array([[ 5.434049e-04, 2.783694e-04, 4.245176e-04],
#&gt; [ 8.447761e-04, 4.718856e-06, 1.215691e-04],
#&gt; [ 6.707491e-04, 8.258528e-04, 1.367066e-04]])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([[ 0.000543, 0.000278, 0.000425],
#&gt; [ 0.000845, 0.000005, 0.000122],
#&gt; [ 0.000671, 0.000826, 0.000137]])</p>
</blockquote>

<blockquote>
  <p>补充：NumPy有一个<code class="language-plaintext highlighter-rouge">set_printoptions</code>函数，可以用来设置打印选项。这个函数可以控制浮点数的显示格式。比如，可以通过设置suppress参数为True，来禁用科学记数法。或者，也可以设置precision参数来指定小数点后的位数。</p>

  <p>需要在打印数组之前，调用这个<code class="language-plaintext highlighter-rouge">set_printoptions</code>函数。比如，先设置打印选项，然后打印数组。或者，直接在打印的时候，使用格式化字符串来控制显示方式。</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">rand_arr</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219102148186.png" alt="image-20250219102148186" style="zoom:50%;" /></p>

<blockquote>
  <p>注，如果要指定小数点后的位数，可以<code class="language-plaintext highlighter-rouge">np.set_printoptions(suppress=True, precision=6)</code></p>
</blockquote>

<h2 id="23-如何限制-numpy-数组输出中项的数目"><strong>23. 如何限制 NumPy 数组输出中项的数目？</strong></h2>

<p>问题：将 Python NumPy 数组 a 输出的项的数目限制在最多 6 个元素（输出是只显示前6个和最后6个元素，中间用省略号表示）。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.arange(15)
#&gt; array([ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([ 0, 1, 2, …, 12, 13, 14])</p>
</blockquote>

<blockquote>
  <p>另外补充：（与本题无关）NumPy提供了一个函数<code class="language-plaintext highlighter-rouge">np.set_printoptions</code>，可以用来设置数组打印时的各种选项，比如抑制科学计数法、设置精度(参考上一题)等。其中，有一个参数叫做’linewidth’，可以控制每行显示的字符数，但这可能不是直接解决元素数量的问题。</p>

  <p>补充：另一个参数’edgeitems’，这个参数控制在打印数组时，显示的最前面和最后面的元素数目。默认情况下，edgeitems的值是3，所以会显示前面3个和后面3个元素，中间用省略号连接。如果我将edgeitems设置为6，那么应该可以显示前面6个和后面6个元素，中间用省略号表示。</p>

  <p>但是我设置了<code class="language-plaintext highlighter-rouge">edgeitems</code>，却没有生效。通过打印<code class="language-plaintext highlighter-rouge">np.get_printoptions()</code>，内容如下，发现问题：</p>

  <p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219103524665.png" alt="image-20250219103524665" style="zoom:50%;" /></p>

  <p><code class="language-plaintext highlighter-rouge">edgeitems</code> 控制的是数组两端显示的元素数，通常是在数组元素数目超过 <code class="language-plaintext highlighter-rouge">threshold</code> 时才会生效。当数组的元素总数小于等于 <code class="language-plaintext highlighter-rouge">threshold</code> 时，<code class="language-plaintext highlighter-rouge">edgeitems</code> 设置不起作用。也就是说，<code class="language-plaintext highlighter-rouge">edgeitems</code> 只有在数组超过 <code class="language-plaintext highlighter-rouge">threshold</code> 元素时才会起作用。</p>

  <p>所以，这道题最终应该这么解决：</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">set_printoptions</span><span class="p">(</span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">edgeitems</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">a</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219103641437.png" alt="image-20250219103641437" style="zoom:50%;" /></p>

<h2 id="24-如何在不截断数组的前提下打印出完整的-numpy-数组"><strong>24. 如何在不截断数组的前提下打印出完整的 NumPy 数组？</strong></h2>

<p>问题：在不截断数组的前提下打印出完整的 NumPy 数组 a。</p>

<p>输入：</p>

<blockquote>
  <p>np.set_printoptions(threshold=6)
a = np.arange(15)
a
#&gt; array([ 0, 1, 2, …, 12, 13, 14])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>a
#&gt; array([ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14])</p>
</blockquote>

<p>要打印出完整的 NumPy 数组，同时不截断其中的元素，最简单的办法是将 <code class="language-plaintext highlighter-rouge">threshold</code> 设置为一个非常大的值(例如1000)，确保 NumPy 在打印数组时不会对元素进行省略。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">)</span>
<span class="n">a</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219103833631.png" alt="image-20250219103833631" style="zoom:50%;" /></p>

<h2 id="25如何向-python-numpy-导入包含数字和文本的数据集同时保持文本不变">25.如何向 Python NumPy 导入包含数字和文本的数据集，同时保持文本不变？</h2>

<p>问题：导入 iris 数据集，保持文本不变。</p>

<hr />

<p>要导入 <code class="language-plaintext highlighter-rouge">iris</code> 数据集，并保持文本不变，你可以使用 <code class="language-plaintext highlighter-rouge">sklearn.datasets</code> 中的 <code class="language-plaintext highlighter-rouge">load_iris</code> 方法来加载数据集。<code class="language-plaintext highlighter-rouge">load_iris()</code> 会返回一个包含 <code class="language-plaintext highlighter-rouge">iris</code> 数据集的字典对象，其中包括特征数据、目标值以及数据集的描述信息。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>

<span class="c1"># 加载 Iris 数据集
</span><span class="n">iris</span> <span class="o">=</span> <span class="nf">load_iris</span><span class="p">()</span>

<span class="c1"># 打印文本描述保持不变
</span><span class="nf">print</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="sh">'</span><span class="s">DESCR</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219104037437.png" alt="image-20250219104037437" style="zoom:50%;" /></p>

<p>数据集内容：</p>

<ul>
  <li>该数据集包含 150 条记录，每条记录有 4 个特征（花萼长度、花萼宽度、花瓣长度、花瓣宽度）。</li>
  <li>目标变量有 3 个类别：<code class="language-plaintext highlighter-rouge">setosa</code>、<code class="language-plaintext highlighter-rouge">versicolor</code> 和 <code class="language-plaintext highlighter-rouge">virginica</code>，对应的数字标签分别是 0、1 和 2。</li>
</ul>

<h2 id="26如何从-1-维元组数组中提取特定的列">26.如何从 1 维元组数组中提取特定的列？</h2>

<p>问题：从前一个问题导入的 1 维 iris 中提取文本列 species。</p>

<p>输入：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>url = https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data
iris_1d = np.genfromtxt(url, delimiter= , , dtype=None)
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>首先注意<code class="language-plaintext highlighter-rouge">iris_1d</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_1d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">iris_1d</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219104412433.png" alt="image-20250219104412433" style="zoom:50%;" /></p>

<p>文本列就是最后一列，所以：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_1d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">iris_1d</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219104605970.png" alt="image-20250219104605970" style="zoom:50%;" /></p>

<p><code class="language-plaintext highlighter-rouge">usecols=[4]</code>：指定提取数据集中的第 5 列（索引从 0 开始，第四列的索引为 4），即 <code class="language-plaintext highlighter-rouge">species</code> 列。</p>

<p><code class="language-plaintext highlighter-rouge">dtype=None</code>：让 <code class="language-plaintext highlighter-rouge">numpy</code> 自动推断每列的类型，特别是最后一列 <code class="language-plaintext highlighter-rouge">species</code>，它应该被正确识别为字符串。</p>

<h2 id="27-如何将-1-维元组数组转换成-2-维-numpy-数组"><strong>27. 如何将 1 维元组数组转换成 2 维 NumPy 数组？</strong></h2>

<p>问题：忽略 species 文本字段，将 1 维 iris 转换成 2 维数组<code class="language-plaintext highlighter-rouge"> iris_2d</code>。</p>

<p>输入：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>url = "https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data"
iris_1d = np.genfromtxt(url, delimiter= , , dtype=None)
</pre></td></tr></tbody></table></code></pre></div></div>

<p>参考：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1"># 使用 np.loadtxt 导入 iris 数据集，确保按列解析
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">loadtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>

<span class="n">iris_2d</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219105245766.png" alt="image-20250219105245766" style="zoom:50%;" /></p>

<p>但是有第5列。</p>

<p>所以：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1"># 使用 np.loadtxt 导入 iris 数据集，确保按列解析
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">loadtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

<span class="n">iris_2d</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219105332322.png" alt="image-20250219105332322" style="zoom:50%;" /></p>

<h2 id="28如何计算-numpy-数组的平均值中位数和标准差">28.如何计算 NumPy 数组的平均值、中位数和标准差？</h2>

<p>问题：找出 iris sepallength（第一列）的平均值、中位数和标准差。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">col1</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 第一列
</span><span class="n">col1</span> <span class="o">=</span> <span class="n">col1</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># 转换成浮点数
# 找出 iris sepallength（第一列）的平均值、中位数和标准差。
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">均值：</span><span class="sh">"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">col1</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">中位数：</span><span class="sh">"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">median</span><span class="p">(</span><span class="n">col1</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">标准差：</span><span class="sh">"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">std</span><span class="p">(</span><span class="n">col1</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219105736546.png" alt="image-20250219105736546" style="zoom:50%;" /></p>

<h2 id="29如何归一化数组使值的范围在-0-和-1-之间"><strong>29.如何归一化数组，使值的范围在 0 和 1 之间？</strong></h2>

<p>问题：创建 iris sepallength 的归一化格式，使其值在 0 到 1 之间。</p>

<hr />

<p>要将 <code class="language-plaintext highlighter-rouge">iris</code> 数据集中的 <code class="language-plaintext highlighter-rouge">sepal length</code> 列（即第一列）归一化到 0 到 1 的范围，可以使用 <strong>最小-最大归一化</strong> 方法。这个方法的公式为：\(Normalized \ Value = \frac{X-min(X)}{max(X)-min(X)}\)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">iris_sepallength</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">min_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">min</span><span class="p">(</span><span class="n">iris_sepallength</span><span class="p">)</span>
<span class="n">max_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">iris_sepallength</span><span class="p">)</span>
<span class="p">(</span><span class="n">iris_sepallength</span> <span class="o">-</span> <span class="n">min_</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_</span> <span class="o">-</span> <span class="n">min_</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219110154167.png" alt="image-20250219110154167" style="zoom:50%;" /></p>

<h2 id="30如何计算-softmax-分数"><strong>30.如何计算 softmax 分数？</strong></h2>

<p>问题：计算 sepallength 的 softmax 分数。</p>

<hr />

<p>补充：Softmax 是一种常用于分类任务的激活函数，通常用于将一个向量转换为一个概率分布，输出的值都在<code class="language-plaintext highlighter-rouge"> [0, 1] </code>之间，并且总和为 1。Softmax 的计算公式如下：\(Softmax(x_i) = \frac{e^{x_i}}{\sum_j e^{x_j}}\)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1"># 数值防止溢出
</span>    <span class="k">return</span> <span class="n">exp</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="n">iris_sepallength</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nf">softmax</span><span class="p">(</span><span class="n">iris_sepallength</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219110631215.png" alt="image-20250219110631215" style="zoom:50%;" /></p>

<p><code class="language-plaintext highlighter-rouge">np.exp(x - np.max(x))</code>：为了防止计算中的数值溢出（即计算指数时可能遇到极大的值），我们通常减去 <code class="language-plaintext highlighter-rouge">x</code> 中的最大值。这是常见的数值稳定性技巧，它不会改变 softmax 输出的结果。</p>

<h2 id="31如何找到-numpy-数组的百分数"><strong>31.如何找到 NumPy 数组的百分数？</strong></h2>

<p>问题：找出 iris sepallength（第一列）的第 5 个和第 95 个百分数。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">percentile</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="nf">percentile</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="mf">0.95</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219124531145.png" alt="image-20250219124531145" style="zoom:50%;" /></p>

<h2 id="32如何在数组的随机位置插入值"><strong>32.如何在数组的随机位置插入值？</strong></h2>

<p>问题：在 <code class="language-plaintext highlighter-rouge">iris_2d</code> 数据集中的 20 个随机位置插入<code class="language-plaintext highlighter-rouge"> np.nan </code>值。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1"># 确定我们要插入 NaN 的位置：随机选择 20 个位置
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 设置随机种子，确保结果可重复
</span><span class="n">random_indices</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># 将这些位置的元素设置为 np.nan
</span><span class="n">iris_2d_flat</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()</span>  <span class="c1"># 将二维数组展平成一维数组
</span><span class="n">iris_2d_flat</span><span class="p">[</span><span class="n">random_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>  <span class="c1"># 设置为 'nan' 字符串，因为数据是字符串类型
</span>
<span class="c1"># 将一维数组重新转回二维数组
</span><span class="n">iris_2d</span> <span class="o">=</span> <span class="n">iris_2d_flat</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">iris_2d</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219124825559.png" alt="image-20250219124825559" style="zoom:50%;" /></p>

<h2 id="33如何在-numpy-数组中找出缺失值的位置"><strong>33.如何在 NumPy 数组中找出缺失值的位置？</strong></h2>

<p>问题：在<code class="language-plaintext highlighter-rouge"> iris_2d </code>的 sepallength（第一列）中找出缺失值的数目和位置。</p>

<hr />

<p>查找 sepallength（第一列）中的缺失值（’nan’）:(布尔索引)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">sepal_length</span> <span class="o">=</span> <span class="p">(</span><span class="n">iris_2d</span><span class="o">==</span><span class="sh">'</span><span class="s">nan</span><span class="sh">'</span><span class="p">)</span>
<span class="n">sepal_length</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219125423191.png" alt="image-20250219125423191" style="zoom:50%;" /></p>

<p>然后统计总数：（因为<code class="language-plaintext highlighter-rouge">True=1,False=0</code>）</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219140942542.png" alt="image-20250219140942542" style="zoom:50%;" /></p>

<p>最后要得到nan的位置：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">sepal_length</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">index</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219141943919.png" alt="image-20250219141943919" style="zoom:50%;" /></p>

<h2 id="34如何基于两个或以上条件过滤-numpy-数组"><strong>34.如何基于两个或以上条件过滤 NumPy 数组？</strong></h2>

<p>问题：过滤<code class="language-plaintext highlighter-rouge"> iris_2d </code>中满足 petallength（第三列）&gt; 1.5 和 sepallength（第一列）&lt; 5.0 的行。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">iris_2d</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">iris_2d</span><span class="p">[(</span><span class="n">iris_2d</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">iris_2d</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">5.0</span><span class="p">)]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219142359521.png" alt="image-20250219142359521" style="zoom:50%;" /></p>

<h2 id="35如何在-numpy-数组中删除包含缺失值的行"><strong>35.如何在 NumPy 数组中删除包含缺失值的行？</strong></h2>

<p>问题：选择 <code class="language-plaintext highlighter-rouge">iris_2d </code>中不包含 nan 值的行。</p>

<hr />

<p>首先注意：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">isnan</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>会返回一个布尔数组：</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219142801022.png" alt="image-20250219142801022" style="zoom:50%;" /></p>

<p>和刚在的逻辑相同：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">bool_arr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219142925160.png" alt="image-20250219142925160" style="zoom:50%;" /></p>

<p>那么这道题，需要对布尔数组取反。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">notNan_arr</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">isnan</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">))</span>
<span class="n">notNan_arr</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219143329891.png" alt="image-20250219143329891" style="zoom:50%;" /></p>

<p>所以：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">iris_2d</span><span class="p">[</span><span class="n">notNan_arr</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219143408763.png" alt="image-20250219143408763" style="zoom:50%;" /></p>

<h2 id="36如何找出-numpy-数组中两列之间的关联性"><strong>36.如何找出 NumPy 数组中两列之间的关联性？</strong></h2>

<p>问题：找出 <code class="language-plaintext highlighter-rouge">iris_2d </code>中 SepalLength（第一列）和 PetalLength（第三列）之间的关联性。</p>

<hr />

<p>可以通过计算这两列之间的 <strong>相关系数</strong> 来衡量它们的关系。常用的相关系数是 <strong>Pearson 相关系数</strong>，它衡量了两者之间的线性关系。</p>

<p><strong>Pearson 相关系数</strong>：值的范围是 -1 到 1，表示两个变量之间的线性关系。</p>

<ul>
  <li>1 表示完全正相关</li>
  <li>-1 表示完全负相关</li>
  <li>0 表示没有线性相关性</li>
</ul>

<p>使用 <code class="language-plaintext highlighter-rouge">np.corrcoef</code> 来计算两列之间的 Pearson 相关系数。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1"># 提取SepalLength（第一列）和 PetalLength（第三列）
</span><span class="n">sepalLength</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">petalLength</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">corrcoef</span><span class="p">(</span><span class="n">sepalLength</span><span class="p">,</span> <span class="n">petalLength</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">相关系数是：</span><span class="sh">"</span><span class="p">,</span> <span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219143848098.png" alt="image-20250219143848098" style="zoom:50%;" /></p>

<p>有非常强的正线性关系。</p>

<h2 id="37如何确定给定数组是否有空值"><strong>37.如何确定给定数组是否有空值？</strong></h2>

<p>问题：确定<code class="language-plaintext highlighter-rouge"> iris_2d </code>是否有缺失值。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">isnan</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">).</span><span class="nf">any</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219144103518.png" alt="image-20250219144103518" style="zoom:50%;" /></p>

<p>只要有一个True(即有一个<code class="language-plaintext highlighter-rouge">np.nan</code>)就会返回True.(这就是<code class="language-plaintext highlighter-rouge">any()</code>的意义)</p>

<h2 id="38如何在-numpy-数组中将所有缺失值替换成-0"><strong>38.如何在 NumPy 数组中将所有缺失值替换成 0？</strong></h2>

<p>问题：在 NumPy 数组中将所有 nan 替换成 0。</p>

<hr />

<p>首先做一份<code class="language-plaintext highlighter-rouge">iris_2d</code>的拷贝</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># 做一份拷贝，防止后续还要用到iris_2d
</span><span class="n">iris_2d_copy</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219144359208.png" alt="image-20250219144359208" style="zoom:50%;" /></p>

<p>然后将<code class="language-plaintext highlighter-rouge">nan</code>变成0(赋值运算)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">iris_2d</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">isnan</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219144502186.png" alt="image-20250219144502186" style="zoom:50%;" /></p>

<h2 id="39如何在-numpy-数组中找出唯一值的数量"><strong>39.如何在 NumPy 数组中找出唯一值的数量？</strong></h2>

<p>问题：在 iris 的 species 列中找出唯一值及其数量。</p>

<hr />

<p>补充：在 <code class="language-plaintext highlighter-rouge">iris</code> 数据集中，<strong><code class="language-plaintext highlighter-rouge">species</code></strong> 列通常是数据集的 <strong>最后一列</strong>，它包含了每个样本的类别标签（即 <code class="language-plaintext highlighter-rouge">Iris-setosa</code>、<code class="language-plaintext highlighter-rouge">Iris-versicolor</code>、<code class="language-plaintext highlighter-rouge">Iris-virginica</code>）。</p>

<p>此时因为一开始导入的时候没有导入最后一列，所以重新加载数据。(导入的是二维数组)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c1"># 使用 np.loadtxt 导入 iris 数据集，确保按列解析
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">loadtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>
<span class="n">iris</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">np.unique()</code> 函数，它会返回唯一值和它们出现的次数。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">iris</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219144943345.png" alt="image-20250219144943345" style="zoom:50%;" /></p>

<p>但是想要统计数量(每个唯一值的出现次数)，就要加上参数<code class="language-plaintext highlighter-rouge">return_counts=True</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">iris</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219145151471.png" alt="image-20250219145151471" style="zoom:50%;" /></p>

<h2 id="40如何将一个数值转换为一个类别文本数组"><strong>40.如何将一个数值转换为一个类别（文本）数组？</strong></h2>

<p>问题：将 <code class="language-plaintext highlighter-rouge">iris_2d</code> 的 petallength（第三列）转换以构建一个文本数组，按如下规则进行转换：</p>

<ul>
  <li>Less than 3 –&gt; ‘small’</li>
  <li>3-5 –&gt; medium</li>
  <li>&gt;=5 –&gt; large</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre># Input
url = https%3A//archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data
iris = np.genfromtxt(url, delimiter= , , dtype= object )
names = ( sepallength , sepalwidth , petallength , petalwidth , species )
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>首先注意：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span> <span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219145523157.png" alt="image-20250219145523157" style="zoom:50%;" /></p>

<p>使用 <code class="language-plaintext highlighter-rouge">np.genfromtxt(url, delimiter=",", dtype=object)</code> 导入数据时，数据前面带有一个 <code class="language-plaintext highlighter-rouge">b</code> 的原因是：指定了 <code class="language-plaintext highlighter-rouge">dtype=object</code>，这会导致 NumPy 将所有的文本数据以字节串（<code class="language-plaintext highlighter-rouge">bytes</code>）的形式加载，而不是普通的字符串（<code class="language-plaintext highlighter-rouge">str</code>）。在 Python 中，字节串前面会有一个 <code class="language-plaintext highlighter-rouge">b</code> 前缀，表示该数据是字节类型（<code class="language-plaintext highlighter-rouge">bytes</code>），而不是标准的 Unicode 字符串（<code class="language-plaintext highlighter-rouge">str</code>）。</p>

<p>更加推荐<code class="language-plaintext highlighter-rouge">dtype='str'</code>的读取方法。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>
<span class="n">iris</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219145639452.png" alt="image-20250219145639452" style="zoom:50%;" /></p>

<p>iris数据集的格式就是</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">sepallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">sepalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">species</span><span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>现在需要对<code class="language-plaintext highlighter-rouge">PetalLength：花瓣的长度</code>进行处理。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">petal_length</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">petal_length</span><span class="p">)</span>
<span class="n">petal_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">(</span><span class="n">petal_length</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="sh">'</span><span class="s">U6</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># dtype='str'   这里因为是空的，默认分配一个字符的大小
</span><span class="n">petal_arr</span><span class="p">[</span><span class="n">petal_length</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">small</span><span class="sh">'</span>
<span class="n">petal_arr</span><span class="p">[(</span><span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">petal_length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">petal_length</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">medium</span><span class="sh">'</span>
<span class="n">petal_arr</span><span class="p">[</span><span class="n">petal_length</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">large</span><span class="sh">'</span>
<span class="n">petal_arr</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219150517328.png" alt="image-20250219150517328" style="zoom:50%;" /></p>

<h2 id="41如何基于-numpy-数组现有列创建一个新的列"><strong>41.如何基于 NumPy 数组现有列创建一个新的列？</strong></h2>

<p>问题：为 <code class="language-plaintext highlighter-rouge">iris_2d </code>中的 volume 列创建一个新的列，volume 指 <code class="language-plaintext highlighter-rouge">(pi x petallength x sepal_length^2)/3</code>。</p>

<hr />

<p>注：iris数据集的格式是</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">sepallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">sepalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">species</span><span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>解决代码：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="c1"># 获取iris_2d 
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 提取 petallength 和 sepal_length 这2列
</span><span class="n">petallength</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sepal_length</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># 计算 volume = pi x petallength x sepal_length^2)/3
</span><span class="n">volume</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">petallength</span> <span class="o">*</span> <span class="p">(</span><span class="n">sepal_length</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span>

<span class="c1"># 添加一列
</span><span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">column_stack</span><span class="p">((</span><span class="n">iris_2d</span><span class="p">,</span> <span class="n">volume</span><span class="p">))</span>

<span class="nf">display</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219160812239.png" alt="image-20250219160812239" style="zoom:50%;" /></p>

<h2 id="42如何在-numpy-中执行概率采样"><strong>42.如何在 NumPy 中执行概率采样？</strong></h2>

<p>问题：随机采样 iris 数据集中的 species 列，使得 setose 的数量是 versicolor 和 virginica 数量的两倍。</p>

<hr />

<p>思路是：</p>

<ol>
  <li><strong>提取 <code class="language-plaintext highlighter-rouge">species</code> 列</strong>：从 <code class="language-plaintext highlighter-rouge">iris_2d</code> 数据集提取 <code class="language-plaintext highlighter-rouge">species</code> 列。</li>
  <li><strong>分组数据</strong>：将 <code class="language-plaintext highlighter-rouge">species</code> 列按照每个类别（<code class="language-plaintext highlighter-rouge">setosa</code>, <code class="language-plaintext highlighter-rouge">versicolor</code>, <code class="language-plaintext highlighter-rouge">virginica</code>）分组。</li>
  <li><strong>控制采样数量</strong>：保证 <code class="language-plaintext highlighter-rouge">setosa</code> 的数量是 <code class="language-plaintext highlighter-rouge">versicolor</code> 和 <code class="language-plaintext highlighter-rouge">virginica</code> 的数量的两倍。具体来说，首先找到 <code class="language-plaintext highlighter-rouge">versicolor</code> 和 <code class="language-plaintext highlighter-rouge">virginica</code> 样本的数量，然后将 <code class="language-plaintext highlighter-rouge">setosa</code> 样本的数量调整为它们的两倍。</li>
  <li><strong>随机抽样</strong>：从 <code class="language-plaintext highlighter-rouge">setosa</code>、<code class="language-plaintext highlighter-rouge">versicolor</code> 和 <code class="language-plaintext highlighter-rouge">virginica</code> 中随机抽样，保证满足所需的数量关系。</li>
  <li><strong>合并样本</strong>：将采样后的样本合并为一个新的数据集。</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="c1"># 提取 species 列：从 iris_2d 数据集提取 species 列。
</span>
<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>
<span class="n">species</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># 分组数据：将 species 列按照每个类别（setosa, versicolor, virginica）分组。
</span><span class="n">versicolor_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">species</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Iris-versicolor</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">virginica_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">species</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Iris-virginica</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">setosa_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">species</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Iris-setosa</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">versicolor_index</span><span class="p">))</span> <span class="c1"># 50
</span><span class="nf">print</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">virginica_index</span><span class="p">))</span> <span class="c1"># 50
</span><span class="nf">print</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">setosa_index</span><span class="p">))</span> <span class="c1"># 50
# 控制采样数量：保证 setosa 的数量是 versicolor 和 virginica 的数量的两倍。具体来说，首先找到 versicolor 和 virginica 样本的数量，然后将 setosa 样本的数量调整为它们的两倍。
</span><span class="n">setosa_num</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">versicolor_index</span><span class="p">)</span><span class="o">+</span><span class="nf">len</span><span class="p">(</span><span class="n">virginica_index</span><span class="p">))</span>

<span class="c1"># 随机抽样：从 setosa、versicolor 和 virginica 中随机抽样，保证满足所需的数量关系。
</span><span class="n">setosa_sample</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">setosa_index</span><span class="p">,</span> <span class="n">setosa_num</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="bp">True</span> <span class="p">)</span> <span class="c1"># replace = True就是允许重复采样
</span><span class="n">versicolor_sample</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">versicolor_index</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">versicolor_index</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">virginica_sample</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">virginica_index</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">virginica_index</span><span class="p">),</span> <span class="n">replace</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="c1"># 合并样本：将采样后的样本合并为一个新的数据集。
</span><span class="n">index_all</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">([</span><span class="n">setosa_sample</span><span class="p">,</span> <span class="n">versicolor_sample</span><span class="p">,</span> <span class="n">virginica_sample</span><span class="p">])</span>
<span class="n">sample_all</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[</span><span class="n">index_all</span><span class="p">]</span>
<span class="nf">display</span><span class="p">(</span><span class="n">sample_all</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219162414887.png" alt="image-20250219162414887" style="zoom:50%;" /></p>

<h2 id="43如何在多维数组中找到一维的第二最大值"><strong>43.如何在多维数组中找到一维的第二最大值？</strong></h2>

<p>问题：在 species setosa 的 petallength 列中找到第二最大值。</p>

<hr />

<p>注：iris数据集的格式是</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">sepallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">sepalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">species</span><span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">numpy.sort()</code> 排序可以完成这个任务，但是<code class="language-plaintext highlighter-rouge">numpy.partition()</code>可能会更高效。</p>

<p>下面我分别写这两种方法并且统计哪个更快。</p>

<p>方法1:<code class="language-plaintext highlighter-rouge">numpy.sort()</code> 排序</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>
<span class="n">setosa_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Iris-setosa</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">setosa</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[</span><span class="n">setosa_index</span><span class="p">]</span>
<span class="n">sorted_setosa</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">setosa</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">sorted_setosa</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219163121873.png" alt="image-20250219163121873" style="zoom:50%;" /></p>

<p>方法2:<code class="language-plaintext highlighter-rouge">numpy.partition()</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nf">partition</span><span class="p">(</span><span class="n">setosa</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219163235255.png" alt="image-20250219163235255" style="zoom:50%;" /></p>

<p>统计哪个更快？</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="c1"># 假设数据已经加载
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 获取 setosa 样本
</span><span class="n">setosa_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">iris_2d</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Iris-setosa</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">setosa</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[</span><span class="n">setosa_index</span><span class="p">]</span>

<span class="c1"># 方法1: 使用 np.sort()
</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
<span class="n">sorted_setosa</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">setosa</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>  <span class="c1"># 排序并提取花瓣长度
</span><span class="n">method1_result</span> <span class="o">=</span> <span class="n">sorted_setosa</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># 获取倒数第二个值
</span><span class="n">method1_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># 方法2: 使用 np.partition()
</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
<span class="n">method2_result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">partition</span><span class="p">(</span><span class="n">setosa</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># 获取第二大值
</span><span class="n">method2_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="n">method1_result</span><span class="p">,</span> <span class="n">method1_time</span><span class="p">,</span> <span class="n">method2_result</span><span class="p">,</span> <span class="n">method2_time</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219163427937.png" alt="image-20250219163427937" style="zoom:50%;" /></p>

<p>很显然partition更快。</p>

<h2 id="44如何用给定列将-2-维数组排序"><strong>44.如何用给定列将 2 维数组排序？</strong></h2>

<p>问题：基于 sepallength 列将 iris 数据集排序。</p>

<p>注：iris数据集的格式是</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">sepallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">sepalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petallength</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">petalwidth</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">species</span><span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>

<span class="n">sepallength</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">sorted_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">sepallength</span><span class="p">)</span>
<span class="n">out_arr</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[</span><span class="n">sorted_index</span><span class="p">]</span>
<span class="n">out_arr</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219163800260.png" alt="image-20250219163800260" style="zoom:50%;" /></p>

<p>注：<code class="language-plaintext highlighter-rouge">numpy.argsort()</code> 返回的是排序后数组的索引，而 <code class="language-plaintext highlighter-rouge">numpy.sort()</code> 会返回排序后的数组。</p>

<h2 id="45如何在-numpy-数组中找到最频繁出现的值"><strong>45.如何在 NumPy 数组中找到最频繁出现的值？</strong></h2>

<p>问题：在 iris 数据集中找到 petallength（第三列）中最频繁出现的值。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>

<span class="n">petallength</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">petallength</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">petallength</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">petallength</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">petallength</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">])]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219164339155.png" alt="image-20250219164339155" style="zoom:50%;" /></p>

<h2 id="46如何找到第一个大于给定值的数的位置"><strong>46.如何找到第一个大于给定值的数的位置？</strong></h2>

<p>问题：在 iris 数据集的 petalwidth（第四列）中找到第一个值大于 1.0 的数的位置。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">str</span><span class="sh">'</span><span class="p">)</span>

<span class="n">petalwidth</span> <span class="o">=</span> <span class="n">iris_2d</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">petalwidth</span><span class="p">)</span>
<span class="n">argmax</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">petalwidth</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">最大值位置：</span><span class="sh">"</span><span class="p">,</span> <span class="n">argmax</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">最大值:</span><span class="sh">"</span><span class="p">,</span> <span class="n">petalwidth</span><span class="p">[</span><span class="n">argmax</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219164724939.png" alt="image-20250219164724939" style="zoom:50%;" /></p>

<h2 id="47如何将数组中所有大于给定值的数替换为给定的-cutoff-值"><strong>47.如何将数组中所有大于给定值的数替换为给定的 cutoff 值？</strong></h2>

<p>问题：对于数组 a，将所有大于 30 的值替换为 30，将所有小于 10 的值替换为 10。</p>

<p>输入：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">n</span><span class="p">[</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">n</span><span class="p">[</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nf">display</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219164906206.png" alt="image-20250219164906206" style="zoom:50%;" /></p>

<h2 id="48如何在-numpy-数组中找到-top-n-数值的位置"><strong>48.如何在 NumPy 数组中找到 top-n 数值的位置？</strong></h2>

<p>问题：在给定数组 a 中找到 top-5 最大值的位置。</p>

<p>输入：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<p>注：用partition获取的 top-5 最大值，但是得不到位置。所以还是要用<code class="language-plaintext highlighter-rouge">np.argsort()</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># 找到 top-5 最大值的位置
</span><span class="n">sorted_index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">top5_index</span> <span class="o">=</span> <span class="n">sorted_index</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">top 5 位置：</span><span class="sh">"</span><span class="p">,</span> <span class="n">top5_index</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">top 5 是：</span><span class="sh">"</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">top5_index</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219165346902.png" alt="image-20250219165346902" style="zoom:50%;" /></p>

<h2 id="49如何逐行计算数组中所有值的数量"><strong>49.如何逐行计算数组中所有值的数量？</strong></h2>

<p>问题：逐行计算唯一值的数量。</p>

<p>输入：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">arr</span>
\<span class="o">&gt;</span> <span class="nf">array</span><span class="p">([[</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>期望输出：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>\<span class="o">&gt;</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
\<span class="o">&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>输出包含 10 个列，表示从 1 到 10 的数字。这些数值分别代表每一行的计数数量。例如，Cell(0,2) 中有值 2，这意味着，数字 3 在第一行出现了两次。</p>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">arr</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])):</span> <span class="c1"># 遍历每一行
</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">])):</span>
        <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
<span class="nf">display</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219171704309.png" alt="image-20250219171704309" style="zoom:50%;" /></p>

<p>有没有更快的方法？上面的方法是我一开始写的，但是每次调用 <code class="language-plaintext highlighter-rouge">np.unique(arr[i], return_counts=True)</code> 都会重新计算唯一值及其计数，这样效率较低，特别是当数组的大小较大时。</p>

<p>可以通过以下方法优化：</p>

<ol>
  <li><strong>缓存唯一值和计数</strong>：对每一行的唯一值和计数计算一次，而不是重复计算。</li>
  <li><strong>简化代码</strong>：避免重复的数组操作，直接将结果填充到输出数组 <code class="language-plaintext highlighter-rouge">out</code> 中。</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># 随机生成数据
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="c1"># 初始化输出数组
</span><span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">arr</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># 遍历每一行，计算唯一值及其数量
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">arr</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">unique_vals</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">unique_vals</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts</span>  <span class="c1"># 填充结果
</span>
<span class="c1"># 输出结果
</span><span class="nf">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219171959842.png" alt="image-20250219171959842" style="zoom:50%;" /></p>

<h2 id="50如何将-array_of_arrays-转换为平面-1-维数组"><strong>50.如何将 array_of_arrays 转换为平面 1 维数组？</strong></h2>

<p>问题：将 <code class="language-plaintext highlighter-rouge">array_of_arrays </code>转换为平面线性 1 维数组。</p>

<blockquote>
  <p># Input:
arr1 = np.arange(3)
arr2 = np.arange(3,7)
arr3 = np.arange(7,10)
array_of_arrays = np.array([arr1, arr2, arr3])
array_of_arrays#&gt; array([array([0, 1, 2]), array([3, 4, 5, 6]), array([7, 8, 9])], dtype=object)</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</p>
</blockquote>

<hr />

<p>很难受，题目就是错的：报错信息如下</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="o">---------------------------------------------------------------------------</span>
<span class="nb">ValueError</span>                                <span class="nc">Traceback </span><span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">254</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
      <span class="mi">2</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="o">----&gt;</span> <span class="mi">4</span> <span class="n">array_of_arrays</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">arr3</span><span class="p">])</span>
<span class="nb">ValueError</span><span class="p">:</span> <span class="n">setting</span> <span class="n">an</span> <span class="n">array</span> <span class="n">element</span> <span class="k">with</span> <span class="n">a</span> <span class="n">sequence</span><span class="p">.</span> <span class="n">The</span> <span class="n">requested</span> <span class="n">array</span> <span class="n">has</span> <span class="n">an</span> <span class="n">inhomogeneous</span> <span class="n">shape</span> <span class="n">after</span> <span class="mi">1</span> <span class="n">dimensions</span><span class="p">.</span> <span class="n">The</span> <span class="n">detected</span> <span class="n">shape</span> <span class="nf">was </span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span> <span class="o">+</span> <span class="n">inhomogeneous</span> <span class="n">part</span><span class="p">.</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>这个错误发生是因为尝试将不同长度的数组（arr1, arr2, arr3）直接组合成一个统一的NumPy数组，而NumPy要求数组的形状必须一致。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">arr3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr3</span><span class="p">)</span>
<span class="c1"># 使用np.hstack来堆叠这些数组
</span><span class="n">array_of_arrays</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">hstack</span><span class="p">([</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">,</span> <span class="n">arr3</span><span class="p">])</span>

<span class="nf">display</span><span class="p">(</span><span class="n">array_of_arrays</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219172851682.png" alt="image-20250219172851682" style="zoom:50%;" /></p>

<h2 id="51如何为-numpy-数组生成-one-hot-编码"><strong>51.如何为 NumPy 数组生成 one-hot 编码？</strong></h2>

<p>问题：计算 one-hot 编码。</p>

<p>输入：</p>

<blockquote>
  <p>np.random.seed(101)
arr = np.random.randint(1,4, size=6)
arr
#&gt; array([2, 3, 2, 2, 2, 1])</p>
</blockquote>

<p>输出：</p>

<blockquote>
  <p>#&gt; array([[ 0., 1., 0.],
#&gt; [ 0., 0., 1.],
#&gt; [ 0., 1., 0.],
#&gt; [ 0., 1., 0.],
#&gt; [ 0., 1., 0.],
#&gt; [ 1., 0., 0.]])</p>
</blockquote>

<hr />

<p>补充：One-hot编码（也称为独热编码）是一种将分类变量转换为数值表示的方法，其中每个类别被转换为一个二进制向量。具体来说，对于一个具有N个类别的变量，每个类别用一个N维的向量表示，其中只有一个元素为1（对应于该类别），其他所有元素都为0。</p>

<p>假设我们有以下分类数据：</p>

<ul>
  <li>颜色：[‘红’, ‘绿’, ‘蓝’, ‘红’, ‘绿’]</li>
</ul>

<p>这些颜色可以编码为：</p>

<ul>
  <li>红：[1, 0, 0]</li>
  <li>绿：[0, 1, 0]</li>
  <li>蓝：[0, 0, 1]</li>
</ul>

<p>看下面这个例子：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># 假设我们有以下类别数据
</span><span class="n">categories</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="sh">'</span><span class="s">红</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">绿</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">蓝</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">红</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">绿</span><span class="sh">'</span><span class="p">])</span>

<span class="c1"># 找到所有独特的类别
</span><span class="n">unique_categories</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>

<span class="c1"># 创建一个函数来生成one-hot编码
</span><span class="k">def</span> <span class="nf">one_hot_encode</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">unique_categories</span><span class="p">):</span>
    <span class="c1"># 初始化编码数组
</span>    <span class="n">one_hot</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">categories</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">unique_categories</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    
    <span class="c1"># 为每个类别设置相应的1
</span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">categories</span><span class="p">):</span>
        <span class="n">one_hot</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">unique_categories</span> <span class="o">==</span> <span class="n">cat</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">return</span> <span class="n">one_hot</span>

<span class="c1"># 执行one-hot编码
</span><span class="n">encoded</span> <span class="o">=</span> <span class="nf">one_hot_encode</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">unique_categories</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">原数据:</span><span class="sh">"</span><span class="p">,</span> <span class="n">categories</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">独特类别:</span><span class="sh">"</span><span class="p">,</span> <span class="n">unique_categories</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">One-Hot编码:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219173216019.png" alt="image-20250219173216019" style="zoom:50%;" /></p>

<p>注：enumerate 是一个非常有用的Python内置函数，允许你在遍历一个可迭代对象（如列表、字符串或其他可迭代的集合）时，同时获取到索引和元素值。这对于需要同时使用元素的位置和值的场景非常方便。</p>

<hr />

<p>来解决这道题：(和上面这个例子的思想差不多)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">unique_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">原数据:</span><span class="sh">"</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">独特类别:</span><span class="sh">"</span><span class="p">,</span> <span class="n">unique_arr</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="nf">len</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="nf">len</span><span class="p">(</span><span class="n">unique_arr</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="n">unique_arr</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
    
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">One-Hot编码:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219173855305.png" alt="image-20250219173855305" style="zoom:50%;" /></p>

<h2 id="难52如何创建由类别变量分组确定的一维数值"><strong>(难)52.如何创建由类别变量分组确定的一维数值？</strong></h2>

<p>问题：创建由类别变量分组的行数。使用以下来自 iris species 的样本作为输入。</p>

<p>输入：</p>

<blockquote>
  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">species_small</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
<span class="n">species_small</span>
</pre></td></tr></tbody></table></code></pre></div>  </div>

  <p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219202226059.png" alt="image-20250219202226059" style="zoom:50%;" /></p>

  <p><strong><code class="language-plaintext highlighter-rouge">species_small</code></strong>：通过 <code class="language-plaintext highlighter-rouge">np.random.choice()</code> 随机从 <code class="language-plaintext highlighter-rouge">species</code> 中抽取 20 个样本，并将它们按升序排序。然后你需要计算这些样本在不同类别中的分布情况。</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; [0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 6, 7]</p>
</blockquote>

<hr />

<p>参考：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">species_small</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">species_small</span><span class="p">)</span>
<span class="nf">print</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">species_small</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">species_small</span><span class="p">[</span><span class="n">species_small</span> <span class="o">==</span> <span class="n">a</span><span class="p">])])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219203246717.png" alt="image-20250219203246717" style="zoom:50%;" /></p>

<h2 id="53如何基于给定的类别变量创建分组-id"><strong>53.如何基于给定的类别变量创建分组 id？</strong></h2>

<p>难度：L4</p>

<p>问题：基于给定的类别变量创建分组 id。使用以下来自 iris species 的样本作为输入。</p>

<p>输入：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">species_small</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
<span class="n">species_small</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2]</p>
</blockquote>

<hr />

<p>这题和上面一题类似。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">species_small</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">species_small</span><span class="p">)</span>
<span class="n">uni_species</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">species_small</span><span class="p">)</span>
<span class="nf">print</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">uni_species</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">species_small</span><span class="p">[</span><span class="n">species_small</span> <span class="o">==</span> <span class="n">a</span><span class="p">])</span> <span class="p">])</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219204220131.png" alt="image-20250219204220131" style="zoom:50%;" /></p>

<h2 id="54如何使用-numpy-对数组中的项进行排序"><strong>54.如何使用 NumPy 对数组中的项进行排序？</strong></h2>

<p>问题：为给定的数值数组 a 创建排序。</p>

<p>输入：</p>

<blockquote>
  <p>np.random.seed(10)
a = np.random.randint(20, size=10)print(a)#&gt; [ 9 4 15 0 17 16 17 8 9 0]</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>[4 2 6 0 8 7 9 3 5 1]</p>
</blockquote>

<hr />

<p>参考答案给的是：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">a</span><span class="p">.</span><span class="nf">argsort</span><span class="p">().</span><span class="nf">argsort</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219205708279.png" alt="image-20250219205708279" style="zoom:50%;" /></p>

<p>莫名其妙的排序两次。。。</p>

<hr />

<p>参考我自己写的：(如果想要跟上面结果一样，可以这么写，这么写下来 我就理解为什么上面是<code class="language-plaintext highlighter-rouge">a.argsort().argsort()</code>了)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># [ 9  4 15  0 17 16 17  8  9  0]
</span>
<span class="n">i</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">index_sort</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># [3 9 1 7 8 0 2 5 6 4]
</span><span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
<span class="c1"># 期待输出： [4 2 6 0 8 7 9 3 5 1]
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index_sort</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">out</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    
<span class="nf">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250219221030396.png" alt="image-20250219221030396" style="zoom:50%;" /></p>

<h2 id="55如何使用-numpy-对多维数组中的项进行排序"><strong>55.如何使用 NumPy 对多维数组中的项进行排序？</strong></h2>

<p>问题：给出一个数值数组 a，创建一个形态相同的排序数组。</p>

<p>输入：</p>

<blockquote>
  <p>np.random.seed(10)
a = np.random.randint(20, size=[2,5])print(a)#&gt; [[ 9 4 15 0 17]#&gt; [16 17 8 9 0]]</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; [[4 2 6 0 8]
#&gt; [7 9 3 5 1]]</p>
</blockquote>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a_fla</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a_fla</span><span class="p">)</span>
<span class="c1"># 期待输出： 
#&gt; [[4 2 6 0 8]
#&gt; [7 9 3 5 1]]
</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">a_fla</span><span class="p">.</span><span class="nf">argsort</span><span class="p">().</span><span class="nf">argsort</span><span class="p">().</span><span class="nf">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220100620716.png" alt="image-20250220100620716" style="zoom:50%;" /></p>

<h2 id="56如何在-2-维-numpy-数组中找到每一行的最大值"><strong>56.如何在 2 维 NumPy 数组中找到每一行的最大值？</strong></h2>

<p>问题：在给定数组中找到每一行的最大值。</p>

<blockquote>
  <p>np.random.seed(100)
a = np.random.randint(1,10, [5,3])
a
#&gt; array([[9, 9, 4],
#&gt; [8, 8, 1],
#&gt; [5, 3, 6],
#&gt; [3, 3, 3],
#&gt; [2, 1, 9]])</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220100931153.png" alt="image-20250220100931153" style="zoom:50%;" /></p>

<h2 id="57如何计算-2-维-numpy-数组每一行的-min-by-max"><strong>57.如何计算 2 维 NumPy 数组每一行的 min-by-max？</strong></h2>

<p>问题：给定一个 2 维 NumPy 数组，计算每一行的 min-by-max。</p>

<blockquote>
  <p>np.random.seed(100)
a = np.random.randint(1,10, [5,3])
a
#&gt; array([[9, 9, 4],
#&gt; [8, 8, 1],
#&gt; [5, 3, 6],
#&gt; [3, 3, 3],
#&gt; [2, 1, 9]])</p>
</blockquote>

<hr />

<p>这道题应该是计算<code class="language-plaintext highlighter-rouge">min/max</code>吧。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">max_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">min_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">每一行的最小值</span><span class="sh">"</span><span class="p">,</span> <span class="n">min_</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">每一行的最大值</span><span class="sh">"</span><span class="p">,</span> <span class="n">max_</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">min-by-max: </span><span class="sh">"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">divide</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220101642304.png" alt="image-20250220101642304" style="zoom:50%;" /></p>

<h2 id="58如何在-numpy-数组中找到重复条目"><strong>58.如何在 NumPy 数组中找到重复条目？</strong></h2>

<p>问题：在给定的 NumPy 数组中找到重复条目（从第二次出现开始），并将其标记为 True。第一次出现的条目需要标记为 False。</p>

<blockquote>
  <p># Input
np.random.seed(100)
a = np.random.randint(0, 5, 10)
print( Array: , a)
#&gt; Array: [0 0 3 0 2 4 2 2 2 2]</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; [False True False True False False True True True True]</p>
</blockquote>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">return_index</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>  <span class="c1"># return_index返回第一次出现的索引
</span><span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">full</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">out</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="59如何找到-numpy-的分组平均值"><strong>59.如何找到 NumPy 的分组平均值？</strong></h2>

<p>问题：在 2 维 NumPy 数组的类别列中找到数值的平均值。</p>

<p>输入：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>url = "https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data"
iris = np.genfromtxt(url, delimiter=",", dtype= object )
names = ( sepallength , sepalwidth , petallength , petalwidth , species )
</pre></td></tr></tbody></table></code></pre></div></div>

<p>期望解：</p>

<blockquote>
  <p>#&gt; [[b Iris-setosa , 3.418],
#&gt; [b Iris-versicolor , 2.770],
#&gt; [b Iris-virginica , 2.974]]</p>
</blockquote>

<hr />

<p>这道题没说清楚是算哪一列的均值。（看期望解猜测是 第二列<code class="language-plaintext highlighter-rouge">[:, 1]</code>）</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</span><span class="sh">"</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">genfromtxt</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span> <span class="nb">object</span> <span class="p">)</span>
<span class="c1"># display(iris)
</span>
<span class="n">species</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">species_class</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">species_class</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">species_class</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)):</span>
    <span class="n">out</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="n">iris</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">==</span> <span class="n">index</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">column_stack</span><span class="p">((</span><span class="n">species_class</span><span class="p">,</span> <span class="n">out</span><span class="p">))</span>
<span class="nf">display</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220112402328.png" alt="image-20250220112402328" style="zoom:50%;" /></p>

<h2 id="60如何将-pil-图像转换成-numpy-数组">60.如何将 PIL 图像转换成 NumPy 数组？</h2>

<p>问题：从以下 URL 中导入图像，并将其转换成 NumPy 数组。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>URL = "https://upload.wikimedia.org/wikipedia/commons/8/8b/Denali_Mt_McKinley.jpg"
</pre></td></tr></tbody></table></code></pre></div></div>

<p>关于在jupyter notebook中阅读图像，我曾经总结了4点（及基本操作），参考<a href="https://kirsten-1.github.io/2025/02/11/jupyter-notebook-%E8%AF%BB%E5%9B%BE%E7%89%87/">博客</a></p>

<hr />

<p>这道题可以采用思路：利用Pillow读图片，并且用<code class="language-plaintext highlighter-rouge">np.array</code>将其转化成ndarray</p>

<p>但是因为 <code class="language-plaintext highlighter-rouge">Image.open() </code>本身不支持直接传入 URL，而是需要本地文件路径或文件对象（如字节流）。为此，可以结合 requests 库下载图片，然后用 BytesIO 将字节数据转换为文件对象，再交给<code class="language-plaintext highlighter-rouge">Image.open() </code>处理。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://upload.wikimedia.org/wikipedia/commons/8/8b/Denali_Mt_McKinley.jpg</span><span class="sh">"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="nf">raise_for_status</span><span class="p">()</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="nc">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
<span class="n">pic</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>

<span class="c1"># 展示图片
</span><span class="n">pic</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># 图片转化成ndarray
</span><span class="n">pic_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">pic</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">pic_arr</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>图片是窗口弹出的。</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220195222036.png" alt="image-20250220195222036" style="zoom:50%;" /></p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220195310300.png" alt="image-20250220195310300" style="zoom:50%;" /></p>

<p>也可以不窗口弹出，如下：需要注释掉<code class="language-plaintext highlighter-rouge">pic.show()</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://upload.wikimedia.org/wikipedia/commons/8/8b/Denali_Mt_McKinley.jpg</span><span class="sh">"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="nf">raise_for_status</span><span class="p">()</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="nc">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
<span class="n">pic</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>

<span class="c1"># 展示图片
# pic.show()
</span><span class="nf">display</span><span class="p">(</span><span class="n">pic</span><span class="p">)</span>
<span class="c1"># 图片转化成ndarray
</span><span class="n">pic_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">pic</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">pic_arr</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220195426271.png" alt="image-20250220195426271" style="zoom:50%;" /></p>

<hr />

<p>初次之外可以查看图片的大小和模式：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">大小</span><span class="sh">"</span><span class="p">,</span> <span class="n">pic_arr</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">模式</span><span class="sh">"</span><span class="p">,</span> <span class="n">pic</span><span class="p">.</span><span class="n">mode</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220195637868.png" alt="image-20250220195637868" style="zoom:50%;" /></p>

<h2 id="61如何删除-numpy-数组中所有的缺失值"><strong>61.如何删除 NumPy 数组中所有的缺失值？</strong></h2>

<p>问题：从 1 维 NumPy 数组中删除所有的 nan 值。</p>

<p>输入：</p>

<blockquote>
  <p>np.array([1,2,3,np.nan,5,6,7,np.nan])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>array([ 1., 2., 3., 5., 6., 7.])</p>
</blockquote>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a_cleaned</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="p">.</span><span class="nf">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
<span class="n">a_cleaned</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220195935713.png" alt="image-20250220195935713" style="zoom:50%;" /></p>

<h2 id="62如何计算两个数组之间的欧几里得距离"><strong>62.如何计算两个数组之间的欧几里得距离？</strong></h2>

<p>问题：计算两个数组 a 和 b 之间的欧几里得距离。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.array([1,2,3,4,5])
b = np.array([4,5,6,7,8])</p>
</blockquote>

<hr />

<h3 id="补充1欧几里得距离">补充1：欧几里得距离：</h3>

<p>对于两个 n维向量 \(a=[a_1,a_2,...,a_n]\)和 \(b=[b_1,b_2,...,b_n]\)，欧几里得距离定义为：\(d = \sqrt{(a_1-b_1)^2+(a_2-b_2)^2+...+(a_n-b_n)^2}\)</p>

<h3 id="补充2nplinalgnorm的使用方法">补充2:<code class="language-plaintext highlighter-rouge">np.linalg.norm()</code>的使用方法</h3>

<p>函数签名：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">numpy</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>【参数说明】</p>

<ol>
  <li><strong>x</strong>（必需）
    <ul>
      <li><strong>类型</strong>：数组或类似数组的对象（如 NumPy 数组、列表）。</li>
      <li><strong>描述</strong>：输入向量或矩阵，用于计算范数。</li>
      <li><strong>示例</strong>：<code class="language-plaintext highlighter-rouge">np.array([1, 2, 3]) </code>或 <code class="language-plaintext highlighter-rouge">np.array([[1, 2], [3, 4]])</code>。</li>
    </ul>
  </li>
  <li><strong>ord</strong>（可选）
    <ul>
      <li><strong>类型</strong>：整数、浮点数或字符串，默认 None。</li>
      <li><strong>描述</strong>：指定范数的类型。对于向量，默认是 2（L2 范数，即欧几里得范数）。</li>
      <li><strong>常见值</strong>：
        <ul>
          <li>None 或 2：L2 范数（\(\sqrt{\sum x_i^2}\)）</li>
          <li>1：L1 范数（\(\sum \vert x_i \vert\)）</li>
          <li>0：非零元素个数。</li>
          <li><code class="language-plaintext highlighter-rouge">np.inf</code>：最大值范数（\(max⁡ \vert x_i \vert\)）。</li>
          <li>‘fro’：Frobenius 范数（矩阵默认，\(\sqrt{\sum x_{ij}^2}\)）。</li>
          <li>‘nuc’：核范数（矩阵的奇异值之和）。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>axis</strong>（可选）</li>
</ol>

<ul>
  <li><strong>类型</strong>：整数或元组，默认 None。</li>
  <li><strong>描述</strong>：指定沿哪个轴计算范数。
    <ul>
      <li>None：展平数组后计算整个范数。</li>
      <li>0：沿列计算。</li>
      <li>1：沿行计算。</li>
    </ul>
  </li>
  <li><strong>示例</strong>：axis=0 对矩阵每列单独计算。</li>
</ul>

<ol>
  <li><strong>keepdims</strong>（可选）</li>
</ol>

<ul>
  <li><strong>类型</strong>：布尔值，默认 False。</li>
  <li><strong>描述</strong>：是否保留输入维度。
    <ul>
      <li>False：返回标量或降维数组。</li>
      <li>True：保持维度（如返回形状为 (1,) 的数组）。</li>
    </ul>
  </li>
  <li><strong>示例</strong>：keepdims=True 返回数组而非标量。</li>
</ul>

<p>【返回值】</p>

<ul>
  <li><strong>类型</strong>：浮点数或 NumPy 数组。</li>
  <li><strong>描述</strong>：根据 ord 和 axis 计算的范数值。
    <ul>
      <li>向量默认返回标量（L2 范数）。</li>
      <li>矩阵按指定轴返回数组或标量。</li>
    </ul>
  </li>
</ul>

<hr />

<p>看一个例子：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">norm</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>  <span class="c1"># 输出：3.7416573867739413
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220224204334.png" alt="image-20250220224204334" style="zoom:50%;" /></p>

<p>即计算的是\(\sqrt{1^2+2^2+3^2}=\sqrt{14}\)</p>

<hr />

<p>回到这道题：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>

<span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">norm</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250220224414994.png" alt="image-20250220224414994" style="zoom:50%;" /></p>

<h2 id="63如何在一个-1-维数组中找到所有的局部极大值peak"><strong>63.如何在一个 1 维数组中找到所有的局部极大值（peak）？</strong></h2>

<p>问题：在 1 维数组 a 中找到所有的 peak，peak 指一个数字比两侧的数字都大。</p>

<p>输入：</p>

<blockquote>
  <p>a = np.array([1, 3, 7, 1, 2, 6, 0, 1])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; array([2, 5])</p>
</blockquote>

<hr />

<p>方法1:python实现：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">find_peaks_index</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">peaks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">peaks</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>

<span class="nf">find_peaks_index</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221105929670.png" alt="image-20250221105929670" style="zoom:50%;" /></p>

<p>方法2:<code class="language-plaintext highlighter-rouge">scipy.signal.find_peaks</code>专门用于信号处理，其中峰值检测是一个常见的需求。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 答案要的是这个
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221110208253.png" alt="image-20250221110208253" style="zoom:50%;" /></p>

<h2 id="64如何从-2-维数组中减去-1-维数组从-2-维数组的每一行分别减去-1-维数组的每一项"><strong>64.如何从 2 维数组中减去 1 维数组，从 2 维数组的每一行分别减去 1 维数组的每一项？</strong></h2>

<p>问题：从 2 维数组 <code class="language-plaintext highlighter-rouge">a_2d </code>中减去 1 维数组<code class="language-plaintext highlighter-rouge"> b_1d</code>，即从 a_2d 的每一行分别减去 <code class="language-plaintext highlighter-rouge">b_1d </code>的每一项。</p>

<p>输入：</p>

<blockquote>
  <p>a_2d = np.array([[3,3,3],[4,4,4],[5,5,5]])
b_1d = np.array([1,1,1])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; [[2 2 2]
#&gt; [2 2 2]
#&gt; [2 2 2]]</p>
</blockquote>

<hr />

<p>额，如果我的理解没有问题，不应该输出</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>吗？</p>

<hr />

<p>这道题就是很简单，了解广播机制就可以。关于广播机制，参考<a href="https://kirsten-1.github.io/2025/02/04/Numpy%E7%9A%84%E5%B9%BF%E6%92%AD%E5%92%8C%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6/">博客</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">a_2d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">b_1d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">a_2d</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">b_1d</span><span class="p">)</span>
<span class="n">a_2d</span> <span class="o">-</span> <span class="n">b_1d</span>        
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221110643964.png" alt="image-20250221110643964" style="zoom:50%;" /></p>

<h2 id="65如何在数组中找出某个项的第-n-个重复索引"><strong>65.如何在数组中找出某个项的第 n 个重复索引？</strong></h2>

<p>问题：找到数组 x 中数字 1 的第 5 个重复索引。</p>

<blockquote>
  <p>x = np.array([1, 2, 1, 1, 3, 4, 3, 1, 1, 2, 1, 1, 2])</p>
</blockquote>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">index</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221111257175.png" alt="image-20250221111257175" style="zoom:50%;" /></p>

<p>感觉这道题就是考察<code class="language-plaintext highlighter-rouge">np.where</code></p>

<p>当然也可以再加层判断，是不是有5个1:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="nf">display</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">数组中1的数字没有5个</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="66如何将-numpy-的-datetime64-对象object转换为-datetime-的-datetime-对象"><strong>66.如何将 NumPy 的 datetime64 对象（object）转换为 datetime 的 datetime 对象？</strong></h2>

<p>问题：将 NumPy 的 datetime64 对象（object）转换为 datetime 的 datetime 对象。</p>

<blockquote>
  <p># Input: a numpy datetime64 object
dt64 = np.datetime64(“2018-02-25 22:10:10 “)</p>
</blockquote>

<hr />

<p>尼玛这题真的有问题，这道题原题引号都没有，误人子弟。</p>

<hr />

<h3 id="补充numpy-的-datetime64-对象和datetimedatetime">补充：NumPy 的 datetime64 对象和<code class="language-plaintext highlighter-rouge">datetime.datetime</code></h3>

<p>首先：NumPy 的 datetime64 对象和 Python 的 <code class="language-plaintext highlighter-rouge">datetime.datetime</code> 对象都是用于表示日期和时间的(这句话属于是废话)</p>

<p>但是：</p>

<ul>
  <li>
    <p><strong>datetime.datetime</strong> 是 Python 标准库 datetime 的一部分，它是一个 Python 对象，用 Python 代码实现；<strong>numpy.datetime64</strong> 是 NumPy 库的一部分，它是一个 NumPy 的数据类型，用 C 代码实现，旨在提供高效的数值运算，特别是对于日期和时间序列。</p>
  </li>
  <li><strong>datetime.datetime</strong>作为 Python 对象，它具有 Python 对象的开销，例如引用计数、类型检查等，在处理大量日期时间数据时，性能可能不如 <code class="language-plaintext highlighter-rouge">numpy.datetime64</code>；<strong>numpy.datetime64</strong>NumPy 数组存储相同类型的元素，datetime64 对象在内存中紧密排列，允许向量化操作，从而提高了性能，对于处理大型日期时间数据集，numpy.datetime64 通常更快。</li>
  <li>精度差异：<strong>datetime.datetime</strong>微秒级的精度；<strong>numpy.datetime64</strong>精度是可配置的，最多达到<code class="language-plaintext highlighter-rouge">datetime64[ps] </code>(皮秒) 或 <code class="language-plaintext highlighter-rouge">datetime64[fs]</code> (飞秒)</li>
</ul>

<p>说多了还不如看看代码：</p>

<p>创建对象和算术运算：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># 创建
</span><span class="n">dt_py</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">dt_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">datetime64</span><span class="p">(</span><span class="sh">"</span><span class="s">2025-02-21T10:30:00</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">display</span><span class="p">(</span><span class="n">dt_py</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">dt_np</span><span class="p">)</span>

<span class="c1"># 加法
</span><span class="n">dt_py_plus</span> <span class="o">=</span> <span class="n">dt_py</span> <span class="o">+</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">timedelta</span><span class="p">(</span><span class="n">days</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">datetime.datetime加1天：</span><span class="sh">"</span><span class="p">,</span> <span class="n">dt_py_plus</span><span class="p">)</span>

<span class="c1"># numpy.datetime64支持向量化操作
</span><span class="n">dt_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="sh">"</span><span class="s">2025-02-21</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2025-02-22</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2025-02-23</span><span class="sh">"</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="sh">"</span><span class="s">datetime64[D]</span><span class="sh">"</span><span class="p">)</span>
<span class="n">dt_arr_plus_a_week</span> <span class="o">=</span> <span class="n">dt_arr</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">timedelta64</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="sh">"</span><span class="s">D</span><span class="sh">"</span><span class="p">)</span> 
<span class="nf">display</span><span class="p">(</span><span class="n">dt_arr</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">np.datetime64加1周（向量化操作）：</span><span class="sh">"</span><span class="p">,</span> <span class="n">dt_arr_plus_a_week</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221114036697.png" alt="image-20250221114036697" style="zoom:50%;" /></p>

<p>当然<code class="language-plaintext highlighter-rouge">numpy.datetime64</code>可以指定精度：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1"># 指定精度的 numpy.datetime64 对象
</span><span class="n">dt_numpy_ms</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">datetime64</span><span class="p">(</span><span class="sh">'</span><span class="s">2023-10-27T10:30:00.123</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ms</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 毫秒
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">numpy.datetime64 object (milliseconds): </span><span class="si">{</span><span class="n">dt_numpy_ms</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221114048441.png" alt="image-20250221114048441" style="zoom:50%;" /></p>

<p>访问属性：特别注意：<code class="language-plaintext highlighter-rouge">numpy.datetime64</code> 的属性 (需要先转换为 datetime 对象才能访问)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="n">dt_py</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">dt_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">datetime64</span><span class="p">(</span><span class="sh">"</span><span class="s">2025-02-21T10:30:00</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">datetime.datetime 年</span><span class="sh">"</span><span class="p">,</span> <span class="n">dt_py</span><span class="p">.</span><span class="n">year</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">datetime.datetime 月</span><span class="sh">"</span><span class="p">,</span> <span class="n">dt_py</span><span class="p">.</span><span class="n">month</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">datetime.datetime 日</span><span class="sh">"</span><span class="p">,</span> <span class="n">dt_py</span><span class="p">.</span><span class="n">day</span><span class="p">)</span>

<span class="c1"># numpy.datetime64 的属性 (需要先转换为 datetime 对象才能访问)
</span><span class="n">dt_np2py</span> <span class="o">=</span> <span class="n">dt_np</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">numpy.datetime64转换成datetime.datetime后 年</span><span class="sh">"</span><span class="p">,</span> <span class="n">dt_np2py</span><span class="p">.</span><span class="n">year</span><span class="p">)</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221114406263.png" alt="image-20250221114406263" style="zoom:50%;" /></p>

<p>简单的性能比较：创建 10 万个日期对象或数组元素</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="c1"># datetime.datetime 性能
</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
<span class="n">dt_python_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">27</span><span class="p">)</span> <span class="o">+</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">datetime.datetime list creation time: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># numpy.datetime64 性能
</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">datetime64</span><span class="p">(</span><span class="sh">'</span><span class="s">2023-10-27</span><span class="sh">'</span><span class="p">)</span>
<span class="n">dt_numpy_array</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">start_date</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">timedelta64</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">datetime64[D]</span><span class="sh">'</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">numpy.datetime64 array creation time: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221114644285.png" alt="image-20250221114644285" style="zoom:50%;" /></p>

<p>显然，在创建和处理大量日期时间数据时，NumPy 通常比 Python 的标准 datetime 库更有效率</p>

<hr />

<p>回到本来的题目，就很简单了：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">dt64</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">datetime64</span><span class="p">(</span><span class="sh">"</span><span class="s">2018-02-25 22:10:10 </span><span class="sh">"</span><span class="p">)</span>
<span class="n">dt64_2_dtdt</span> <span class="o">=</span> <span class="n">dt64</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">)</span>
<span class="n">dt64_2_dtdt</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221114908987.png" alt="image-20250221114908987" style="zoom:50%;" /></p>

<h2 id="67如何计算-numpy-数组的移动平均数"><strong>67.如何计算 NumPy 数组的移动平均数？</strong></h2>

<p>问题：给定 1 维数组，计算 window size 为 3 的移动平均数。</p>

<p>输入：</p>

<blockquote>
  <p>np.random.seed(100)
Z = np.random.randint(10, size=10)</p>
</blockquote>

<hr />

<p>关于移动平均线这个在<a href="https://kirsten-1.github.io/2025/02/06/Numpy(3)%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/">博客</a>中讨论了好几种方法。可以简单回顾下。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="c1"># 计算SMA
</span><span class="n">N</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># window的大小
</span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>  <span class="c1"># 生成等权重窗口[1/N, 1/N, ..., 1/N]
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">权重：</span><span class="sh">"</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="n">sma</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">convolve</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="sh">"</span><span class="s">valid</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sma</span><span class="sh">"</span><span class="p">,</span> <span class="n">sma</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221115538021.png" alt="image-20250221115538021" style="zoom:50%;" /></p>

<p>注：<code class="language-plaintext highlighter-rouge">np.convolve</code> 函数的 mode 参数决定了卷积操作如何处理边界。 它有三个可选值：</p>

<ul>
  <li><strong>‘full’ (默认值)</strong>: 返回完整卷积。 输出数组的大小为 len(Z) + len(weights) - 1。 在 ‘full’ 模式下，卷积操作会从 weights 与 Z 完全不重叠的位置开始，逐步移动 weights 直到完全不重叠为止。 这意味着输出数组的开头和结尾的值是基于较少的数据点计算的。</li>
  <li><strong>‘valid’</strong>: 仅返回完全重叠的部分。 输出数组的大小为 len(Z) - len(weights) + 1。 在 ‘valid’ 模式下，卷积操作只计算 weights 与 Z 完全重叠的部分。 这意味着输出数组只包含基于完整窗口大小计算的平均值。 这是计算移动平均的常用模式。</li>
  <li><strong>‘same’</strong>: 返回与输入数组 Z 相同大小的数组。 卷积的结果会进行裁剪或填充，以使输出数组与输入数组具有相同的形状。 如果 len(weights) 是奇数，则输出将以 Z 的中心对齐。如果 len(weights) 是偶数，则输出将略微偏向右侧。</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">mode="valid" </code>表示我们只想计算完全重叠的移动平均值。 由于窗口大小 N 是 3，这意味着输出数组 sma 将包含<code class="language-plaintext highlighter-rouge"> len(Z) - len(weights) + 1 = 10 - 3 + 1 = 8 </code>个元素。</p>

<p><code class="language-plaintext highlighter-rouge">Z = [8, 8, 3, 7, 7, 0, 4, 2, 5, 2]</code> 并且 <code class="language-plaintext highlighter-rouge">weights = [1/3, 1/3, 1/3]</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="mf">1.</span> <span class="n">第一个移动平均值</span><span class="err">：</span><span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">19</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">=</span> <span class="mf">6.33333333</span>
<span class="mf">2.</span> <span class="n">第二个移动平均值</span><span class="err">：</span><span class="p">(</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">18</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="mf">3.</span> <span class="n">第三个移动平均值</span><span class="err">：</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">17</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">=</span> <span class="mf">5.66666667</span>
<span class="mf">4.</span> <span class="n">以此类推</span><span class="err">，</span><span class="n">直到计算出所有</span> <span class="mi">8</span> <span class="n">个移动平均值</span><span class="err">。</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>如果没有设置mode ,默认就是full，那么计算过程就是：</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221120105499.png" alt="image-20250221120105499" style="zoom:50%;" /></p>

<ol>
  <li><strong>weights 位于 Z 的左侧，部分不重叠：</strong>
    <ul>
      <li>weights = [1/3, 1/3, 1/3]</li>
      <li>Z = 8, 8, 3, 7, 7, 0, 4, 2, 5, 2</li>
      <li>计算：(0 * 1/3 + 0 * 1/3 + 8 * 1/3) = 8/3 = 2.66666667 （这里假设 Z 数组左侧用 0 填充）</li>
    </ul>
  </li>
  <li><strong>weights 仍然位于 Z 的左侧，部分不重叠：</strong>
    <ul>
      <li>weights = 1/3, 1/3, 1/3</li>
      <li>Z = 8, 8, 3, 7, 7, 0, 4, 2, 5, 2</li>
      <li>计算：(0 * 1/3 + 8 * 1/3 + 8 * 1/3) = 16/3 = 5.33333333 （这里假设 Z 数组左侧用 0 填充）</li>
    </ul>
  </li>
  <li><strong>weights 与 Z 完全重叠：</strong>
    <ul>
      <li>weights = 1/3, 1/3, 1/3</li>
      <li>Z = 8, 8, 3, 7, 7, 0, 4, 2, 5, 2</li>
      <li>计算：(8 * 1/3 + 8 * 1/3 + 3 * 1/3) = 19/3 = 6.33333333</li>
    </ul>
  </li>
  <li><strong>继续移动 weights，直到 weights 位于 Z 的右侧，部分不重叠：</strong>
    <ul>
      <li>weights = 1/3, 1/3, 1/3</li>
      <li>Z = 8, 8, 3, 7, 7, 0, 4, 2, 5, 2</li>
      <li>计算：(2 * 1/3 + 0 * 1/3 + 0 * 1/3) = 2/3 = 0.66666667 (这里假设 Z 数组右侧用 0 填充)</li>
    </ul>
  </li>
  <li><strong>weights 完全位于 Z 的右侧，不重叠：</strong> 不进行计算 (已经到末尾)。</li>
</ol>

<p>如果mode 设置为same，计算过程就是：</p>

<ol>
  <li><strong>填充（Padding）：</strong>
    <ul>
      <li>计算需要填充的数量： 为了使输出大小与输入 Z 相同，np.convolve 会在 Z 的两侧添加填充。 填充的数量取决于 weights 的长度。 一般来说，填充的数量是 (len(weights) - 1) // 2。 对于我们的例子，len(weights) = 3，所以填充的数量是<code class="language-plaintext highlighter-rouge"> (3 - 1) // 2 = 1</code>。</li>
      <li>创建填充后的 Z：<code class="language-plaintext highlighter-rouge">Z_padded = [0, 8, 8, 3, 7, 7, 0, 4, 2, 5, 2, 0]</code> (在原始 Z 的开头和结尾各添加一个 0)。</li>
    </ul>
  </li>
  <li><strong>卷积（Convolution）：</strong>
    <ul>
      <li>对填充后的 Z_padded 和 weights 执行卷积操作。 因为<code class="language-plaintext highlighter-rouge"> Z_padded </code>有 12 个元素，weights 有 3 个元素，所以卷积结果（如果使用 mode=’full’）将有 <code class="language-plaintext highlighter-rouge">12 + 3 - 1 = 14</code> 个元素。</li>
    </ul>
  </li>
  <li><strong>裁剪（Cropping）：</strong>
    <ul>
      <li>从卷积结果中裁剪一个与原始数组 Z 大小相同的子数组。 裁剪的位置取决于 len(weights) 是奇数还是偶数。
        <ul>
          <li>如果 len(weights) 是奇数 (就像我们的例子)，则输出将以 Z 的中心对齐。 这意味着我们将从卷积结果的中心位置向前和向后裁剪，以获得与 Z 大小相同的数组。</li>
          <li>如果 len(weights) 是偶数，则输出将略微偏向右侧。</li>
        </ul>
      </li>
      <li>由于输出需要和Z一样是10个元素，因此需要裁剪掉头尾各2个元素。</li>
    </ul>
  </li>
</ol>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221120257258.png" alt="image-20250221120257258" style="zoom:50%;" /></p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221120324409.png" alt="image-20250221120324409" style="zoom:50%;" /></p>

<h2 id="68给定起始数字length-和步长如何创建一个-numpy-数组序列"><strong>68.给定起始数字、length 和步长，如何创建一个 NumPy 数组序列？</strong></h2>

<p>问题：从 5 开始，创建一个 length 为 10 的 NumPy 数组，相邻数字的差是 3。</p>

<hr />

<p>归纳成通用的表达式就是：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">start</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">step</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="n">length</span> <span class="o">*</span> <span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221120549581.png" alt="image-20250221120549581" style="zoom:50%;" /></p>

<h2 id="69如何在不规则-numpy-日期序列中填充缺失日期"><strong>69.如何在不规则 NumPy 日期序列中填充缺失日期？</strong></h2>

<p>问题：给定一个非连续日期序列的数组，通过填充缺失的日期，使其变成连续的日期序列。</p>

<p>输入：</p>

<blockquote>
  <p># Input
dates = np.arange(np.datetime64( 2018-02-01 ), np.datetime64( 2018-02-25 ), 2)
print(dates)
#&gt; [ 2018-02-01 2018-02-03 2018-02-05 2018-02-07 2018-02-09
#&gt; 2018-02-11 2018-02-13 2018-02-15 2018-02-17 2018-02-19
#&gt; 2018-02-21 2018-02-23 ]</p>
</blockquote>

<hr />

<p>已经有的是：</p>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221120736908.png" alt="image-20250221120736908" style="zoom:50%;" /></p>

<p>也就是因为步长是2，需要把中间缺的日子都补上。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">dates</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">datetime64</span><span class="p">(</span> <span class="sh">"</span><span class="s">2018-02-01</span><span class="sh">"</span> <span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">datetime64</span><span class="p">(</span> <span class="sh">"</span><span class="s">2018-02-25</span><span class="sh">"</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
<span class="n">min_day</span> <span class="o">=</span> <span class="n">dates</span><span class="p">.</span><span class="nf">min</span><span class="p">()</span>
<span class="n">max_day</span> <span class="o">=</span> <span class="n">dates</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span>

<span class="n">full_days</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">min_day</span><span class="p">,</span> <span class="n">max_day</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sh">"</span><span class="s">D</span><span class="sh">"</span><span class="p">))</span>
<span class="nf">display</span><span class="p">(</span><span class="n">full_days</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221121018032.png" alt="image-20250221121018032" style="zoom:50%;" /></p>

<h2 id="70如何基于给定的-1-维数组创建-strides"><strong>70.如何基于给定的 1 维数组创建 strides？</strong></h2>

<p>问题：给定 1 维数组 arr，使用 strides 生成一个 2 维矩阵，其中 window length 等于 4，strides 等于 2，例如<code class="language-plaintext highlighter-rouge"> [[0,1,2,3], [2,3,4,5], [4,5,6,7]..]</code>。</p>

<p>输入：</p>

<blockquote>
  <p>arr = np.arange(15)
arr
#&gt; array([ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14])</p>
</blockquote>

<p>期望输出：</p>

<blockquote>
  <p>#&gt; [[ 0 1 2 3]
#&gt; [ 2 3 4 5]
#&gt; [ 4 5 6 7]
#&gt; [ 6 7 8 9]
#&gt; [ 8 9 10 11]
#&gt; [10 11 12 13]]</p>
</blockquote>

<hr />

<p>补充：<code class="language-plaintext highlighter-rouge">as_strided</code> 函数是<code class="language-plaintext highlighter-rouge"> numpy.lib.stride_tricks</code> 模块的一部分。 它允许我们创建一个新的 NumPy 数组，该数组是现有数组的视图，但具有不同的形状和步长。 <strong>重要的是，它不会复制数据</strong>。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">numpy.lib.stride_tricks</span> <span class="kn">import</span> <span class="n">as_strided</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="nf">display</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">rolling_window</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">window_length</span><span class="p">,</span> <span class="n">strides</span> <span class="p">):</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span><span class="p">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">window_length</span><span class="p">)</span> <span class="o">//</span> <span class="n">strides</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">window_length</span>
    <span class="n">strides</span> <span class="o">=</span> <span class="p">(</span><span class="n">strides</span> <span class="o">*</span> <span class="n">arr</span><span class="p">.</span><span class="n">itemsize</span><span class="p">,</span> <span class="n">arr</span><span class="p">.</span><span class="n">itemsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">as_strided</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">)</span>

<span class="n">window_length</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">strides</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nf">rolling_window</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">window_length</span><span class="p">,</span> <span class="n">strides</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://wechat01.oss-cn-hangzhou.aliyuncs.com/img/image-20250221121711264.png" alt="image-20250221121711264" style="zoom:50%;" /></p>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2025/02/14/NumPy%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97(%E7%AC%AC2%E7%89%88)%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93/" data-toggle="tooltip" data-placement="top" title="NumPy学习指南（第2版）阅读总结">
                        Previous<br>
                        <span>NumPy学习指南（第2版）阅读总结</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2025/02/21/Pandas(1)%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/" data-toggle="tooltip" data-placement="top" title="pandas(1)数据预处理">
                        Next<br>
                        <span>pandas(1)数据预处理</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        
        
        
                <a data-sort="0067" 
                    href="/archive/?tag=%E4%B9%A6%E7%B1%8D%E9%98%85%E8%AF%BB"
                    title="书籍阅读"
                    rel="3">书籍阅读</a>
        
                <a data-sort="0052" 
                    href="/archive/?tag=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BDAI%E5%9F%BA%E7%A1%80"
                    title="人工智能AI基础"
                    rel="18">人工智能AI基础</a>
        
                <a data-sort="0053" 
                    href="/archive/?tag=%E7%AE%97%E6%B3%95"
                    title="算法"
                    rel="17">算法</a>
        
                <a data-sort="0058" 
                    href="/archive/?tag=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%90%B4%E6%81%A9%E8%BE%BE"
                    title="机器学习-吴恩达"
                    rel="12">机器学习-吴恩达</a>
        
                <a data-sort="0061" 
                    href="/archive/?tag=%E5%8A%9B%E6%89%A3"
                    title="力扣"
                    rel="9">力扣</a>
        
                <a data-sort="0068" 
                    href="/archive/?tag=numpy"
                    title="numpy"
                    rel="2">numpy</a>
        
                <a data-sort="0068" 
                    href="/archive/?tag=pandas"
                    title="pandas"
                    rel="2">pandas</a>
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="https://m.freebuf.com/">freebuf</a></li>
  
  <li><a href="https://xz.aliyun.com/">先知</a></li>
  
  <li><a href="https://www.sec-in.com/All">sec-in</a></li>
  
  <li><a href="https://paper.seebug.org/">see-bug</a></li>
  
  <li><a href="https://twitter.com/Concurr21486093">我的推特</a></li>
  
  <li><a href="https://pdai.tech/">pdai</a></li>
  
  <li><a href="https://nodejs.org/dist/">nodejs index of dist</a></li>
  
  <li><a href="#">公众号：小东方不败</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/Concurr21486093">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/Hilda">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">知</i>
      </span>
    </a>
  </li>
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/kirsten-1">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Hilda 2025
                    <br>
                    Powered by <a href="https://kirsten-1.github.io/">hilda Blog</a>
<!--                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"-->
<!--                        height="20px"-->
<!--                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">-->
<!--                    </iframe>-->
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
